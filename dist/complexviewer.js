!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.complexviewer=n():t.complexviewer=n()}(window,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=10)}([function(t,n,e){var r,i;!function(){var o={version:"3.5.17"},a=[].slice,s=function(t){return a.call(t)},u=this.document;function c(t){return t&&(t.ownerDocument||t.document||t).documentElement}function l(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(u)try{s(u.documentElement.childNodes)[0].nodeType}catch(t){s=function(t){for(var n=t.length,e=new Array(n);n--;)e[n]=t[n];return e}}if(Date.now||(Date.now=function(){return+new Date}),u)try{u.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var h=this.Element.prototype,f=h.setAttribute,p=h.setAttributeNS,y=this.CSSStyleDeclaration.prototype,d=y.setProperty;h.setAttribute=function(t,n){f.call(this,t,n+"")},h.setAttributeNS=function(t,n,e){p.call(this,t,n,e+"")},y.setProperty=function(t,n,e){d.call(this,t,n+"",e)}}function g(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function v(t){return null===t?NaN:+t}function x(t){return!isNaN(t)}function m(t){return{left:function(n,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)<0?r=o+1:i=o}return r},right:function(n,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}o.ascending=g,o.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},o.min=function(t,n){var e,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){e=r;break}for(;++i<o;)null!=(r=t[i])&&e>r&&(e=r)}else{for(;++i<o;)if(null!=(r=n.call(t,t[i],i))&&r>=r){e=r;break}for(;++i<o;)null!=(r=n.call(t,t[i],i))&&e>r&&(e=r)}return e},o.max=function(t,n){var e,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){e=r;break}for(;++i<o;)null!=(r=t[i])&&r>e&&(e=r)}else{for(;++i<o;)if(null!=(r=n.call(t,t[i],i))&&r>=r){e=r;break}for(;++i<o;)null!=(r=n.call(t,t[i],i))&&r>e&&(e=r)}return e},o.extent=function(t,n){var e,r,i,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=t[o])&&r>=r){e=i=r;break}for(;++o<a;)null!=(r=t[o])&&(e>r&&(e=r),i<r&&(i=r))}else{for(;++o<a;)if(null!=(r=n.call(t,t[o],o))&&r>=r){e=i=r;break}for(;++o<a;)null!=(r=n.call(t,t[o],o))&&(e>r&&(e=r),i<r&&(i=r))}return[e,i]},o.sum=function(t,n){var e,r=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)x(e=+t[o])&&(r+=e);else for(;++o<i;)x(e=+n.call(t,t[o],o))&&(r+=e);return r},o.mean=function(t,n){var e,r=0,i=t.length,o=-1,a=i;if(1===arguments.length)for(;++o<i;)x(e=v(t[o]))?r+=e:--a;else for(;++o<i;)x(e=v(n.call(t,t[o],o)))?r+=e:--a;if(a)return r/a},o.quantile=function(t,n){var e=(t.length-1)*n+1,r=Math.floor(e),i=+t[r-1],o=e-r;return o?i+o*(t[r]-i):i},o.median=function(t,n){var e,r=[],i=t.length,a=-1;if(1===arguments.length)for(;++a<i;)x(e=v(t[a]))&&r.push(e);else for(;++a<i;)x(e=v(n.call(t,t[a],a)))&&r.push(e);if(r.length)return o.quantile(r.sort(g),.5)},o.variance=function(t,n){var e,r,i=t.length,o=0,a=0,s=-1,u=0;if(1===arguments.length)for(;++s<i;)x(e=v(t[s]))&&(a+=(r=e-o)*(e-(o+=r/++u)));else for(;++s<i;)x(e=v(n.call(t,t[s],s)))&&(a+=(r=e-o)*(e-(o+=r/++u)));if(u>1)return a/(u-1)},o.deviation=function(){var t=o.variance.apply(this,arguments);return t?Math.sqrt(t):t};var b=m(g);function w(t){return t.length}o.bisectLeft=b.left,o.bisect=o.bisectRight=b.right,o.bisector=function(t){return m(1===t.length?function(n,e){return g(t(n),e)}:t)},o.shuffle=function(t,n,e){(o=arguments.length)<3&&(e=t.length,o<2&&(n=0));for(var r,i,o=e-n;o;)i=Math.random()*o--|0,r=t[o+n],t[o+n]=t[i+n],t[i+n]=r;return t},o.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},o.pairs=function(t){for(var n=0,e=t.length-1,r=t[0],i=new Array(e<0?0:e);n<e;)i[n]=[r,r=t[++n]];return i},o.transpose=function(t){if(!(i=t.length))return[];for(var n=-1,e=o.min(t,w),r=new Array(e);++n<e;)for(var i,a=-1,s=r[n]=new Array(i);++a<i;)s[a]=t[a][n];return r},o.zip=function(){return o.transpose(arguments)},o.keys=function(t){var n=[];for(var e in t)n.push(e);return n},o.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},o.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},o.merge=function(t){for(var n,e,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(e=new Array(a);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--a]=r[n];return e};var _=Math.abs;function M(t){for(var n=1;t*n%1;)n*=10;return n}function S(t,n){for(var e in n)Object.defineProperty(t.prototype,e,{value:n[e],enumerable:!1})}function k(){this._=Object.create(null)}o.range=function(t,n,e){if(arguments.length<3&&(e=1,arguments.length<2&&(n=t,t=0)),(n-t)/e==1/0)throw new Error("infinite range");var r,i=[],o=M(_(e)),a=-1;if(t*=o,n*=o,(e*=o)<0)for(;(r=t+e*++a)>n;)i.push(r/o);else for(;(r=t+e*++a)<n;)i.push(r/o);return i},o.map=function(t,n){var e=new k;if(t instanceof k)t.forEach((function(t,n){e.set(t,n)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(1===arguments.length)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n.call(t,r=t[i],i),r)}else for(var a in t)e.set(a,t[a]);return e};function E(t){return"__proto__"==(t+="")||"\0"===t[0]?"\0"+t:t}function A(t){return"\0"===(t+="")[0]?t.slice(1):t}function L(t){return E(t)in this._}function N(t){return(t=E(t))in this._&&delete this._[t]}function C(){var t=[];for(var n in this._)t.push(A(n));return t}function P(){var t=0;for(var n in this._)++t;return t}function T(){for(var t in this._)return!1;return!0}function I(){this._=Object.create(null)}function z(t){return t}function D(t,n,e){return function(){var r=e.apply(n,arguments);return r===n?t:r}}function O(t,n){if(n in t)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(var e=0,r=q.length;e<r;++e){var i=q[e]+n;if(i in t)return i}}S(k,{has:L,get:function(t){return this._[E(t)]},set:function(t,n){return this._[E(t)]=n},remove:N,keys:C,values:function(){var t=[];for(var n in this._)t.push(this._[n]);return t},entries:function(){var t=[];for(var n in this._)t.push({key:A(n),value:this._[n]});return t},size:P,empty:T,forEach:function(t){for(var n in this._)t.call(this,A(n),this._[n])}}),o.nest=function(){var t,n,e={},r=[],i=[];function a(i,o,s){if(s>=r.length)return n?n.call(e,o):t?o.sort(t):o;for(var u,c,l,h,f=-1,p=o.length,y=r[s++],d=new k;++f<p;)(h=d.get(u=y(c=o[f])))?h.push(c):d.set(u,[c]);return i?(c=i(),l=function(t,n){c.set(t,a(i,n,s))}):(c={},l=function(t,n){c[t]=a(i,n,s)}),d.forEach(l),c}return e.map=function(t,n){return a(n,t,0)},e.entries=function(t){return function t(n,e){if(e>=r.length)return n;var o=[],a=i[e++];return n.forEach((function(n,r){o.push({key:n,values:t(r,e)})})),a?o.sort((function(t,n){return a(t.key,n.key)})):o}(a(o.map,t,0),0)},e.key=function(t){return r.push(t),e},e.sortKeys=function(t){return i[r.length-1]=t,e},e.sortValues=function(n){return t=n,e},e.rollup=function(t){return n=t,e},e},o.set=function(t){var n=new I;if(t)for(var e=0,r=t.length;e<r;++e)n.add(t[e]);return n},S(I,{has:L,add:function(t){return this._[E(t+="")]=!0,t},remove:N,values:C,size:P,empty:T,forEach:function(t){for(var n in this._)t.call(this,A(n))}}),o.behavior={},o.rebind=function(t,n){for(var e,r=1,i=arguments.length;++r<i;)t[e=arguments[r]]=D(t,n,n[e]);return t};var q=["webkit","ms","moz","Moz","o","O"];function R(){}function j(){}function G(t){var n=[],e=new k;function r(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}return r.on=function(r,i){var o,a=e.get(r);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),e.remove(r)),i&&n.push(e.set(r,{on:i})),t)},r}function V(){o.event.preventDefault()}function B(){for(var t,n=o.event;t=n.sourceEvent;)n=t;return n}function F(t){for(var n=new j,e=0,r=arguments.length;++e<r;)n[arguments[e]]=G(n);return n.of=function(e,r){return function(i){try{var a=i.sourceEvent=o.event;i.target=t,o.event=i,n[i.type].apply(e,r)}finally{o.event=a}}},n}o.dispatch=function(){for(var t=new j,n=-1,e=arguments.length;++n<e;)t[arguments[n]]=G(t);return t},j.prototype.on=function(t,n){var e=t.indexOf("."),r="";if(e>=0&&(r=t.slice(e+1),t=t.slice(0,e)),t)return arguments.length<2?this[t].on(r):this[t].on(r,n);if(2===arguments.length){if(null==n)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},o.event=null,o.requote=function(t){return t.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,U={}.__proto__?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)t[e]=n[e]};function X(t){return U(t,W),t}var Z=function(t,n){return n.querySelector(t)},Y=function(t,n){return n.querySelectorAll(t)},K=function(t,n){var e=t.matches||t[O(t,"matchesSelector")];return(K=function(t,n){return e.call(t,n)})(t,n)};"function"==typeof Sizzle&&(Z=function(t,n){return Sizzle(t,n)[0]||null},Y=Sizzle,K=Sizzle.matchesSelector),o.selection=function(){return o.select(u.documentElement)};var W=o.selection.prototype=[];function $(t){return"function"==typeof t?t:function(){return Z(t,this)}}function J(t){return"function"==typeof t?t:function(){return Y(t,this)}}W.select=function(t){var n,e,r,i,o=[];t=$(t);for(var a=-1,s=this.length;++a<s;){o.push(n=[]),n.parentNode=(r=this[a]).parentNode;for(var u=-1,c=r.length;++u<c;)(i=r[u])?(n.push(e=t.call(i,i.__data__,u,a)),e&&"__data__"in i&&(e.__data__=i.__data__)):n.push(null)}return X(o)},W.selectAll=function(t){var n,e,r=[];t=J(t);for(var i=-1,o=this.length;++i<o;)for(var a=this[i],u=-1,c=a.length;++u<c;)(e=a[u])&&(r.push(n=s(t.call(e,e.__data__,u,i))),n.parentNode=e);return X(r)};var Q="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,n){return t=o.ns.qualify(t),null==n?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof n?t.local?function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}:function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}:t.local?function(){this.setAttributeNS(t.space,t.local,n)}:function(){this.setAttribute(t,n)}}function et(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+o.requote(t)+"(?:\\s+|$)","g")}function it(t){return(t+"").trim().split(/^|\s+/)}function ot(t,n){var e=(t=it(t).map(at)).length;return"function"==typeof n?function(){for(var r=-1,i=n.apply(this,arguments);++r<e;)t[r](this,i)}:function(){for(var r=-1;++r<e;)t[r](this,n)}}function at(t){var n=rt(t);return function(e,r){if(i=e.classList)return r?i.add(t):i.remove(t);var i=e.getAttribute("class")||"";r?(n.lastIndex=0,n.test(i)||e.setAttribute("class",et(i+" "+t))):e.setAttribute("class",et(i.replace(n," ")))}}function st(t,n,e){return null==n?function(){this.style.removeProperty(t)}:"function"==typeof n?function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}:function(){this.style.setProperty(t,n,e)}}function ut(t,n){return null==n?function(){delete this[t]}:"function"==typeof n?function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}:function(){this[t]=n}}function ct(t){return"function"==typeof t?t:(t=o.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Q&&n.documentElement.namespaceURI===Q?n.createElement(t):n.createElementNS(e,t)}}function lt(){var t=this.parentNode;t&&t.removeChild(this)}function ht(t){return{__data__:t}}function ft(t){return function(){return K(this,t)}}function pt(t){return arguments.length||(t=g),function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}}function yt(t,n){for(var e=0,r=t.length;e<r;e++)for(var i,o=t[e],a=0,s=o.length;a<s;a++)(i=o[a])&&n(i,a,e);return t}function dt(t){return U(t,gt),t}o.ns={prefix:tt,qualify:function(t){var n=t.indexOf(":"),e=t;return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),tt.hasOwnProperty(e)?{space:tt[e],local:t}:t}},W.attr=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node();return(t=o.ns.qualify(t)).local?e.getAttributeNS(t.space,t.local):e.getAttribute(t)}for(n in t)this.each(nt(n,t[n]));return this}return this.each(nt(t,n))},W.classed=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node(),r=(t=it(t)).length,i=-1;if(n=e.classList){for(;++i<r;)if(!n.contains(t[i]))return!1}else for(n=e.getAttribute("class");++i<r;)if(!rt(t[i]).test(n))return!1;return!0}for(n in t)this.each(ot(n,t[n]));return this}return this.each(ot(t,n))},W.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.each(st(e,t[e],n));return this}if(r<2){var i=this.node();return l(i).getComputedStyle(i,null).getPropertyValue(t)}e=""}return this.each(st(t,n,e))},W.property=function(t,n){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(n in t)this.each(ut(n,t[n]));return this}return this.each(ut(t,n))},W.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},W.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},W.append=function(t){return t=ct(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},W.insert=function(t,n){return t=ct(t),n=$(n),this.select((function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)}))},W.remove=function(){return this.each(lt)},W.data=function(t,n){var e,r,i=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(e=this[0]).length);++i<o;)(r=e[i])&&(t[i]=r.__data__);return t}function a(t,e){var r,i,o,a=t.length,l=e.length,h=Math.min(a,l),f=new Array(l),p=new Array(l),y=new Array(a);if(n){var d,g=new k,v=new Array(a);for(r=-1;++r<a;)(i=t[r])&&(g.has(d=n.call(i,i.__data__,r))?y[r]=i:g.set(d,i),v[r]=d);for(r=-1;++r<l;)(i=g.get(d=n.call(e,o=e[r],r)))?!0!==i&&(f[r]=i,i.__data__=o):p[r]=ht(o),g.set(d,!0);for(r=-1;++r<a;)r in v&&!0!==g.get(v[r])&&(y[r]=t[r])}else{for(r=-1;++r<h;)i=t[r],o=e[r],i?(i.__data__=o,f[r]=i):p[r]=ht(o);for(;r<l;++r)p[r]=ht(e[r]);for(;r<a;++r)y[r]=t[r]}p.update=f,p.parentNode=f.parentNode=y.parentNode=t.parentNode,s.push(p),u.push(f),c.push(y)}var s=dt([]),u=X([]),c=X([]);if("function"==typeof t)for(;++i<o;)a(e=this[i],t.call(e,e.parentNode.__data__,i));else for(;++i<o;)a(e=this[i],t);return u.enter=function(){return s},u.exit=function(){return c},u},W.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},W.filter=function(t){var n,e,r,i=[];"function"!=typeof t&&(t=ft(t));for(var o=0,a=this.length;o<a;o++){i.push(n=[]),n.parentNode=(e=this[o]).parentNode;for(var s=0,u=e.length;s<u;s++)(r=e[s])&&t.call(r,r.__data__,s,o)&&n.push(r)}return X(i)},W.order=function(){for(var t=-1,n=this.length;++t<n;)for(var e,r=this[t],i=r.length-1,o=r[i];--i>=0;)(e=r[i])&&(o&&o!==e.nextSibling&&o.parentNode.insertBefore(e,o),o=e);return this},W.sort=function(t){t=pt.apply(this,arguments);for(var n=-1,e=this.length;++n<e;)this[n].sort(t);return this.order()},W.each=function(t){return yt(this,(function(n,e,r){t.call(n,n.__data__,e,r)}))},W.call=function(t){var n=s(arguments);return t.apply(n[0]=this,n),this},W.empty=function(){return!this.node()},W.node=function(){for(var t=0,n=this.length;t<n;t++)for(var e=this[t],r=0,i=e.length;r<i;r++){var o=e[r];if(o)return o}return null},W.size=function(){var t=0;return yt(this,(function(){++t})),t};var gt=[];function vt(t){var n,e;return function(r,i,o){var a,s=t[o].update,u=s.length;for(o!=e&&(e=o,n=0),i>=n&&(n=i+1);!(a=s[n])&&++n<u;);return a}}function xt(t,n,e){var r="__on"+t,i=t.indexOf("."),a=bt;i>0&&(t=t.slice(0,i));var u=mt.get(t);function c(){var n=this[r];n&&(this.removeEventListener(t,n,n.$),delete this[r])}return u&&(t=u,a=wt),i?n?function(){var i=a(n,s(arguments));c.call(this),this.addEventListener(t,this[r]=i,i.$=e),i._=n}:c:n?R:function(){var n,e=new RegExp("^__on([^.]+)"+o.requote(t)+"$");for(var r in this)if(n=r.match(e)){var i=this[r];this.removeEventListener(n[1],i,i.$),delete this[r]}}}o.selection.enter=dt,o.selection.enter.prototype=gt,gt.append=W.append,gt.empty=W.empty,gt.node=W.node,gt.call=W.call,gt.size=W.size,gt.select=function(t){for(var n,e,r,i,o,a=[],s=-1,u=this.length;++s<u;){r=(i=this[s]).update,a.push(n=[]),n.parentNode=i.parentNode;for(var c=-1,l=i.length;++c<l;)(o=i[c])?(n.push(r[c]=e=t.call(i.parentNode,o.__data__,c,s)),e.__data__=o.__data__):n.push(null)}return X(a)},gt.insert=function(t,n){return arguments.length<2&&(n=vt(this)),W.insert.call(this,t,n)},o.select=function(t){var n;return"string"==typeof t?(n=[Z(t,u)]).parentNode=u.documentElement:(n=[t]).parentNode=c(t),X([n])},o.selectAll=function(t){var n;return"string"==typeof t?(n=s(Y(t,u))).parentNode=u.documentElement:(n=s(t)).parentNode=null,X([n])},W.on=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=!1),t)this.each(xt(e,t[e],n));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;e=!1}return this.each(xt(t,n,e))};var mt=o.map({mouseenter:"mouseover",mouseleave:"mouseout"});function bt(t,n){return function(e){var r=o.event;o.event=e,n[0]=this.__data__;try{t.apply(this,n)}finally{o.event=r}}}function wt(t,n){var e=bt(t,n);return function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}u&&mt.forEach((function(t){"on"+t in u&&mt.remove(t)}));var _t,Mt=0;function St(t){var n=".dragsuppress-"+ ++Mt,e="click"+n,r=o.select(l(t)).on("touchmove"+n,V).on("dragstart"+n,V).on("selectstart"+n,V);if(null==_t&&(_t=!("onselectstart"in t)&&O(t.style,"userSelect")),_t){var i=c(t).style,a=i[_t];i[_t]="none"}return function(t){if(r.on(n,null),_t&&(i[_t]=a),t){var o=function(){r.on(e,null)};r.on(e,(function(){V(),o()}),!0),setTimeout(o,0)}}}o.mouse=function(t){return Et(t,B())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Et(t,n){n.changedTouches&&(n=n.changedTouches[0]);var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();if(kt<0){var i=l(t);if(i.scrollX||i.scrollY){var a=(e=o.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(a.f||a.e),e.remove()}}return kt?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function At(){return o.event.changedTouches[0].identifier}o.touch=function(t,n,e){if(arguments.length<3&&(e=n,n=B().changedTouches),n)for(var r,i=0,o=n.length;i<o;++i)if((r=n[i]).identifier===e)return Et(t,r)},o.behavior.drag=function(){var t=F(i,"drag","dragstart","dragend"),n=null,e=a(R,o.mouse,l,"mousemove","mouseup"),r=a(At,o.touch,z,"touchmove","touchend");function i(){this.on("mousedown.drag",e).on("touchstart.drag",r)}function a(e,r,i,a,s){return function(){var u,c=this,l=o.event.target.correspondingElement||o.event.target,h=c.parentNode,f=t.of(c,arguments),p=0,y=e(),d=".drag"+(null==y?"":"-"+y),g=o.select(i(l)).on(a+d,m).on(s+d,b),v=St(l),x=r(h,y);function m(){var t,n,e=r(h,y);e&&(t=e[0]-x[0],n=e[1]-x[1],p|=t|n,x=e,f({type:"drag",x:e[0]+u[0],y:e[1]+u[1],dx:t,dy:n}))}function b(){r(h,y)&&(g.on(a+d,null).on(s+d,null),v(p),f({type:"dragend"}))}u=n?[(u=n.apply(c,arguments)).x-x[0],u.y-x[1]]:[0,0],f({type:"dragstart"})}}return i.origin=function(t){return arguments.length?(n=t,i):n},o.rebind(i,t,"on")},o.touches=function(t,n){return arguments.length<2&&(n=B().touches),n?s(n).map((function(n){var e=Et(t,n);return e.identifier=n.identifier,e})):[]};var Lt=1e-6,Nt=1e-12,Ct=Math.PI,Pt=2*Ct,Tt=Pt-Lt,It=Ct/2,zt=Ct/180,Dt=180/Ct;function Ot(t){return t>0?1:t<0?-1:0}function qt(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])}function Rt(t){return t>1?0:t<-1?Ct:Math.acos(t)}function jt(t){return t>1?It:t<-1?-It:Math.asin(t)}function Gt(t){return((t=Math.exp(t))+1/t)/2}function Vt(t){return(t=Math.sin(t/2))*t}var Bt=Math.SQRT2;o.interpolateZoom=function(t,n){var e,r,i=t[0],o=t[1],a=t[2],s=n[0],u=n[1],c=n[2],l=s-i,h=u-o,f=l*l+h*h;if(f<Nt)r=Math.log(c/a)/Bt,e=function(t){return[i+t*l,o+t*h,a*Math.exp(Bt*t*r)]};else{var p=Math.sqrt(f),y=(c*c-a*a+4*f)/(2*a*2*p),d=(c*c-a*a-4*f)/(2*c*2*p),g=Math.log(Math.sqrt(y*y+1)-y),v=Math.log(Math.sqrt(d*d+1)-d);r=(v-g)/Bt,e=function(t){var n,e=t*r,s=Gt(g),u=a/(2*p)*(s*(n=Bt*e+g,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+u*l,o+u*h,a*s/Gt(Bt*e+g)]}}return e.duration=1e3*r,e},o.behavior.zoom=function(){var t,n,e,r,i,a,s,c,h,f={x:0,y:0,k:1},p=[960,500],y=Ut,d=250,g=0,v="mousedown.zoom",x="mousemove.zoom",m="mouseup.zoom",b="touchstart.zoom",w=F(_,"zoomstart","zoom","zoomend");function _(t){t.on(v,P).on(Ht+".zoom",I).on("dblclick.zoom",z).on(b,T)}function M(t){return[(t[0]-f.x)/f.k,(t[1]-f.y)/f.k]}function S(t){f.k=Math.max(y[0],Math.min(y[1],t))}function k(t,n){n=function(t){return[t[0]*f.k+f.x,t[1]*f.k+f.y]}(n),f.x+=t[0]-n[0],f.y+=t[1]-n[1]}function E(t,e,r,i){t.__chart__={x:f.x,y:f.y,k:f.k},S(Math.pow(2,i)),k(n=e,r),t=o.select(t),d>0&&(t=t.transition().duration(d)),t.call(_.event)}function A(){s&&s.domain(a.range().map((function(t){return(t-f.x)/f.k})).map(a.invert)),h&&h.domain(c.range().map((function(t){return(t-f.y)/f.k})).map(c.invert))}function L(t){g++||t({type:"zoomstart"})}function N(t){A(),t({type:"zoom",scale:f.k,translate:[f.x,f.y]})}function C(t){--g||(t({type:"zoomend"}),n=null)}function P(){var t=this,n=w.of(t,arguments),e=0,r=o.select(l(t)).on(x,s).on(m,u),i=M(o.mouse(t)),a=St(t);function s(){e=1,k(o.mouse(t),i),N(n)}function u(){r.on(x,null).on(m,null),a(e),C(n)}ws.call(t),L(n)}function T(){var t,n=this,e=w.of(n,arguments),r={},a=0,s=".zoom-"+o.event.changedTouches[0].identifier,u="touchmove"+s,c="touchend"+s,l=[],h=o.select(n),p=St(n);function y(){var e=o.touches(n);return t=f.k,e.forEach((function(t){t.identifier in r&&(r[t.identifier]=M(t))})),e}function d(){var t=o.event.target;o.select(t).on(u,g).on(c,x),l.push(t);for(var e=o.event.changedTouches,s=0,h=e.length;s<h;++s)r[e[s].identifier]=null;var p=y(),d=Date.now();if(1===p.length){if(d-i<500){var v=p[0];E(n,v,r[v.identifier],Math.floor(Math.log(f.k)/Math.LN2)+1),V()}i=d}else if(p.length>1){v=p[0];var m=p[1],b=v[0]-m[0],w=v[1]-m[1];a=b*b+w*w}}function g(){var s,u,c,l,h=o.touches(n);ws.call(n);for(var f=0,p=h.length;f<p;++f,l=null)if(c=h[f],l=r[c.identifier]){if(u)break;s=c,u=l}if(l){var y=(y=c[0]-s[0])*y+(y=c[1]-s[1])*y,d=a&&Math.sqrt(y/a);s=[(s[0]+c[0])/2,(s[1]+c[1])/2],u=[(u[0]+l[0])/2,(u[1]+l[1])/2],S(d*t)}i=null,k(s,u),N(e)}function x(){if(o.event.touches.length){for(var t=o.event.changedTouches,n=0,i=t.length;n<i;++n)delete r[t[n].identifier];for(var a in r)return void y()}o.selectAll(l).on(s,null),h.on(v,P).on(b,T),p(),C(e)}d(),L(e),h.on(v,null).on(b,d)}function I(){var i=w.of(this,arguments);r?clearTimeout(r):(ws.call(this),t=M(n=e||o.mouse(this)),L(i)),r=setTimeout((function(){r=null,C(i)}),50),V(),S(Math.pow(2,.002*Ft())*f.k),k(n,t),N(i)}function z(){var t=o.mouse(this),n=Math.log(f.k)/Math.LN2;E(this,t,M(t),o.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return Ht||(Ht="onwheel"in u?(Ft=function(){return-o.event.deltaY*(o.event.deltaMode?120:1)},"wheel"):"onmousewheel"in u?(Ft=function(){return o.event.wheelDelta},"mousewheel"):(Ft=function(){return-o.event.detail},"MozMousePixelScroll")),_.event=function(t){t.each((function(){var t=w.of(this,arguments),e=f;Ss?o.select(this).transition().each("start.zoom",(function(){f=this.__chart__||{x:0,y:0,k:1},L(t)})).tween("zoom:zoom",(function(){var r=p[0],i=p[1],a=n?n[0]:r/2,s=n?n[1]:i/2,u=o.interpolateZoom([(a-f.x)/f.k,(s-f.y)/f.k,r/f.k],[(a-e.x)/e.k,(s-e.y)/e.k,r/e.k]);return function(n){var e=u(n),i=r/e[2];this.__chart__=f={x:a-e[0]*i,y:s-e[1]*i,k:i},N(t)}})).each("interrupt.zoom",(function(){C(t)})).each("end.zoom",(function(){C(t)})):(this.__chart__=f,L(t),N(t),C(t))}))},_.translate=function(t){return arguments.length?(f={x:+t[0],y:+t[1],k:f.k},A(),_):[f.x,f.y]},_.scale=function(t){return arguments.length?(f={x:f.x,y:f.y,k:null},S(+t),A(),_):f.k},_.scaleExtent=function(t){return arguments.length?(y=null==t?Ut:[+t[0],+t[1]],_):y},_.center=function(t){return arguments.length?(e=t&&[+t[0],+t[1]],_):e},_.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],_):p},_.duration=function(t){return arguments.length?(d=+t,_):d},_.x=function(t){return arguments.length?(s=t,a=t.copy(),f={x:0,y:0,k:1},_):s},_.y=function(t){return arguments.length?(h=t,c=t.copy(),f={x:0,y:0,k:1},_):h},o.rebind(_,w,"on")};var Ft,Ht,Ut=[0,1/0];function Xt(){}function Zt(t,n,e){return this instanceof Zt?(this.h=+t,this.s=+n,void(this.l=+e)):arguments.length<2?t instanceof Zt?new Zt(t.h,t.s,t.l):pn(""+t,yn,Zt):new Zt(t,n,e)}o.color=Xt,Xt.prototype.toString=function(){return this.rgb()+""},o.hsl=Zt;var Yt=Zt.prototype=new Xt;function Kt(t,n,e){var r,i;function o(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?r+(i-r)*t/60:t<180?i:t<240?r+(i-r)*(240-t)/60:r}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,n=isNaN(n)||n<0?0:n>1?1:n,r=2*(e=e<0?0:e>1?1:e)-(i=e<=.5?e*(1+n):e+n-e*n),new un(o(t+120),o(t),o(t-120))}function Wt(t,n,e){return this instanceof Wt?(this.h=+t,this.c=+n,void(this.l=+e)):arguments.length<2?t instanceof Wt?new Wt(t.h,t.c,t.l):rn(t instanceof Qt?t.l:(t=dn((t=o.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Wt(t,n,e)}Yt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Zt(this.h,this.s,this.l/t)},Yt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Zt(this.h,this.s,t*this.l)},Yt.rgb=function(){return Kt(this.h,this.s,this.l)},o.hcl=Wt;var $t=Wt.prototype=new Xt;function Jt(t,n,e){return isNaN(t)&&(t=0),isNaN(n)&&(n=0),new Qt(e,Math.cos(t*=zt)*n,Math.sin(t)*n)}function Qt(t,n,e){return this instanceof Qt?(this.l=+t,this.a=+n,void(this.b=+e)):arguments.length<2?t instanceof Qt?new Qt(t.l,t.a,t.b):t instanceof Wt?Jt(t.h,t.c,t.l):dn((t=un(t)).r,t.g,t.b):new Qt(t,n,e)}$t.brighter=function(t){return new Wt(this.h,this.c,Math.min(100,this.l+tn*(arguments.length?t:1)))},$t.darker=function(t){return new Wt(this.h,this.c,Math.max(0,this.l-tn*(arguments.length?t:1)))},$t.rgb=function(){return Jt(this.h,this.c,this.l).rgb()},o.lab=Qt;var tn=18,nn=Qt.prototype=new Xt;function en(t,n,e){var r=(t+16)/116,i=r+n/500,o=r-e/200;return new un(sn(3.2404542*(i=.95047*on(i))-1.5371385*(r=1*on(r))-.4985314*(o=1.08883*on(o))),sn(-.969266*i+1.8760108*r+.041556*o),sn(.0556434*i-.2040259*r+1.0572252*o))}function rn(t,n,e){return t>0?new Wt(Math.atan2(e,n)*Dt,Math.sqrt(n*n+e*e),t):new Wt(NaN,NaN,t)}function on(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function an(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function sn(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function un(t,n,e){return this instanceof un?(this.r=~~t,this.g=~~n,void(this.b=~~e)):arguments.length<2?t instanceof un?new un(t.r,t.g,t.b):pn(""+t,un,Kt):new un(t,n,e)}function cn(t){return new un(t>>16,t>>8&255,255&t)}function ln(t){return cn(t)+""}nn.brighter=function(t){return new Qt(Math.min(100,this.l+tn*(arguments.length?t:1)),this.a,this.b)},nn.darker=function(t){return new Qt(Math.max(0,this.l-tn*(arguments.length?t:1)),this.a,this.b)},nn.rgb=function(){return en(this.l,this.a,this.b)},o.rgb=un;var hn=un.prototype=new Xt;function fn(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function pn(t,n,e){var r,i,o,a=0,s=0,u=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return n(vn(i[0]),vn(i[1]),vn(i[2]))}return(o=xn.get(t))?n(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a|=a>>4,s=240&o,s|=s>>4,u=15&o,u|=u<<4):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,u=255&o)),n(a,s,u))}function yn(t,n,e){var r,i,o=Math.min(t/=255,n/=255,e/=255),a=Math.max(t,n,e),s=a-o,u=(a+o)/2;return s?(i=u<.5?s/(a+o):s/(2-a-o),r=t==a?(n-e)/s+(n<e?6:0):n==a?(e-t)/s+2:(t-n)/s+4,r*=60):(r=NaN,i=u>0&&u<1?0:r),new Zt(r,i,u)}function dn(t,n,e){var r=an((.4124564*(t=gn(t))+.3575761*(n=gn(n))+.1804375*(e=gn(e)))/.95047),i=an((.2126729*t+.7151522*n+.072175*e)/1);return Qt(116*i-16,500*(r-i),200*(i-an((.0193339*t+.119192*n+.9503041*e)/1.08883)))}function gn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function vn(t){var n=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*n):n}hn.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var n=this.r,e=this.g,r=this.b,i=30;return n||e||r?(n&&n<i&&(n=i),e&&e<i&&(e=i),r&&r<i&&(r=i),new un(Math.min(255,n/t),Math.min(255,e/t),Math.min(255,r/t))):new un(i,i,i)},hn.darker=function(t){return new un((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},hn.hsl=function(){return yn(this.r,this.g,this.b)},hn.toString=function(){return"#"+fn(this.r)+fn(this.g)+fn(this.b)};var xn=o.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function mn(t){return"function"==typeof t?t:function(){return t}}function bn(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),wn(n,e,t,r)}}function wn(t,n,e,r){var i={},a=o.dispatch("beforesend","progress","load","error"),u={},c=new XMLHttpRequest,l=null;function h(){var t,n=c.status;if(!n&&function(t){var n=t.responseType;return n&&"text"!==n?t.response:t.responseText}(c)||n>=200&&n<300||304===n){try{t=e.call(i,c)}catch(t){return void a.error.call(i,t)}a.load.call(i,t)}else a.error.call(i,c)}return this.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(t)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=h:c.onreadystatechange=function(){c.readyState>3&&h()},c.onprogress=function(t){var n=o.event;o.event=t;try{a.progress.call(i,c)}finally{o.event=n}},i.header=function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?u[t]:(null==n?delete u[t]:u[t]=n+"",i)},i.mimeType=function(t){return arguments.length?(n=null==t?null:t+"",i):n},i.responseType=function(t){return arguments.length?(l=t,i):l},i.response=function(t){return e=t,i},["get","post"].forEach((function(t){i[t]=function(){return i.send.apply(i,[t].concat(s(arguments)))}})),i.send=function(e,r,o){if(2===arguments.length&&"function"==typeof r&&(o=r,r=null),c.open(e,t,!0),null==n||"accept"in u||(u.accept=n+",*/*"),c.setRequestHeader)for(var s in u)c.setRequestHeader(s,u[s]);return null!=n&&c.overrideMimeType&&c.overrideMimeType(n),null!=l&&(c.responseType=l),null!=o&&i.on("error",o).on("load",(function(t){o(null,t)})),a.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},o.rebind(i,a,"on"),null==r?i:i.get(function(t){return 1===t.length?function(n,e){t(null==n?e:null)}:t}(r))}xn.forEach((function(t,n){xn.set(t,cn(n))})),o.functor=mn,o.xhr=bn(z),o.dsv=function(t,n){var e=new RegExp('["'+t+"\n]"),r=t.charCodeAt(0);function i(t,e,r){arguments.length<3&&(r=e,e=null);var i=wn(t,n,null==e?o:a(e),r);return i.row=function(t){return arguments.length?i.response(null==(e=t)?o:a(t)):e},i}function o(t){return i.parse(t.responseText)}function a(t){return function(n){return i.parse(n.responseText,t)}}function s(n){return n.map(u).join(t)}function u(t){return e.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return i.parse=function(t,n){var e;return i.parseRows(t,(function(t,r){if(e)return e(t,r-1);var i=new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+"]"})).join(",")+"}");e=n?function(t,e){return n(i(t),e)}:i}))},i.parseRows=function(t,n){var e,i,o={},a={},s=[],u=t.length,c=0,l=0;function h(){if(c>=u)return a;if(i)return i=!1,o;var n=c;if(34===t.charCodeAt(n)){for(var e=n;e++<u;)if(34===t.charCodeAt(e)){if(34!==t.charCodeAt(e+1))break;++e}return c=e+2,13===(s=t.charCodeAt(e+1))?(i=!0,10===t.charCodeAt(e+2)&&++c):10===s&&(i=!0),t.slice(n+1,e).replace(/""/g,'"')}for(;c<u;){var s,l=1;if(10===(s=t.charCodeAt(c++)))i=!0;else if(13===s)i=!0,10===t.charCodeAt(c)&&(++c,++l);else if(s!==r)continue;return t.slice(n,c-l)}return t.slice(n)}for(;(e=h())!==a;){for(var f=[];e!==o&&e!==a;)f.push(e),e=h();n&&null==(f=n(f,l++))||s.push(f)}return s},i.format=function(n){if(Array.isArray(n[0]))return i.formatRows(n);var e=new I,r=[];return n.forEach((function(t){for(var n in t)e.has(n)||r.push(e.add(n))})),[r.map(u).join(t)].concat(n.map((function(n){return r.map((function(t){return u(n[t])})).join(t)}))).join("\n")},i.formatRows=function(t){return t.map(s).join("\n")},i},o.csv=o.dsv(",","text/csv"),o.tsv=o.dsv("\t","text/tab-separated-values");var _n,Mn,Sn,kn,En=this[O(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function An(t,n,e){var r=arguments.length;r<2&&(n=0),r<3&&(e=Date.now());var i=e+n,o={c:t,t:i,n:null};return Mn?Mn.n=o:_n=o,Mn=o,Sn||(kn=clearTimeout(kn),Sn=1,En(Ln)),o}function Ln(){var t=Nn(),n=Cn()-t;n>24?(isFinite(n)&&(clearTimeout(kn),kn=setTimeout(Ln,n)),Sn=0):(Sn=1,En(Ln))}function Nn(){for(var t=Date.now(),n=_n;n;)t>=n.t&&n.c(t-n.t)&&(n.c=null),n=n.n;return t}function Cn(){for(var t,n=_n,e=1/0;n;)n.c?(n.t<e&&(e=n.t),n=(t=n).n):n=t?t.n=n.n:_n=n.n;return Mn=t,e}function Pn(t,n){return n-(t?Math.ceil(Math.log(t)/Math.LN10):1)}o.timer=function(){An.apply(this,arguments)},o.timer.flush=function(){Nn(),Cn()},o.round=function(t,n){return n?Math.round(t*(n=Math.pow(10,n)))/n:Math.round(t)};var Tn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,n){var e=Math.pow(10,3*_(8-n));return{scale:n>8?function(t){return t/e}:function(t){return t*e},symbol:t}}));function In(t){var n=t.decimal,e=t.thousands,r=t.grouping,i=t.currency,a=r&&e?function(t,n){for(var i=t.length,o=[],a=0,s=r[0],u=0;i>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>n));)s=r[a=(a+1)%r.length];return o.reverse().join(e)}:z;return function(t){var e=zn.exec(t),r=e[1]||" ",s=e[2]||">",u=e[3]||"-",c=e[4]||"",l=e[5],h=+e[6],f=e[7],p=e[8],y=e[9],d=1,g="",v="",x=!1,m=!0;switch(p&&(p=+p.substring(1)),(l||"0"===r&&"="===s)&&(l=r="0",s="="),y){case"n":f=!0,y="g";break;case"%":d=100,v="%",y="f";break;case"p":d=100,v="%",y="r";break;case"b":case"o":case"x":case"X":"#"===c&&(g="0"+y.toLowerCase());case"c":m=!1;case"d":x=!0,p=0;break;case"s":d=-1,y="r"}"$"===c&&(g=i[0],v=i[1]),"r"!=y||p||(y="g"),null!=p&&("g"==y?p=Math.max(1,Math.min(21,p)):"e"!=y&&"f"!=y||(p=Math.max(0,Math.min(20,p)))),y=Dn.get(y)||On;var b=l&&f;return function(t){var e=v;if(x&&t%1)return"";var i=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===u?"":u;if(d<0){var c=o.formatPrefix(t,p);t=c.scale(t),e=c.symbol+v}else t*=d;var w,_,M=(t=y(t,p)).lastIndexOf(".");if(M<0){var S=m?t.lastIndexOf("e"):-1;S<0?(w=t,_=""):(w=t.substring(0,S),_=t.substring(S))}else w=t.substring(0,M),_=n+t.substring(M+1);!l&&f&&(w=a(w,1/0));var k=g.length+w.length+_.length+(b?0:i.length),E=k<h?new Array(k=h-k+1).join(r):"";return b&&(w=a(E+w,E.length?h-_.length:1/0)),i+=g,t=w+_,("<"===s?i+t+E:">"===s?E+i+t:"^"===s?E.substring(0,k>>=1)+i+t+E.substring(k):i+(b?t:E+t))+e}}}o.formatPrefix=function(t,n){var e=0;return(t=+t)&&(t<0&&(t*=-1),n&&(t=o.round(t,Pn(t,n))),e=1+Math.floor(1e-12+Math.log(t)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),Tn[8+e/3]};var zn=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Dn=o.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,n){return t.toPrecision(n)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},r:function(t,n){return(t=o.round(t,Pn(t,n))).toFixed(Math.max(0,Math.min(20,Pn(t*(1+1e-15),n))))}});function On(t){return t+""}var qn=o.time={},Rn=Date;function jn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}jn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Gn.setUTCDate.apply(this._,arguments)},setDay:function(){Gn.setUTCDay.apply(this._,arguments)},setFullYear:function(){Gn.setUTCFullYear.apply(this._,arguments)},setHours:function(){Gn.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Gn.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Gn.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Gn.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Gn.setUTCSeconds.apply(this._,arguments)},setTime:function(){Gn.setTime.apply(this._,arguments)}};var Gn=Date.prototype;function Vn(t,n,e){function r(n){var e=t(n),r=o(e,1);return n-e<r-n?e:r}function i(e){return n(e=t(new Rn(e-1)),1),e}function o(t,e){return n(t=new Rn(+t),e),t}function a(t,r,o){var a=i(t),s=[];if(o>1)for(;a<r;)e(a)%o||s.push(new Date(+a)),n(a,1);else for(;a<r;)s.push(new Date(+a)),n(a,1);return s}t.floor=t,t.round=r,t.ceil=i,t.offset=o,t.range=a;var s=t.utc=Bn(t);return s.floor=s,s.round=Bn(r),s.ceil=Bn(i),s.offset=Bn(o),s.range=function(t,n,e){try{Rn=jn;var r=new jn;return r._=t,a(r,n,e)}finally{Rn=Date}},t}function Bn(t){return function(n,e){try{Rn=jn;var r=new jn;return r._=n,t(r,e)._}finally{Rn=Date}}}function Fn(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,a=t.days,s=t.shortDays,u=t.months,c=t.shortMonths;function l(t){var n=t.length;function e(e){for(var r,i,o,a=[],s=-1,u=0;++s<n;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=Hn[r=t.charAt(++s)])&&(r=t.charAt(++s)),(o=w[r])&&(r=o(e,null==i?"e"===r?" ":"0":i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}return e.parse=function(n){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(h(e,t,n,0)!=n.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);var r=null!=e.Z&&Rn!==jn,i=new(r?jn:Rn);return"j"in e?i.setFullYear(e.y,0,e.j):"W"in e||"U"in e?("w"in e||(e.w="W"in e?1:0),i.setFullYear(e.y,0,1),i.setFullYear(e.y,0,"W"in e?(e.w+6)%7+7*e.W-(i.getDay()+5)%7:e.w+7*e.U-(i.getDay()+6)%7)):i.setFullYear(e.y,e.m,e.d),i.setHours(e.H+(e.Z/100|0),e.M+e.Z%100,e.S,e.L),r?i._:i},e.toString=function(){return t},e}function h(t,n,e,r){for(var i,o,a,s=0,u=n.length,c=e.length;s<u;){if(r>=c)return-1;if(37===(i=n.charCodeAt(s++))){if(a=n.charAt(s++),!(o=_[a in Hn?n.charAt(s++):a])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}l.utc=function(t){var n=l(t);function e(t){try{var e=new(Rn=jn);return e._=t,n(e)}finally{Rn=Date}}return e.parse=function(t){try{Rn=jn;var e=n.parse(t);return e&&e._}finally{Rn=Date}},e.toString=n.toString,e},l.multi=l.utc.multi=he;var f=o.map(),p=Yn(a),y=Kn(a),d=Yn(s),g=Kn(s),v=Yn(u),x=Kn(u),m=Yn(c),b=Kn(c);i.forEach((function(t,n){f.set(t.toLowerCase(),n)}));var w={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:l(n),d:function(t,n){return Zn(t.getDate(),n,2)},e:function(t,n){return Zn(t.getDate(),n,2)},H:function(t,n){return Zn(t.getHours(),n,2)},I:function(t,n){return Zn(t.getHours()%12||12,n,2)},j:function(t,n){return Zn(1+qn.dayOfYear(t),n,3)},L:function(t,n){return Zn(t.getMilliseconds(),n,3)},m:function(t,n){return Zn(t.getMonth()+1,n,2)},M:function(t,n){return Zn(t.getMinutes(),n,2)},p:function(t){return i[+(t.getHours()>=12)]},S:function(t,n){return Zn(t.getSeconds(),n,2)},U:function(t,n){return Zn(qn.sundayOfYear(t),n,2)},w:function(t){return t.getDay()},W:function(t,n){return Zn(qn.mondayOfYear(t),n,2)},x:l(e),X:l(r),y:function(t,n){return Zn(t.getFullYear()%100,n,2)},Y:function(t,n){return Zn(t.getFullYear()%1e4,n,4)},Z:ce,"%":function(){return"%"}},_={a:function(t,n,e){d.lastIndex=0;var r=d.exec(n.slice(e));return r?(t.w=g.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){p.lastIndex=0;var r=p.exec(n.slice(e));return r?(t.w=y.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){m.lastIndex=0;var r=m.exec(n.slice(e));return r?(t.m=b.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){v.lastIndex=0;var r=v.exec(n.slice(e));return r?(t.m=x.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,n,e){return h(t,w.c.toString(),n,e)},d:re,e:re,H:oe,I:oe,j:ie,L:ue,m:ee,M:ae,p:function(t,n,e){var r=f.get(n.slice(e,e+=2).toLowerCase());return null==r?-1:(t.p=r,e)},S:se,U:$n,w:Wn,W:Jn,x:function(t,n,e){return h(t,w.x.toString(),n,e)},X:function(t,n,e){return h(t,w.X.toString(),n,e)},y:te,Y:Qn,Z:ne,"%":le};return l}qn.year=Vn((function(t){return(t=qn.day(t)).setMonth(0,1),t}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t){return t.getFullYear()})),qn.years=qn.year.range,qn.years.utc=qn.year.utc.range,qn.day=Vn((function(t){var n=new Rn(2e3,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n}),(function(t,n){t.setDate(t.getDate()+n)}),(function(t){return t.getDate()-1})),qn.days=qn.day.range,qn.days.utc=qn.day.utc.range,qn.dayOfYear=function(t){var n=qn.year(t);return Math.floor((t-n-6e4*(t.getTimezoneOffset()-n.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t,n){n=7-n;var e=qn[t]=Vn((function(t){return(t=qn.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t}),(function(t,n){t.setDate(t.getDate()+7*Math.floor(n))}),(function(t){var e=qn.year(t).getDay();return Math.floor((qn.dayOfYear(t)+(e+n)%7)/7)-(e!==n)}));qn[t+"s"]=e.range,qn[t+"s"].utc=e.utc.range,qn[t+"OfYear"]=function(t){var e=qn.year(t).getDay();return Math.floor((qn.dayOfYear(t)+(e+n)%7)/7)}})),qn.week=qn.sunday,qn.weeks=qn.sunday.range,qn.weeks.utc=qn.sunday.utc.range,qn.weekOfYear=qn.sundayOfYear;var Hn={"-":"",_:" ",0:"0"},Un=/^\s*\d+/,Xn=/^%/;function Zn(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Yn(t){return new RegExp("^(?:"+t.map(o.requote).join("|")+")","i")}function Kn(t){for(var n=new k,e=-1,r=t.length;++e<r;)n.set(t[e].toLowerCase(),e);return n}function Wn(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function $n(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e));return r?(t.U=+r[0],e+r[0].length):-1}function Jn(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e));return r?(t.W=+r[0],e+r[0].length):-1}function Qn(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function te(t,n,e){Un.lastIndex=0;var r,i=Un.exec(n.slice(e,e+2));return i?(t.y=(r=+i[0])+(r>68?1900:2e3),e+i[0].length):-1}function ne(t,n,e){return/^[+-]\d{4}$/.test(n=n.slice(e,e+5))?(t.Z=-n,e+5):-1}function ee(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function re(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function ie(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+3));return r?(t.j=+r[0],e+r[0].length):-1}function oe(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function ae(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function se(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function ue(t,n,e){Un.lastIndex=0;var r=Un.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function ce(t){var n=t.getTimezoneOffset(),e=n>0?"-":"+",r=_(n)/60|0,i=_(n)%60;return e+Zn(r,"0",2)+Zn(i,"0",2)}function le(t,n,e){Xn.lastIndex=0;var r=Xn.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function he(t){for(var n=t.length,e=-1;++e<n;)t[e][0]=this(t[e][0]);return function(n){for(var e=0,r=t[e];!r[1](n);)r=t[++e];return r[0](n)}}o.locale=function(t){return{numberFormat:In(t),timeFormat:Fn(t)}};var fe=o.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function pe(){}o.format=fe.numberFormat,o.geo={},pe.prototype={s:0,t:0,add:function(t){de(t,this.t,ye),de(ye.s,this.s,this),this.s?this.t+=ye.t:this.s=ye.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ye=new pe;function de(t,n,e){var r=e.s=t+n,i=r-t,o=r-i;e.t=t-o+(n-i)}function ge(t,n){t&&xe.hasOwnProperty(t.type)&&xe[t.type](t,n)}o.geo.stream=function(t,n){t&&ve.hasOwnProperty(t.type)?ve[t.type](t,n):ge(t,n)};var ve={Feature:function(t,n){ge(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)ge(e[r].geometry,n)}},xe={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){me(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)me(e[r],n,0)},Polygon:function(t,n){be(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)be(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)ge(e[r],n)}};function me(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function be(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)me(t[e],n,1);n.polygonEnd()}o.geo.area=function(t){return we=0,o.geo.stream(t,ze),we};var we,_e,Me,Se,ke,Ee,Ae,Le,Ne,Ce,Pe,Te,Ie=new pe,ze={sphere:function(){we+=4*Ct},point:R,lineStart:R,lineEnd:R,polygonStart:function(){Ie.reset(),ze.lineStart=De},polygonEnd:function(){var t=2*Ie;we+=t<0?4*Ct+t:t,ze.lineStart=ze.lineEnd=ze.point=R}};function De(){var t,n,e,r,i;function o(t,n){n=n*zt/2+Ct/4;var o=(t*=zt)-e,a=o>=0?1:-1,s=a*o,u=Math.cos(n),c=Math.sin(n),l=i*c,h=r*u+l*Math.cos(s),f=l*a*Math.sin(s);Ie.add(Math.atan2(f,h)),e=t,r=u,i=c}ze.point=function(a,s){ze.point=o,e=(t=a)*zt,r=Math.cos(s=(n=s)*zt/2+Ct/4),i=Math.sin(s)},ze.lineEnd=function(){o(t,n)}}function Oe(t){var n=t[0],e=t[1],r=Math.cos(e);return[r*Math.cos(n),r*Math.sin(n),Math.sin(e)]}function qe(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Re(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function je(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Ge(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Ve(t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function Be(t){return[Math.atan2(t[1],t[0]),jt(t[2])]}function Fe(t,n){return _(t[0]-n[0])<Lt&&_(t[1]-n[1])<Lt}o.geo.bounds=function(){var t,n,e,r,i,a,s,u,c,l,h,f={point:p,lineStart:d,lineEnd:g,polygonStart:function(){f.point=v,f.lineStart=x,f.lineEnd=m,c=0,ze.polygonStart()},polygonEnd:function(){ze.polygonEnd(),f.point=p,f.lineStart=d,f.lineEnd=g,Ie<0?(t=-(e=180),n=-(r=90)):c>Lt?r=90:c<-Lt&&(n=-90),h[0]=t,h[1]=e}};function p(i,o){l.push(h=[t=i,e=i]),o<n&&(n=o),o>r&&(r=o)}function y(o,a){var s=Oe([o*zt,a*zt]);if(u){var c=Re(u,s),l=Re([c[1],-c[0],0],c);Ve(l),l=Be(l);var h=o-i,f=h>0?1:-1,y=l[0]*Dt*f,d=_(h)>180;if(d^(f*i<y&&y<f*o))(g=l[1]*Dt)>r&&(r=g);else if(d^(f*i<(y=(y+360)%360-180)&&y<f*o)){var g;(g=-l[1]*Dt)<n&&(n=g)}else a<n&&(n=a),a>r&&(r=a);d?o<i?b(t,o)>b(t,e)&&(e=o):b(o,e)>b(t,e)&&(t=o):e>=t?(o<t&&(t=o),o>e&&(e=o)):o>i?b(t,o)>b(t,e)&&(e=o):b(o,e)>b(t,e)&&(t=o)}else p(o,a);u=s,i=o}function d(){f.point=y}function g(){h[0]=t,h[1]=e,f.point=p,u=null}function v(t,n){if(u){var e=t-i;c+=_(e)>180?e+(e>0?360:-360):e}else a=t,s=n;ze.point(t,n),y(t,n)}function x(){ze.lineStart()}function m(){v(a,s),ze.lineEnd(),_(c)>Lt&&(t=-(e=180)),h[0]=t,h[1]=e,u=null}function b(t,n){return(n-=t)<0?n+360:n}function w(t,n){return t[0]-n[0]}function M(t,n){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}return function(i){if(r=e=-(t=n=1/0),l=[],o.geo.stream(i,f),c=l.length){l.sort(w);for(var a=1,s=[d=l[0]];a<c;++a)M((p=l[a])[0],d)||M(p[1],d)?(b(d[0],p[1])>b(d[0],d[1])&&(d[1]=p[1]),b(p[0],d[1])>b(d[0],d[1])&&(d[0]=p[0])):s.push(d=p);for(var u,c,p,y=-1/0,d=(a=0,s[c=s.length-1]);a<=c;d=p,++a)p=s[a],(u=b(d[1],p[0]))>y&&(y=u,t=p[0],e=d[1])}return l=h=null,t===1/0||n===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,n],[e,r]]}}(),o.geo.centroid=function(t){_e=Me=Se=ke=Ee=Ae=Le=Ne=Ce=Pe=Te=0,o.geo.stream(t,He);var n=Ce,e=Pe,r=Te,i=n*n+e*e+r*r;return i<Nt&&(n=Ae,e=Le,r=Ne,Me<Lt&&(n=Se,e=ke,r=Ee),(i=n*n+e*e+r*r)<Nt)?[NaN,NaN]:[Math.atan2(e,n)*Dt,jt(r/Math.sqrt(i))*Dt]};var He={sphere:R,point:Ue,lineStart:Ze,lineEnd:Ye,polygonStart:function(){He.lineStart=Ke},polygonEnd:function(){He.lineStart=Ze}};function Ue(t,n){t*=zt;var e=Math.cos(n*=zt);Xe(e*Math.cos(t),e*Math.sin(t),Math.sin(n))}function Xe(t,n,e){++_e,Se+=(t-Se)/_e,ke+=(n-ke)/_e,Ee+=(e-Ee)/_e}function Ze(){var t,n,e;function r(r,i){r*=zt;var o=Math.cos(i*=zt),a=o*Math.cos(r),s=o*Math.sin(r),u=Math.sin(i),c=Math.atan2(Math.sqrt((c=n*u-e*s)*c+(c=e*a-t*u)*c+(c=t*s-n*a)*c),t*a+n*s+e*u);Me+=c,Ae+=c*(t+(t=a)),Le+=c*(n+(n=s)),Ne+=c*(e+(e=u)),Xe(t,n,e)}He.point=function(i,o){i*=zt;var a=Math.cos(o*=zt);t=a*Math.cos(i),n=a*Math.sin(i),e=Math.sin(o),He.point=r,Xe(t,n,e)}}function Ye(){He.point=Ue}function Ke(){var t,n,e,r,i;function o(t,n){t*=zt;var o=Math.cos(n*=zt),a=o*Math.cos(t),s=o*Math.sin(t),u=Math.sin(n),c=r*u-i*s,l=i*a-e*u,h=e*s-r*a,f=Math.sqrt(c*c+l*l+h*h),p=e*a+r*s+i*u,y=f&&-Rt(p)/f,d=Math.atan2(f,p);Ce+=y*c,Pe+=y*l,Te+=y*h,Me+=d,Ae+=d*(e+(e=a)),Le+=d*(r+(r=s)),Ne+=d*(i+(i=u)),Xe(e,r,i)}He.point=function(a,s){t=a,n=s,He.point=o,a*=zt;var u=Math.cos(s*=zt);e=u*Math.cos(a),r=u*Math.sin(a),i=Math.sin(s),Xe(e,r,i)},He.lineEnd=function(){o(t,n),He.lineEnd=Ye,He.point=Ue}}function We(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function $e(){return!0}function Je(t,n,e,r,i){var o=[],a=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e=t[0],r=t[n];if(Fe(e,r)){i.lineStart();for(var s=0;s<n;++s)i.point((e=t[s])[0],e[1]);i.lineEnd()}else{var u=new tr(e,t,null,!0),c=new tr(e,null,u,!1);u.o=c,o.push(u),a.push(c),u=new tr(r,t,null,!1),c=new tr(r,null,u,!0),u.o=c,o.push(u),a.push(c)}}})),a.sort(n),Qe(o),Qe(a),o.length){for(var s=0,u=e,c=a.length;s<c;++s)a[s].e=u=!u;for(var l,h,f=o[0];;){for(var p=f,y=!0;p.v;)if((p=p.n)===f)return;l=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(y)for(s=0,c=l.length;s<c;++s)i.point((h=l[s])[0],h[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(y)for(s=(l=p.p.z).length-1;s>=0;--s)i.point((h=l[s])[0],h[1]);else r(p.x,p.p.x,-1,i);p=p.p}l=(p=p.o).z,y=!y}while(!p.v);i.lineEnd()}}}function Qe(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function tr(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function nr(t,n,e,r){return function(i,a){var s,u=n(a),c=i.invert(r[0],r[1]),l={point:h,lineStart:p,lineEnd:y,polygonStart:function(){l.point=b,l.lineStart=w,l.lineEnd=_,s=[],d=[]},polygonEnd:function(){l.point=h,l.lineStart=p,l.lineEnd=y,s=o.merge(s);var t=function(t,n){var e=t[0],r=t[1],i=[Math.sin(e),-Math.cos(e),0],o=0,a=0;Ie.reset();for(var s=0,u=n.length;s<u;++s){var c=n[s],l=c.length;if(l)for(var h=c[0],f=h[0],p=h[1]/2+Ct/4,y=Math.sin(p),d=Math.cos(p),g=1;;){g===l&&(g=0);var v=(t=c[g])[0],x=t[1]/2+Ct/4,m=Math.sin(x),b=Math.cos(x),w=v-f,_=w>=0?1:-1,M=_*w,S=M>Ct,k=y*m;if(Ie.add(Math.atan2(k*_*Math.sin(M),d*b+k*Math.cos(M))),o+=S?w+_*Pt:w,S^f>=e^v>=e){var E=Re(Oe(h),Oe(t));Ve(E);var A=Re(i,E);Ve(A);var L=(S^w>=0?-1:1)*jt(A[2]);(r>L||r===L&&(E[0]||E[1]))&&(a+=S^w>=0?1:-1)}if(!g++)break;f=v,y=m,d=b,h=t}}return(o<-Lt||o<Lt&&Ie<-Lt)^1&a}(c,d);s.length?(m||(a.polygonStart(),m=!0),Je(s,ir,t,e,a)):t&&(m||(a.polygonStart(),m=!0),a.lineStart(),e(null,null,1,a),a.lineEnd()),m&&(a.polygonEnd(),m=!1),s=d=null},sphere:function(){a.polygonStart(),a.lineStart(),e(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(n,e){var r=i(n,e);t(n=r[0],e=r[1])&&a.point(n,e)}function f(t,n){var e=i(t,n);u.point(e[0],e[1])}function p(){l.point=f,u.lineStart()}function y(){l.point=h,u.lineEnd()}var d,g,v=rr(),x=n(v),m=!1;function b(t,n){g.push([t,n]);var e=i(t,n);x.point(e[0],e[1])}function w(){x.lineStart(),g=[]}function _(){b(g[0][0],g[0][1]),x.lineEnd();var t,n=x.clean(),e=v.buffer(),r=e.length;if(g.pop(),d.push(g),g=null,r)if(1&n){var i,o=-1;if((r=(t=e[0]).length-1)>0){for(m||(a.polygonStart(),m=!0),a.lineStart();++o<r;)a.point((i=t[o])[0],i[1]);a.lineEnd()}}else r>1&&2&n&&e.push(e.pop().concat(e.shift())),s.push(e.filter(er))}return l}}function er(t){return t.length>1}function rr(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,e){t.push([n,e])},lineEnd:R,buffer:function(){var e=n;return n=[],t=null,e},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function ir(t,n){return((t=t.x)[0]<0?t[1]-It-Lt:It-t[1])-((n=n.x)[0]<0?n[1]-It-Lt:It-n[1])}var or=nr($e,(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var s=o>0?Ct:-Ct,u=_(o-e);_(u-Ct)<Lt?(t.point(e,r=(r+a)/2>0?It:-It),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),n=0):i!==s&&u>=Ct&&(_(e-i)<Lt&&(e-=i*Lt),_(o-s)<Lt&&(o-=s*Lt),r=function(t,n,e,r){var i,o,a=Math.sin(t-e);return _(a)>Lt?Math.atan((Math.sin(n)*(o=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(n))*Math.sin(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),n=0),t.point(e=o,r=a),i=s},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*It,r.point(-Ct,i),r.point(0,i),r.point(Ct,i),r.point(Ct,0),r.point(Ct,-i),r.point(0,-i),r.point(-Ct,-i),r.point(-Ct,0),r.point(-Ct,i);else if(_(t[0]-n[0])>Lt){var o=t[0]<n[0]?Ct:-Ct;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}),[-Ct,-Ct/2]);function ar(t){var n=Math.cos(t),e=n>0,r=_(n)>Lt;return nr(i,(function(t){var n,s,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(h,f){var p,y=[h,f],d=i(h,f),g=e?d?0:a(h,f):d?a(h+(h<0?Ct:-Ct),f):0;if(!n&&(c=u=d)&&t.lineStart(),d!==u&&(p=o(n,y),(Fe(n,p)||Fe(y,p))&&(y[0]+=Lt,y[1]+=Lt,d=i(y[0],y[1]))),d!==u)l=0,d?(t.lineStart(),p=o(y,n),t.point(p[0],p[1])):(p=o(n,y),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(r&&n&&e^d){var v;g&s||!(v=o(y,n,!0))||(l=0,e?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!d||n&&Fe(n,y)||t.point(y[0],y[1]),n=y,u=d,s=g},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return l|(c&&u)<<1}}}),Br(t,6*zt),e?[0,-t]:[-Ct,t-Ct]);function i(t,e){return Math.cos(t)*Math.cos(e)>n}function o(t,e,r){var i=[1,0,0],o=Re(Oe(t),Oe(e)),a=qe(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var c=n*a/u,l=-n*s/u,h=Re(i,o),f=Ge(i,c);je(f,Ge(o,l));var p=h,y=qe(f,p),d=qe(p,p),g=y*y-d*(qe(f,f)-1);if(!(g<0)){var v=Math.sqrt(g),x=Ge(p,(-y-v)/d);if(je(x,f),x=Be(x),!r)return x;var m,b=t[0],w=e[0],M=t[1],S=e[1];w<b&&(m=b,b=w,w=m);var k=w-b,E=_(k-Ct)<Lt;if(!E&&S<M&&(m=M,M=S,S=m),E||k<Lt?E?M+S>0^x[1]<(_(x[0]-b)<Lt?M:S):M<=x[1]&&x[1]<=S:k>Ct^(b<=x[0]&&x[0]<=w)){var A=Ge(p,(-y+v)/d);return je(A,f),[x,Be(A)]}}}function a(n,r){var i=e?t:Ct-t,o=0;return n<-i?o|=1:n>i&&(o|=2),r<-i?o|=4:r>i&&(o|=8),o}}function sr(t,n,e,r){return function(i){var o,a=i.a,s=i.b,u=a.x,c=a.y,l=0,h=1,f=s.x-u,p=s.y-c;if(o=t-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>l&&(l=o)}if(o=e-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<h&&(h=o)}if(o=n-c,p||!(o>0)){if(o/=p,p<0){if(o<l)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>l&&(l=o)}if(o=r-c,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>l&&(l=o)}else if(p>0){if(o<l)return;o<h&&(h=o)}return l>0&&(i.a={x:u+l*f,y:c+l*p}),h<1&&(i.b={x:u+h*f,y:c+h*p}),i}}}}}}function ur(t,n,e,r){return function(u){var c,l,h,f,p,y,d,g,v,x,m,b=u,w=rr(),_=sr(t,n,e,r),M={point:E,lineStart:function(){M.point=A,l&&l.push(h=[]);x=!0,v=!1,d=g=NaN},lineEnd:function(){c&&(A(f,p),y&&v&&w.rejoin(),c.push(w.buffer()));M.point=E,v&&u.lineEnd()},polygonStart:function(){u=w,c=[],l=[],m=!0},polygonEnd:function(){u=b,c=o.merge(c);var n=function(t){for(var n=0,e=l.length,r=t[1],i=0;i<e;++i)for(var o,a=1,s=l[i],u=s.length,c=s[0];a<u;++a)o=s[a],c[1]<=r?o[1]>r&&qt(c,o,t)>0&&++n:o[1]<=r&&qt(c,o,t)<0&&--n,c=o;return 0!==n}([t,r]),e=m&&n,i=c.length;(e||i)&&(u.polygonStart(),e&&(u.lineStart(),S(null,null,1,u),u.lineEnd()),i&&Je(c,a,n,S,u),u.polygonEnd()),c=l=h=null}};function S(o,a,u,c){var l=0,h=0;if(null==o||(l=i(o,u))!==(h=i(a,u))||s(o,a)<0^u>0)do{c.point(0===l||3===l?t:e,l>1?r:n)}while((l=(l+u+4)%4)!==h);else c.point(a[0],a[1])}function k(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function E(t,n){k(t,n)&&u.point(t,n)}function A(t,n){var e=k(t=Math.max(-1e9,Math.min(1e9,t)),n=Math.max(-1e9,Math.min(1e9,n)));if(l&&h.push([t,n]),x)f=t,p=n,y=e,x=!1,e&&(u.lineStart(),u.point(t,n));else if(e&&v)u.point(t,n);else{var r={a:{x:d,y:g},b:{x:t,y:n}};_(r)?(v||(u.lineStart(),u.point(r.a.x,r.a.y)),u.point(r.b.x,r.b.y),e||u.lineEnd(),m=!1):e&&(u.lineStart(),u.point(t,n),m=!1)}d=t,g=n,v=e}return M};function i(r,i){return _(r[0]-t)<Lt?i>0?0:3:_(r[0]-e)<Lt?i>0?2:1:_(r[1]-n)<Lt?i>0?1:0:i>0?3:2}function a(t,n){return s(t.x,n.x)}function s(t,n){var e=i(t,1),r=i(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}}function cr(t){var n=0,e=Ct/3,r=zr(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*Ct/180,e=t[1]*Ct/180):[n/Ct*180,e/Ct*180]},i}function lr(t,n){var e=Math.sin(t),r=(e+Math.sin(n))/2,i=1+e*(2*r-e),o=Math.sqrt(i)/r;function a(t,n){var e=Math.sqrt(i-2*r*Math.sin(n))/r;return[e*Math.sin(t*=r),o-e*Math.cos(t)]}return a.invert=function(t,n){var e=o-n;return[Math.atan2(t,e)/r,jt((i-(t*t+e*e)*r*r)/(2*r))]},a}o.geo.clipExtent=function(){var t,n,e,r,i,o,a={stream:function(t){return i&&(i.valid=!1),(i=o(t)).valid=!0,i},extent:function(s){return arguments.length?(o=ur(t=+s[0][0],n=+s[0][1],e=+s[1][0],r=+s[1][1]),i&&(i.valid=!1,i=null),a):[[t,n],[e,r]]}};return a.extent([[0,0],[960,500]])},(o.geo.conicEqualArea=function(){return cr(lr)}).raw=lr,o.geo.albers=function(){return o.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},o.geo.albersUsa=function(){var t,n,e,r,i=o.geo.albers(),a=o.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=o.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(n,e){t=[n,e]}};function c(i){var o=i[0],a=i[1];return t=null,n(o,a),t||(e(o,a),t)||r(o,a),t}return c.invert=function(t){var n=i.scale(),e=i.translate(),r=(t[0]-e[0])/n,o=(t[1]-e[1])/n;return(o>=.12&&o<.234&&r>=-.425&&r<-.214?a:o>=.166&&o<.234&&r>=-.214&&r<-.115?s:i).invert(t)},c.stream=function(t){var n=i.stream(t),e=a.stream(t),r=s.stream(t);return{point:function(t,i){n.point(t,i),e.point(t,i),r.point(t,i)},sphere:function(){n.sphere(),e.sphere(),r.sphere()},lineStart:function(){n.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){n.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){n.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){n.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},c.precision=function(t){return arguments.length?(i.precision(t),a.precision(t),s.precision(t),c):i.precision()},c.scale=function(t){return arguments.length?(i.scale(t),a.scale(.35*t),s.scale(t),c.translate(i.translate())):i.scale()},c.translate=function(t){if(!arguments.length)return i.translate();var o=i.scale(),l=+t[0],h=+t[1];return n=i.translate(t).clipExtent([[l-.455*o,h-.238*o],[l+.455*o,h+.238*o]]).stream(u).point,e=a.translate([l-.307*o,h+.201*o]).clipExtent([[l-.425*o+Lt,h+.12*o+Lt],[l-.214*o-Lt,h+.234*o-Lt]]).stream(u).point,r=s.translate([l-.205*o,h+.212*o]).clipExtent([[l-.214*o+Lt,h+.166*o+Lt],[l-.115*o-Lt,h+.234*o-Lt]]).stream(u).point,c},c.scale(1070)};var hr,fr,pr,yr,dr,gr,vr={point:R,lineStart:R,lineEnd:R,polygonStart:function(){fr=0,vr.lineStart=xr},polygonEnd:function(){vr.lineStart=vr.lineEnd=vr.point=R,hr+=_(fr/2)}};function xr(){var t,n,e,r;function i(t,n){fr+=r*t-e*n,e=t,r=n}vr.point=function(o,a){vr.point=i,t=e=o,n=r=a},vr.lineEnd=function(){i(t,n)}}var mr={point:function(t,n){t<pr&&(pr=t);t>dr&&(dr=t);n<yr&&(yr=n);n>gr&&(gr=n)},lineStart:R,lineEnd:R,polygonStart:R,polygonEnd:R};function br(){var t=wr(4.5),n=[],e={point:r,lineStart:function(){e.point=i},lineEnd:a,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=a,e.point=r},pointRadius:function(n){return t=wr(n),e},result:function(){if(n.length){var t=n.join("");return n=[],t}}};function r(e,r){n.push("M",e,",",r,t)}function i(t,r){n.push("M",t,",",r),e.point=o}function o(t,e){n.push("L",t,",",e)}function a(){e.point=r}function s(){n.push("Z")}return e}function wr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var _r,Mr={point:Sr,lineStart:kr,lineEnd:Er,polygonStart:function(){Mr.lineStart=Ar},polygonEnd:function(){Mr.point=Sr,Mr.lineStart=kr,Mr.lineEnd=Er}};function Sr(t,n){Se+=t,ke+=n,++Ee}function kr(){var t,n;function e(e,r){var i=e-t,o=r-n,a=Math.sqrt(i*i+o*o);Ae+=a*(t+e)/2,Le+=a*(n+r)/2,Ne+=a,Sr(t=e,n=r)}Mr.point=function(r,i){Mr.point=e,Sr(t=r,n=i)}}function Er(){Mr.point=Sr}function Ar(){var t,n,e,r;function i(t,n){var i=t-e,o=n-r,a=Math.sqrt(i*i+o*o);Ae+=a*(e+t)/2,Le+=a*(r+n)/2,Ne+=a,Ce+=(a=r*t-e*n)*(e+t),Pe+=a*(r+n),Te+=3*a,Sr(e=t,r=n)}Mr.point=function(o,a){Mr.point=i,Sr(t=e=o,n=r=a)},Mr.lineEnd=function(){i(t,n)}}function Lr(t){var n=4.5,e={point:r,lineStart:function(){e.point=i},lineEnd:a,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=a,e.point=r},pointRadius:function(t){return n=t,e},result:R};function r(e,r){t.moveTo(e+n,r),t.arc(e,r,n,0,Pt)}function i(n,r){t.moveTo(n,r),e.point=o}function o(n,e){t.lineTo(n,e)}function a(){e.point=r}function s(){t.closePath()}return e}function Nr(t){var n=.5,e=Math.cos(30*zt),r=16;function i(t){return(r?a:o)(t)}function o(n){return Tr(n,(function(e,r){e=t(e,r),n.point(e[0],e[1])}))}function a(n){var e,i,o,a,u,c,l,h,f,p,y,d,g={point:v,lineStart:x,lineEnd:b,polygonStart:function(){n.polygonStart(),g.lineStart=w},polygonEnd:function(){n.polygonEnd(),g.lineStart=x}};function v(e,r){e=t(e,r),n.point(e[0],e[1])}function x(){h=NaN,g.point=m,n.lineStart()}function m(e,i){var o=Oe([e,i]),a=t(e,i);s(h,f,l,p,y,d,h=a[0],f=a[1],l=e,p=o[0],y=o[1],d=o[2],r,n),n.point(h,f)}function b(){g.point=v,n.lineEnd()}function w(){x(),g.point=_,g.lineEnd=M}function _(t,n){m(e=t,n),i=h,o=f,a=p,u=y,c=d,g.point=m}function M(){s(h,f,l,p,y,d,i,o,e,a,u,c,r,n),g.lineEnd=b,b()}return g}function s(r,i,o,a,u,c,l,h,f,p,y,d,g,v){var x=l-r,m=h-i,b=x*x+m*m;if(b>4*n&&g--){var w=a+p,M=u+y,S=c+d,k=Math.sqrt(w*w+M*M+S*S),E=Math.asin(S/=k),A=_(_(S)-1)<Lt||_(o-f)<Lt?(o+f)/2:Math.atan2(M,w),L=t(A,E),N=L[0],C=L[1],P=N-r,T=C-i,I=m*P-x*T;(I*I/b>n||_((x*P+m*T)/b-.5)>.3||a*p+u*y+c*d<e)&&(s(r,i,o,a,u,c,N,C,A,w/=k,M/=k,S,g,v),v.point(N,C),s(N,C,A,w,M,S,l,h,f,p,y,d,g,v))}}return i.precision=function(t){return arguments.length?(r=(n=t*t)>0&&16,i):Math.sqrt(n)},i}function Cr(t){var n=Nr((function(n,e){return t([n*Dt,e*Dt])}));return function(t){return Dr(n(t))}}function Pr(t){this.stream=t}function Tr(t,n){return{point:n,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Ir(t){return zr((function(){return t}))()}function zr(t){var n,e,r,i,a,s,u=Nr((function(t,e){return[(t=n(t,e))[0]*c+i,a-t[1]*c]})),c=150,l=480,h=250,f=0,p=0,y=0,d=0,g=0,v=or,x=z,m=null,b=null;function w(t){return[(t=r(t[0]*zt,t[1]*zt))[0]*c+i,a-t[1]*c]}function _(t){return(t=r.invert((t[0]-i)/c,(a-t[1])/c))&&[t[0]*Dt,t[1]*Dt]}function M(){r=We(e=Rr(y,d,g),n);var t=n(f,p);return i=l-t[0]*c,a=h+t[1]*c,S()}function S(){return s&&(s.valid=!1,s=null),w}return w.stream=function(t){return s&&(s.valid=!1),(s=Dr(v(e,u(x(t))))).valid=!0,s},w.clipAngle=function(t){return arguments.length?(v=null==t?(m=t,or):ar((m=+t)*zt),S()):m},w.clipExtent=function(t){return arguments.length?(b=t,x=t?ur(t[0][0],t[0][1],t[1][0],t[1][1]):z,S()):b},w.scale=function(t){return arguments.length?(c=+t,M()):c},w.translate=function(t){return arguments.length?(l=+t[0],h=+t[1],M()):[l,h]},w.center=function(t){return arguments.length?(f=t[0]%360*zt,p=t[1]%360*zt,M()):[f*Dt,p*Dt]},w.rotate=function(t){return arguments.length?(y=t[0]%360*zt,d=t[1]%360*zt,g=t.length>2?t[2]%360*zt:0,M()):[y*Dt,d*Dt,g*Dt]},o.rebind(w,u,"precision"),function(){return n=t.apply(this,arguments),w.invert=n.invert&&_,M()}}function Dr(t){return Tr(t,(function(n,e){t.point(n*zt,e*zt)}))}function Or(t,n){return[t,n]}function qr(t,n){return[t>Ct?t-Pt:t<-Ct?t+Pt:t,n]}function Rr(t,n,e){return t?n||e?We(Gr(t),Vr(n,e)):Gr(t):n||e?Vr(n,e):qr}function jr(t){return function(n,e){return[(n+=t)>Ct?n-Pt:n<-Ct?n+Pt:n,e]}}function Gr(t){var n=jr(t);return n.invert=jr(-t),n}function Vr(t,n){var e=Math.cos(t),r=Math.sin(t),i=Math.cos(n),o=Math.sin(n);function a(t,n){var a=Math.cos(n),s=Math.cos(t)*a,u=Math.sin(t)*a,c=Math.sin(n),l=c*e+s*r;return[Math.atan2(u*i-l*o,s*e-c*r),jt(l*i+u*o)]}return a.invert=function(t,n){var a=Math.cos(n),s=Math.cos(t)*a,u=Math.sin(t)*a,c=Math.sin(n),l=c*i-u*o;return[Math.atan2(u*i+c*o,s*e+l*r),jt(l*e-s*r)]},a}function Br(t,n){var e=Math.cos(t),r=Math.sin(t);return function(i,o,a,s){var u=a*n;null!=i?(i=Fr(e,i),o=Fr(e,o),(a>0?i<o:i>o)&&(i+=a*Pt)):(i=t+a*Pt,o=t-.5*u);for(var c,l=i;a>0?l>o:l<o;l-=u)s.point((c=Be([e,-r*Math.cos(l),-r*Math.sin(l)]))[0],c[1])}}function Fr(t,n){var e=Oe(n);e[0]-=t,Ve(e);var r=Rt(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Lt)%(2*Math.PI)}function Hr(t,n,e){var r=o.range(t,n-Lt,e).concat(n);return function(t){return r.map((function(n){return[t,n]}))}}function Ur(t,n,e){var r=o.range(t,n-Lt,e).concat(n);return function(t){return r.map((function(n){return[n,t]}))}}function Xr(t){return t.source}function Zr(t){return t.target}o.geo.path=function(){var t,n,e,r,i,a=4.5;function s(t){return t&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),i&&i.valid||(i=e(r)),o.geo.stream(t,i)),r.result()}function u(){return i=null,s}return s.area=function(t){return hr=0,o.geo.stream(t,e(vr)),hr},s.centroid=function(t){return Se=ke=Ee=Ae=Le=Ne=Ce=Pe=Te=0,o.geo.stream(t,e(Mr)),Te?[Ce/Te,Pe/Te]:Ne?[Ae/Ne,Le/Ne]:Ee?[Se/Ee,ke/Ee]:[NaN,NaN]},s.bounds=function(t){return dr=gr=-(pr=yr=1/0),o.geo.stream(t,e(mr)),[[pr,yr],[dr,gr]]},s.projection=function(n){return arguments.length?(e=(t=n)?n.stream||Cr(n):z,u()):t},s.context=function(t){return arguments.length?(r=null==(n=t)?new br:new Lr(t),"function"!=typeof a&&r.pointRadius(a),u()):n},s.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),s):a},s.projection(o.geo.albersUsa()).context(null)},o.geo.transform=function(t){return{stream:function(n){var e=new Pr(n);for(var r in t)e[r]=t[r];return e}}},Pr.prototype={point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},o.geo.projection=Ir,o.geo.projectionMutator=zr,(o.geo.equirectangular=function(){return Ir(Or)}).raw=Or.invert=Or,o.geo.rotation=function(t){function n(n){return(n=t(n[0]*zt,n[1]*zt))[0]*=Dt,n[1]*=Dt,n}return t=Rr(t[0]%360*zt,t[1]*zt,t.length>2?t[2]*zt:0),n.invert=function(n){return(n=t.invert(n[0]*zt,n[1]*zt))[0]*=Dt,n[1]*=Dt,n},n},qr.invert=Or,o.geo.circle=function(){var t,n,e=[0,0],r=6;function i(){var t="function"==typeof e?e.apply(this,arguments):e,r=Rr(-t[0]*zt,-t[1]*zt,0).invert,i=[];return n(null,null,1,{point:function(t,n){i.push(t=r(t,n)),t[0]*=Dt,t[1]*=Dt}}),{type:"Polygon",coordinates:[i]}}return i.origin=function(t){return arguments.length?(e=t,i):e},i.angle=function(e){return arguments.length?(n=Br((t=+e)*zt,r*zt),i):t},i.precision=function(e){return arguments.length?(n=Br(t*zt,(r=+e)*zt),i):r},i.angle(90)},o.geo.distance=function(t,n){var e,r=(n[0]-t[0])*zt,i=t[1]*zt,o=n[1]*zt,a=Math.sin(r),s=Math.cos(r),u=Math.sin(i),c=Math.cos(i),l=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((e=h*a)*e+(e=c*l-u*h*s)*e),u*l+c*h*s)},o.geo.graticule=function(){var t,n,e,r,i,a,s,u,c,l,h,f,p=10,y=p,d=90,g=360,v=2.5;function x(){return{type:"MultiLineString",coordinates:m()}}function m(){return o.range(Math.ceil(r/d)*d,e,d).map(h).concat(o.range(Math.ceil(u/g)*g,s,g).map(f)).concat(o.range(Math.ceil(n/p)*p,t,p).filter((function(t){return _(t%d)>Lt})).map(c)).concat(o.range(Math.ceil(a/y)*y,i,y).filter((function(t){return _(t%g)>Lt})).map(l))}return x.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},x.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(f(s).slice(1),h(e).reverse().slice(1),f(u).reverse().slice(1))]}},x.extent=function(t){return arguments.length?x.majorExtent(t).minorExtent(t):x.minorExtent()},x.majorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],s=+t[1][1],r>e&&(t=r,r=e,e=t),u>s&&(t=u,u=s,s=t),x.precision(v)):[[r,u],[e,s]]},x.minorExtent=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],a=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),a>i&&(e=a,a=i,i=e),x.precision(v)):[[n,a],[t,i]]},x.step=function(t){return arguments.length?x.majorStep(t).minorStep(t):x.minorStep()},x.majorStep=function(t){return arguments.length?(d=+t[0],g=+t[1],x):[d,g]},x.minorStep=function(t){return arguments.length?(p=+t[0],y=+t[1],x):[p,y]},x.precision=function(o){return arguments.length?(v=+o,c=Hr(a,i,90),l=Ur(n,t,v),h=Hr(u,s,90),f=Ur(r,e,v),x):v},x.majorExtent([[-180,-90+Lt],[180,90-Lt]]).minorExtent([[-180,-80-Lt],[180,80+Lt]])},o.geo.greatArc=function(){var t,n,e=Xr,r=Zr;function i(){return{type:"LineString",coordinates:[t||e.apply(this,arguments),n||r.apply(this,arguments)]}}return i.distance=function(){return o.geo.distance(t||e.apply(this,arguments),n||r.apply(this,arguments))},i.source=function(n){return arguments.length?(e=n,t="function"==typeof n?null:n,i):e},i.target=function(t){return arguments.length?(r=t,n="function"==typeof t?null:t,i):r},i.precision=function(){return arguments.length?i:0},i},o.geo.interpolate=function(t,n){return e=t[0]*zt,r=t[1]*zt,i=n[0]*zt,o=n[1]*zt,a=Math.cos(r),s=Math.sin(r),u=Math.cos(o),c=Math.sin(o),l=a*Math.cos(e),h=a*Math.sin(e),f=u*Math.cos(i),p=u*Math.sin(i),y=2*Math.asin(Math.sqrt(Vt(o-r)+a*u*Vt(i-e))),d=1/Math.sin(y),(g=y?function(t){var n=Math.sin(t*=y)*d,e=Math.sin(y-t)*d,r=e*l+n*f,i=e*h+n*p,o=e*s+n*c;return[Math.atan2(i,r)*Dt,Math.atan2(o,Math.sqrt(r*r+i*i))*Dt]}:function(){return[e*Dt,r*Dt]}).distance=y,g;var e,r,i,o,a,s,u,c,l,h,f,p,y,d,g},o.geo.length=function(t){return _r=0,o.geo.stream(t,Yr),_r};var Yr={sphere:R,point:R,lineStart:function(){var t,n,e;function r(r,i){var o=Math.sin(i*=zt),a=Math.cos(i),s=_((r*=zt)-t),u=Math.cos(s);_r+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=e*o-n*a*u)*s),n*o+e*a*u),t=r,n=o,e=a}Yr.point=function(i,o){t=i*zt,n=Math.sin(o*=zt),e=Math.cos(o),Yr.point=r},Yr.lineEnd=function(){Yr.point=Yr.lineEnd=R}},lineEnd:R,polygonStart:R,polygonEnd:R};function Kr(t,n){function e(n,e){var r=Math.cos(n),i=Math.cos(e),o=t(r*i);return[o*i*Math.sin(n),o*Math.sin(e)]}return e.invert=function(t,e){var r=Math.sqrt(t*t+e*e),i=n(r),o=Math.sin(i),a=Math.cos(i);return[Math.atan2(t*o,r*a),Math.asin(r&&e*o/r)]},e}var Wr=Kr((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(o.geo.azimuthalEqualArea=function(){return Ir(Wr)}).raw=Wr;var $r=Kr((function(t){var n=Math.acos(t);return n&&n/Math.sin(n)}),z);function Jr(t,n){var e=Math.cos(t),r=function(t){return Math.tan(Ct/4+t/2)},i=t===n?Math.sin(t):Math.log(e/Math.cos(n))/Math.log(r(n)/r(t)),o=e*Math.pow(r(t),i)/i;if(!i)return ni;function a(t,n){o>0?n<-It+Lt&&(n=-It+Lt):n>It-Lt&&(n=It-Lt);var e=o/Math.pow(r(n),i);return[e*Math.sin(i*t),o-e*Math.cos(i*t)]}return a.invert=function(t,n){var e=o-n,r=Ot(i)*Math.sqrt(t*t+e*e);return[Math.atan2(t,e)/i,2*Math.atan(Math.pow(o/r,1/i))-It]},a}function Qr(t,n){var e=Math.cos(t),r=t===n?Math.sin(t):(e-Math.cos(n))/(n-t),i=e/r+t;if(_(r)<Lt)return Or;function o(t,n){var e=i-n;return[e*Math.sin(r*t),i-e*Math.cos(r*t)]}return o.invert=function(t,n){var e=i-n;return[Math.atan2(t,e)/r,i-Ot(r)*Math.sqrt(t*t+e*e)]},o}(o.geo.azimuthalEquidistant=function(){return Ir($r)}).raw=$r,(o.geo.conicConformal=function(){return cr(Jr)}).raw=Jr,(o.geo.conicEquidistant=function(){return cr(Qr)}).raw=Qr;var ti=Kr((function(t){return 1/t}),Math.atan);function ni(t,n){return[t,Math.log(Math.tan(Ct/4+n/2))]}function ei(t){var n,e=Ir(t),r=e.scale,i=e.translate,o=e.clipExtent;return e.scale=function(){var t=r.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.translate=function(){var t=i.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.clipExtent=function(t){var a=o.apply(e,arguments);if(a===e){if(n=null==t){var s=Ct*r(),u=i();o([[u[0]-s,u[1]-s],[u[0]+s,u[1]+s]])}}else n&&(a=null);return a},e.clipExtent(null)}(o.geo.gnomonic=function(){return Ir(ti)}).raw=ti,ni.invert=function(t,n){return[t,2*Math.atan(Math.exp(n))-It]},(o.geo.mercator=function(){return ei(ni)}).raw=ni;var ri=Kr((function(){return 1}),Math.asin);(o.geo.orthographic=function(){return Ir(ri)}).raw=ri;var ii=Kr((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function oi(t,n){return[Math.log(Math.tan(Ct/4+n/2)),-t]}function ai(t){return t[0]}function si(t){return t[1]}function ui(t){for(var n=t.length,e=[0,1],r=2,i=2;i<n;i++){for(;r>1&&qt(t[e[r-2]],t[e[r-1]],t[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function ci(t,n){return t[0]-n[0]||t[1]-n[1]}(o.geo.stereographic=function(){return Ir(ii)}).raw=ii,oi.invert=function(t,n){return[-n,2*Math.atan(Math.exp(t))-It]},(o.geo.transverseMercator=function(){var t=ei(oi),n=t.center,e=t.rotate;return t.center=function(t){return t?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return t?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90])}).raw=oi,o.geom={},o.geom.hull=function(t){var n=ai,e=si;if(arguments.length)return r(t);function r(t){if(t.length<3)return[];var r,i=mn(n),o=mn(e),a=t.length,s=[],u=[];for(r=0;r<a;r++)s.push([+i.call(this,t[r],r),+o.call(this,t[r],r),r]);for(s.sort(ci),r=0;r<a;r++)u.push([s[r][0],-s[r][1]]);var c=ui(s),l=ui(u),h=l[0]===c[0],f=l[l.length-1]===c[c.length-1],p=[];for(r=c.length-1;r>=0;--r)p.push(t[s[c[r]][2]]);for(r=+h;r<l.length-f;++r)p.push(t[s[l[r]][2]]);return p}return r.x=function(t){return arguments.length?(n=t,r):n},r.y=function(t){return arguments.length?(e=t,r):e},r},o.geom.polygon=function(t){return U(t,li),t};var li=o.geom.polygon.prototype=[];function hi(t,n,e){return(e[0]-n[0])*(t[1]-n[1])<(e[1]-n[1])*(t[0]-n[0])}function fi(t,n,e,r){var i=t[0],o=e[0],a=n[0]-i,s=r[0]-o,u=t[1],c=e[1],l=n[1]-u,h=r[1]-c,f=(s*(u-c)-h*(i-o))/(h*a-s*l);return[i+f*a,u+f*l]}function pi(t){var n=t[0],e=t[t.length-1];return!(n[0]-e[0]||n[1]-e[1])}li.area=function(){for(var t,n=-1,e=this.length,r=this[e-1],i=0;++n<e;)t=r,r=this[n],i+=t[1]*r[0]-t[0]*r[1];return.5*i},li.centroid=function(t){var n,e,r=-1,i=this.length,o=0,a=0,s=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)n=s,s=this[r],e=n[0]*s[1]-s[0]*n[1],o+=(n[0]+s[0])*e,a+=(n[1]+s[1])*e;return[o*t,a*t]},li.clip=function(t){for(var n,e,r,i,o,a,s=pi(t),u=-1,c=this.length-pi(this),l=this[c-1];++u<c;){for(n=t.slice(),t.length=0,i=this[u],o=n[(r=n.length-s)-1],e=-1;++e<r;)hi(a=n[e],l,i)?(hi(o,l,i)||t.push(fi(o,a,l,i)),t.push(a)):hi(o,l,i)&&t.push(fi(o,a,l,i)),o=a;s&&t.push(t[0]),l=i}return t};var yi,di,gi,vi,xi,mi=[],bi=[];function wi(){Gi(this),this.edge=this.site=this.circle=null}function _i(t){var n=mi.pop()||new wi;return n.site=t,n}function Mi(t){Ti(t),gi.remove(t),mi.push(t),Gi(t)}function Si(t){var n=t.circle,e=n.x,r=n.cy,i={x:e,y:r},o=t.P,a=t.N,s=[t];Mi(t);for(var u=o;u.circle&&_(e-u.circle.x)<Lt&&_(r-u.circle.cy)<Lt;)o=u.P,s.unshift(u),Mi(u),u=o;s.unshift(u),Ti(u);for(var c=a;c.circle&&_(e-c.circle.x)<Lt&&_(r-c.circle.cy)<Lt;)a=c.N,s.push(c),Mi(c),c=a;s.push(c),Ti(c);var l,h=s.length;for(l=1;l<h;++l)c=s[l],u=s[l-1],qi(c.edge,u.site,c.site,i);u=s[0],(c=s[h-1]).edge=Di(u.site,c.site,null,i),Pi(u),Pi(c)}function ki(t){for(var n,e,r,i,o=t.x,a=t.y,s=gi._;s;)if((r=Ei(s,a)-o)>Lt)s=s.L;else{if(!((i=o-Ai(s,a))>Lt)){r>-Lt?(n=s.P,e=s):i>-Lt?(n=s,e=s.N):n=e=s;break}if(!s.R){n=s;break}s=s.R}var u=_i(t);if(gi.insert(n,u),n||e){if(n===e)return Ti(n),e=_i(n.site),gi.insert(u,e),u.edge=e.edge=Di(n.site,u.site),Pi(n),void Pi(e);if(e){Ti(n),Ti(e);var c=n.site,l=c.x,h=c.y,f=t.x-l,p=t.y-h,y=e.site,d=y.x-l,g=y.y-h,v=2*(f*g-p*d),x=f*f+p*p,m=d*d+g*g,b={x:(g*x-p*m)/v+l,y:(f*m-d*x)/v+h};qi(e.edge,c,y,b),u.edge=Di(c,t,null,b),e.edge=Di(t,y,null,b),Pi(n),Pi(e)}else u.edge=Di(n.site,u.site)}}function Ei(t,n){var e=t.site,r=e.x,i=e.y,o=i-n;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(e=a.site).x,u=e.y,c=u-n;if(!c)return s;var l=s-r,h=1/o-1/c,f=l/c;return h?(-f+Math.sqrt(f*f-2*h*(l*l/(-2*c)-u+c/2+i-o/2)))/h+r:(r+s)/2}function Ai(t,n){var e=t.N;if(e)return Ei(e,n);var r=t.site;return r.y===n?r.x:1/0}function Li(t){this.site=t,this.edges=[]}function Ni(t,n){return n.angle-t.angle}function Ci(){Gi(this),this.x=this.y=this.arc=this.site=this.cy=null}function Pi(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,o=e.site;if(r!==o){var a=i.x,s=i.y,u=r.x-a,c=r.y-s,l=o.x-a,h=2*(u*(g=o.y-s)-c*l);if(!(h>=-Nt)){var f=u*u+c*c,p=l*l+g*g,y=(g*f-c*p)/h,d=(u*p-l*f)/h,g=d+s,v=bi.pop()||new Ci;v.arc=t,v.site=i,v.x=y+a,v.y=g+Math.sqrt(y*y+d*d),v.cy=g,t.circle=v;for(var x=null,m=xi._;m;)if(v.y<m.y||v.y===m.y&&v.x<=m.x){if(!m.L){x=m.P;break}m=m.L}else{if(!m.R){x=m;break}m=m.R}xi.insert(x,v),x||(vi=v)}}}}function Ti(t){var n=t.circle;n&&(n.P||(vi=n.N),xi.remove(n),bi.push(n),Gi(n),t.circle=null)}function Ii(t,n){var e=t.b;if(e)return!0;var r,i,o=t.a,a=n[0][0],s=n[1][0],u=n[0][1],c=n[1][1],l=t.l,h=t.r,f=l.x,p=l.y,y=h.x,d=h.y,g=(f+y)/2,v=(p+d)/2;if(d===p){if(g<a||g>=s)return;if(f>y){if(o){if(o.y>=c)return}else o={x:g,y:u};e={x:g,y:c}}else{if(o){if(o.y<u)return}else o={x:g,y:c};e={x:g,y:u}}}else if(i=v-(r=(f-y)/(d-p))*g,r<-1||r>1)if(f>y){if(o){if(o.y>=c)return}else o={x:(u-i)/r,y:u};e={x:(c-i)/r,y:c}}else{if(o){if(o.y<u)return}else o={x:(c-i)/r,y:c};e={x:(u-i)/r,y:u}}else if(p<d){if(o){if(o.x>=s)return}else o={x:a,y:r*a+i};e={x:s,y:r*s+i}}else{if(o){if(o.x<a)return}else o={x:s,y:r*s+i};e={x:a,y:r*a+i}}return t.a=o,t.b=e,!0}function zi(t,n){this.l=t,this.r=n,this.a=this.b=null}function Di(t,n,e,r){var i=new zi(t,n);return yi.push(i),e&&qi(i,t,n,e),r&&qi(i,n,t,r),di[t.i].edges.push(new Ri(i,t,n)),di[n.i].edges.push(new Ri(i,n,t)),i}function Oi(t,n,e){var r=new zi(t,null);return r.a=n,r.b=e,yi.push(r),r}function qi(t,n,e,r){t.a||t.b?t.l===e?t.b=r:t.a=r:(t.a=r,t.l=n,t.r=e)}function Ri(t,n,e){var r=t.a,i=t.b;this.edge=t,this.site=n,this.angle=e?Math.atan2(e.y-n.y,e.x-n.x):t.l===n?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function ji(){this._=null}function Gi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Vi(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Bi(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function Fi(t){for(;t.L;)t=t.L;return t}function Hi(t,n){var e,r,i,o=t.sort(Ui).pop();for(yi=[],di=new Array(t.length),gi=new ji,xi=new ji;;)if(i=vi,o&&(!i||o.y<i.y||o.y===i.y&&o.x<i.x))o.x===e&&o.y===r||(di[o.i]=new Li(o),ki(o),e=o.x,r=o.y),o=t.pop();else{if(!i)break;Si(i.arc)}n&&(function(t){for(var n,e=yi,r=sr(t[0][0],t[0][1],t[1][0],t[1][1]),i=e.length;i--;)(!Ii(n=e[i],t)||!r(n)||_(n.a.x-n.b.x)<Lt&&_(n.a.y-n.b.y)<Lt)&&(n.a=n.b=null,e.splice(i,1))}(n),function(t){for(var n,e,r,i,o,a,s,u,c,l,h=t[0][0],f=t[1][0],p=t[0][1],y=t[1][1],d=di,g=d.length;g--;)if((o=d[g])&&o.prepare())for(u=(s=o.edges).length,a=0;a<u;)r=(l=s[a].end()).x,i=l.y,n=(c=s[++a%u].start()).x,e=c.y,(_(r-n)>Lt||_(i-e)>Lt)&&(s.splice(a,0,new Ri(Oi(o.site,l,_(r-h)<Lt&&y-i>Lt?{x:h,y:_(n-h)<Lt?e:y}:_(i-y)<Lt&&f-r>Lt?{x:_(e-y)<Lt?n:f,y:y}:_(r-f)<Lt&&i-p>Lt?{x:f,y:_(n-f)<Lt?e:p}:_(i-p)<Lt&&r-h>Lt?{x:_(e-p)<Lt?n:h,y:p}:null),o.site,null)),++u)}(n));var a={cells:di,edges:yi};return gi=xi=yi=di=null,a}function Ui(t,n){return n.y-t.y||n.x-t.x}Li.prototype.prepare=function(){for(var t,n=this.edges,e=n.length;e--;)(t=n[e].edge).b&&t.a||n.splice(e,1);return n.sort(Ni),n.length},Ri.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ji.prototype={insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=Fi(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(Vi(this,e),e=(t=e).U),e.C=!1,r.C=!0,Bi(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(Bi(this,e),e=(t=e).U),e.C=!1,r.C=!0,Vi(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,o=t.L,a=t.R;if(e=o?a?Fi(a):o:a,i?i.L===t?i.L=e:i.R=e:this._=e,o&&a?(r=e.C,e.C=t.C,e.L=o,o.U=e,e!==a?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=a,a.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,Vi(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,Bi(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,Vi(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,Bi(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,Vi(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,Bi(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}},o.geom.voronoi=function(t){var n=ai,e=si,r=n,i=e,o=Xi;if(t)return a(t);function a(t){var n=new Array(t.length),e=o[0][0],r=o[0][1],i=o[1][0],a=o[1][1];return Hi(s(t),o).cells.forEach((function(o,s){var u=o.edges,c=o.site;(n[s]=u.length?u.map((function(t){var n=t.start();return[n.x,n.y]})):c.x>=e&&c.x<=i&&c.y>=r&&c.y<=a?[[e,a],[i,a],[i,r],[e,r]]:[]).point=t[s]})),n}function s(t){return t.map((function(t,n){return{x:Math.round(r(t,n)/Lt)*Lt,y:Math.round(i(t,n)/Lt)*Lt,i:n}}))}return a.links=function(t){return Hi(s(t)).edges.filter((function(t){return t.l&&t.r})).map((function(n){return{source:t[n.l.i],target:t[n.r.i]}}))},a.triangles=function(t){var n=[];return Hi(s(t)).cells.forEach((function(e,r){for(var i,o,a,s,u=e.site,c=e.edges.sort(Ni),l=-1,h=c.length,f=c[h-1].edge,p=f.l===u?f.r:f.l;++l<h;)f,i=p,p=(f=c[l].edge).l===u?f.r:f.l,r<i.i&&r<p.i&&(a=i,s=p,((o=u).x-s.x)*(a.y-o.y)-(o.x-a.x)*(s.y-o.y)<0)&&n.push([t[r],t[i.i],t[p.i]])})),n},a.x=function(t){return arguments.length?(r=mn(n=t),a):n},a.y=function(t){return arguments.length?(i=mn(e=t),a):e},a.clipExtent=function(t){return arguments.length?(o=null==t?Xi:t,a):o===Xi?null:o},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):o===Xi?null:o&&o[1]},a};var Xi=[[-1e6,-1e6],[1e6,1e6]];function Zi(t){return t.x}function Yi(t){return t.y}function Ki(t,n,e,r,i,o){if(!t(n,e,r,i,o)){var a=.5*(e+i),s=.5*(r+o),u=n.nodes;u[0]&&Ki(t,u[0],e,r,a,s),u[1]&&Ki(t,u[1],a,r,i,s),u[2]&&Ki(t,u[2],e,s,a,o),u[3]&&Ki(t,u[3],a,s,i,o)}}function Wi(t,n,e,r,i,o,a){var s,u=1/0;return function t(c,l,h,f,p){if(!(l>o||h>a||f<r||p<i)){if(y=c.point){var y,d=n-c.x,g=e-c.y,v=d*d+g*g;if(v<u){var x=Math.sqrt(u=v);r=n-x,i=e-x,o=n+x,a=e+x,s=y}}for(var m=c.nodes,b=.5*(l+f),w=.5*(h+p),_=(e>=w)<<1|n>=b,M=_+4;_<M;++_)if(c=m[3&_])switch(3&_){case 0:t(c,l,h,b,w);break;case 1:t(c,b,h,f,w);break;case 2:t(c,l,w,b,p);break;case 3:t(c,b,w,f,p)}}}(t,r,i,o,a),s}function $i(t,n){t=o.rgb(t),n=o.rgb(n);var e=t.r,r=t.g,i=t.b,a=n.r-e,s=n.g-r,u=n.b-i;return function(t){return"#"+fn(Math.round(e+a*t))+fn(Math.round(r+s*t))+fn(Math.round(i+u*t))}}function Ji(t,n){var e,r={},i={};for(e in t)e in n?r[e]=ro(t[e],n[e]):i[e]=t[e];for(e in n)e in t||(i[e]=n[e]);return function(t){for(e in r)i[e]=r[e](t);return i}}function Qi(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function to(t,n){var e,r,i,o=no.lastIndex=eo.lastIndex=0,a=-1,s=[],u=[];for(t+="",n+="";(e=no.exec(t))&&(r=eo.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(e=e[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Qi(e,r)})),o=eo.lastIndex;return o<n.length&&(i=n.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?(n=u[0].x,function(t){return n(t)+""}):function(){return n}:(n=u.length,function(t){for(var e,r=0;r<n;++r)s[(e=u[r]).i]=e.x(t);return s.join("")})}o.geom.delaunay=function(t){return o.geom.voronoi().triangles(t)},o.geom.quadtree=function(t,n,e,r,i){var o,a=ai,s=si;if(o=arguments.length)return a=Zi,s=Yi,3===o&&(i=e,r=n,e=n=0),u(t);function u(t){var u,c,l,h,f,p,y,d,g,v=mn(a),x=mn(s);if(null!=n)p=n,y=e,d=r,g=i;else if(d=g=-(p=y=1/0),c=[],l=[],f=t.length,o)for(h=0;h<f;++h)(u=t[h]).x<p&&(p=u.x),u.y<y&&(y=u.y),u.x>d&&(d=u.x),u.y>g&&(g=u.y),c.push(u.x),l.push(u.y);else for(h=0;h<f;++h){var m=+v(u=t[h],h),b=+x(u,h);m<p&&(p=m),b<y&&(y=b),m>d&&(d=m),b>g&&(g=b),c.push(m),l.push(b)}var w=d-p,M=g-y;function S(t,n,e,r,i,o,a,s){if(!isNaN(e)&&!isNaN(r))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(_(u-e)+_(c-r)<.01)k(t,n,e,r,i,o,a,s);else{var l=t.point;t.x=t.y=t.point=null,k(t,l,u,c,i,o,a,s),k(t,n,e,r,i,o,a,s)}else t.x=e,t.y=r,t.point=n}else k(t,n,e,r,i,o,a,s)}function k(t,n,e,r,i,o,a,s){var u=.5*(i+a),c=.5*(o+s),l=e>=u,h=r>=c,f=h<<1|l;t.leaf=!1,l?i=u:a=u,h?o=c:s=c,S(t=t.nodes[f]||(t.nodes[f]={leaf:!0,nodes:[],point:null,x:null,y:null}),n,e,r,i,o,a,s)}w>M?g=y+w:d=p+M;var E={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){S(E,t,+v(t,++h),+x(t,h),p,y,d,g)},visit:function(t){Ki(t,E,p,y,d,g)},find:function(t){return Wi(E,t[0],t[1],p,y,d,g)}};if(h=-1,null==n){for(;++h<f;)S(E,t[h],c[h],l[h],p,y,d,g);--h}else t.forEach(E.add);return c=l=t=u=null,E}return u.x=function(t){return arguments.length?(a=t,u):a},u.y=function(t){return arguments.length?(s=t,u):s},u.extent=function(t){return arguments.length?(null==t?n=e=r=i=null:(n=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),u):null==n?null:[[n,e],[r,i]]},u.size=function(t){return arguments.length?(null==t?n=e=r=i=null:(n=e=0,r=+t[0],i=+t[1]),u):null==n?null:[r-n,i-e]},u},o.interpolateRgb=$i,o.interpolateObject=Ji,o.interpolateNumber=Qi,o.interpolateString=to;var no=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eo=new RegExp(no.source,"g");function ro(t,n){for(var e,r=o.interpolators.length;--r>=0&&!(e=o.interpolators[r](t,n)););return e}function io(t,n){var e,r=[],i=[],o=t.length,a=n.length,s=Math.min(t.length,n.length);for(e=0;e<s;++e)r.push(ro(t[e],n[e]));for(;e<o;++e)i[e]=t[e];for(;e<a;++e)i[e]=n[e];return function(t){for(e=0;e<s;++e)i[e]=r[e](t);return i}}o.interpolate=ro,o.interpolators=[function(t,n){var e=typeof n;return("string"===e?xn.has(n.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(n)?$i:to:n instanceof Xt?$i:Array.isArray(n)?io:"object"===e&&isNaN(n)?Ji:Qi)(t,n)}],o.interpolateArray=io;var oo=function(){return z},ao=o.map({linear:oo,poly:function(t){return function(n){return Math.pow(n,t)}},quad:function(){return ho},cubic:function(){return fo},sin:function(){return yo},exp:function(){return go},circle:function(){return vo},elastic:function(t,n){var e;arguments.length<2&&(n=.45);arguments.length?e=n/Pt*Math.asin(1/t):(t=1,e=n/4);return function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-e)*Pt/n)}},back:function(t){t||(t=1.70158);return function(n){return n*n*((t+1)*n-t)}},bounce:function(){return xo}}),so=o.map({in:z,out:co,"in-out":lo,"out-in":function(t){return lo(co(t))}});function uo(t){return function(n){return n<=0?0:n>=1?1:t(n)}}function co(t){return function(n){return 1-t(1-n)}}function lo(t){return function(n){return.5*(n<.5?t(2*n):2-t(2-2*n))}}function ho(t){return t*t}function fo(t){return t*t*t}function po(t){if(t<=0)return 0;if(t>=1)return 1;var n=t*t,e=n*t;return 4*(t<.5?e:3*(t-n)+e-.75)}function yo(t){return 1-Math.cos(t*It)}function go(t){return Math.pow(2,10*(t-1))}function vo(t){return 1-Math.sqrt(1-t*t)}function xo(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function mo(t,n){return n-=t,function(e){return Math.round(t+n*e)}}function bo(t){var n,e,r,i=[t.a,t.b],o=[t.c,t.d],a=_o(i),s=wo(i,o),u=_o(((n=o)[0]+=(r=-s)*(e=i)[0],n[1]+=r*e[1],n))||0;i[0]*o[1]<o[0]*i[1]&&(i[0]*=-1,i[1]*=-1,a*=-1,s*=-1),this.rotate=(a?Math.atan2(i[1],i[0]):Math.atan2(-o[0],o[1]))*Dt,this.translate=[t.e,t.f],this.scale=[a,u],this.skew=u?Math.atan2(s,u)*Dt:0}function wo(t,n){return t[0]*n[0]+t[1]*n[1]}function _o(t){var n=Math.sqrt(wo(t,t));return n&&(t[0]/=n,t[1]/=n),n}o.ease=function(t){var n=t.indexOf("-"),e=n>=0?t.slice(0,n):t,r=n>=0?t.slice(n+1):"in";return e=ao.get(e)||oo,uo((r=so.get(r)||z)(e.apply(null,a.call(arguments,1))))},o.interpolateHcl=function(t,n){t=o.hcl(t),n=o.hcl(n);var e=t.h,r=t.c,i=t.l,a=n.h-e,s=n.c-r,u=n.l-i;isNaN(s)&&(s=0,r=isNaN(r)?n.c:r);isNaN(a)?(a=0,e=isNaN(e)?n.h:e):a>180?a-=360:a<-180&&(a+=360);return function(t){return Jt(e+a*t,r+s*t,i+u*t)+""}},o.interpolateHsl=function(t,n){t=o.hsl(t),n=o.hsl(n);var e=t.h,r=t.s,i=t.l,a=n.h-e,s=n.s-r,u=n.l-i;isNaN(s)&&(s=0,r=isNaN(r)?n.s:r);isNaN(a)?(a=0,e=isNaN(e)?n.h:e):a>180?a-=360:a<-180&&(a+=360);return function(t){return Kt(e+a*t,r+s*t,i+u*t)+""}},o.interpolateLab=function(t,n){t=o.lab(t),n=o.lab(n);var e=t.l,r=t.a,i=t.b,a=n.l-e,s=n.a-r,u=n.b-i;return function(t){return en(e+a*t,r+s*t,i+u*t)+""}},o.interpolateRound=mo,o.transform=function(t){var n=u.createElementNS(o.ns.prefix.svg,"g");return(o.transform=function(t){if(null!=t){n.setAttribute("transform",t);var e=n.transform.baseVal.consolidate()}return new bo(e?e.matrix:Mo)})(t)},bo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Mo={a:1,b:0,c:0,d:1,e:0,f:0};function So(t){return t.length?t.pop()+",":""}function ko(t,n){var e=[],r=[];return t=o.transform(t),n=o.transform(n),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var i=e.push("translate(",null,",",null,")");r.push({i:i-4,x:Qi(t[0],n[0])},{i:i-2,x:Qi(t[1],n[1])})}else(n[0]||n[1])&&e.push("translate("+n+")")}(t.translate,n.translate,e,r),function(t,n,e,r){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),r.push({i:e.push(So(e)+"rotate(",null,")")-2,x:Qi(t,n)})):n&&e.push(So(e)+"rotate("+n+")")}(t.rotate,n.rotate,e,r),function(t,n,e,r){t!==n?r.push({i:e.push(So(e)+"skewX(",null,")")-2,x:Qi(t,n)}):n&&e.push(So(e)+"skewX("+n+")")}(t.skew,n.skew,e,r),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var i=e.push(So(e)+"scale(",null,",",null,")");r.push({i:i-4,x:Qi(t[0],n[0])},{i:i-2,x:Qi(t[1],n[1])})}else 1===n[0]&&1===n[1]||e.push(So(e)+"scale("+n+")")}(t.scale,n.scale,e,r),t=n=null,function(t){for(var n,i=-1,o=r.length;++i<o;)e[(n=r[i]).i]=n.x(t);return e.join("")}}function Eo(t,n){return n=(n-=t=+t)||1/n,function(e){return(e-t)/n}}function Ao(t,n){return n=(n-=t=+t)||1/n,function(e){return Math.max(0,Math.min(1,(e-t)/n))}}function Lo(t){for(var n=t.source,e=t.target,r=function(t,n){if(t===n)return t;var e=No(t),r=No(n),i=e.pop(),o=r.pop(),a=null;for(;i===o;)a=i,i=e.pop(),o=r.pop();return a}(n,e),i=[n];n!==r;)n=n.parent,i.push(n);for(var o=i.length;e!==r;)i.splice(o,0,e),e=e.parent;return i}function No(t){for(var n=[],e=t.parent;null!=e;)n.push(t),t=e,e=e.parent;return n.push(t),n}function Co(t){t.fixed|=2}function Po(t){t.fixed&=-7}function To(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Io(t){t.fixed&=-5}o.interpolateTransform=ko,o.layout={},o.layout.bundle=function(){return function(t){for(var n=[],e=-1,r=t.length;++e<r;)n.push(Lo(t[e]));return n}},o.layout.chord=function(){var t,n,e,r,i,a,s,u={},c=0;function l(){var u,l,f,p,y,d={},g=[],v=o.range(r),x=[];for(t=[],n=[],u=0,p=-1;++p<r;){for(l=0,y=-1;++y<r;)l+=e[p][y];g.push(l),x.push(o.range(r)),u+=l}for(i&&v.sort((function(t,n){return i(g[t],g[n])})),a&&x.forEach((function(t,n){t.sort((function(t,r){return a(e[n][t],e[n][r])}))})),u=(Pt-c*r)/u,l=0,p=-1;++p<r;){for(f=l,y=-1;++y<r;){var m=v[p],b=x[m][y],w=e[m][b],_=l,M=l+=w*u;d[m+"-"+b]={index:m,subindex:b,startAngle:_,endAngle:M,value:w}}n[m]={index:m,startAngle:f,endAngle:l,value:g[m]},l+=c}for(p=-1;++p<r;)for(y=p-1;++y<r;){var S=d[p+"-"+y],k=d[y+"-"+p];(S.value||k.value)&&t.push(S.value<k.value?{source:k,target:S}:{source:S,target:k})}s&&h()}function h(){t.sort((function(t,n){return s((t.source.value+t.target.value)/2,(n.source.value+n.target.value)/2)}))}return u.matrix=function(i){return arguments.length?(r=(e=i)&&e.length,t=n=null,u):e},u.padding=function(e){return arguments.length?(c=e,t=n=null,u):c},u.sortGroups=function(e){return arguments.length?(i=e,t=n=null,u):i},u.sortSubgroups=function(n){return arguments.length?(a=n,t=null,u):a},u.sortChords=function(n){return arguments.length?(s=n,t&&h(),u):s},u.chords=function(){return t||l(),t},u.groups=function(){return n||l(),n},u},o.layout.force=function(){var t,n,e,r,i,a,s={},u=o.dispatch("start","tick","end"),c=[1,1],l=.9,h=zo,f=Do,p=-30,y=Oo,d=.1,g=.64,v=[],x=[];function m(t){return function(n,e,r,i){if(n.point!==t){var o=n.cx-t.x,a=n.cy-t.y,s=i-e,u=o*o+a*a;if(s*s/g<u){if(u<y){var c=n.charge/u;t.px-=o*c,t.py-=a*c}return!0}if(n.point&&u&&u<y){c=n.pointCharge/u;t.px-=o*c,t.py-=a*c}}return!n.charge}}function b(t){t.px=o.event.x,t.py=o.event.y,s.resume()}return s.tick=function(){if((e*=.99)<.005)return t=null,u.end({type:"end",alpha:e=0}),!0;var n,s,h,f,y,g,b,w,_,M=v.length,S=x.length;for(s=0;s<S;++s)f=(h=x[s]).source,(g=(w=(y=h.target).x-f.x)*w+(_=y.y-f.y)*_)&&(w*=g=e*i[s]*((g=Math.sqrt(g))-r[s])/g,_*=g,y.x-=w*(b=f.weight+y.weight?f.weight/(f.weight+y.weight):.5),y.y-=_*b,f.x+=w*(b=1-b),f.y+=_*b);if((b=e*d)&&(w=c[0]/2,_=c[1]/2,s=-1,b))for(;++s<M;)(h=v[s]).x+=(w-h.x)*b,h.y+=(_-h.y)*b;if(p)for(!function t(n,e,r){var i=0,o=0;if(n.charge=0,!n.leaf)for(var a,s=n.nodes,u=s.length,c=-1;++c<u;)null!=(a=s[c])&&(t(a,e,r),n.charge+=a.charge,i+=a.charge*a.cx,o+=a.charge*a.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var l=e*r[n.point.index];n.charge+=n.pointCharge=l,i+=l*n.point.x,o+=l*n.point.y}n.cx=i/n.charge,n.cy=o/n.charge}(n=o.geom.quadtree(v),e,a),s=-1;++s<M;)(h=v[s]).fixed||n.visit(m(h));for(s=-1;++s<M;)(h=v[s]).fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*l,h.y-=(h.py-(h.py=h.y))*l);u.tick({type:"tick",alpha:e})},s.nodes=function(t){return arguments.length?(v=t,s):v},s.links=function(t){return arguments.length?(x=t,s):x},s.size=function(t){return arguments.length?(c=t,s):c},s.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.friction=function(t){return arguments.length?(l=+t,s):l},s.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,s):p},s.chargeDistance=function(t){return arguments.length?(y=t*t,s):Math.sqrt(y)},s.gravity=function(t){return arguments.length?(d=+t,s):d},s.theta=function(t){return arguments.length?(g=t*t,s):Math.sqrt(g)},s.alpha=function(n){return arguments.length?(n=+n,e?n>0?e=n:(t.c=null,t.t=NaN,t=null,u.end({type:"end",alpha:e=0})):n>0&&(u.start({type:"start",alpha:e=n}),t=An(s.tick)),s):e},s.start=function(){var t,n,e,o=v.length,u=x.length,l=c[0],y=c[1];for(t=0;t<o;++t)(e=v[t]).index=t,e.weight=0;for(t=0;t<u;++t)"number"==typeof(e=x[t]).source&&(e.source=v[e.source]),"number"==typeof e.target&&(e.target=v[e.target]),++e.source.weight,++e.target.weight;for(t=0;t<o;++t)e=v[t],isNaN(e.x)&&(e.x=d("x",l)),isNaN(e.y)&&(e.y=d("y",y)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(r=[],"function"==typeof h)for(t=0;t<u;++t)r[t]=+h.call(this,x[t],t);else for(t=0;t<u;++t)r[t]=h;if(i=[],"function"==typeof f)for(t=0;t<u;++t)i[t]=+f.call(this,x[t],t);else for(t=0;t<u;++t)i[t]=f;if(a=[],"function"==typeof p)for(t=0;t<o;++t)a[t]=+p.call(this,v[t],t);else for(t=0;t<o;++t)a[t]=p;function d(e,r){if(!n){for(n=new Array(o),c=0;c<o;++c)n[c]=[];for(c=0;c<u;++c){var i=x[c];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var a,s=n[t],c=-1,l=s.length;++c<l;)if(!isNaN(a=s[c][e]))return a;return Math.random()*r}return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(n||(n=o.behavior.drag().origin(z).on("dragstart.force",Co).on("drag.force",b).on("dragend.force",Po)),!arguments.length)return n;this.on("mouseover.force",To).on("mouseout.force",Io).call(n)},o.rebind(s,u,"on")};var zo=20,Do=1,Oo=1/0;function qo(t,n){return o.rebind(t,n,"sort","children","value"),t.nodes=t,t.links=Fo,t}function Ro(t,n){for(var e=[t];null!=(t=e.pop());)if(n(t),(i=t.children)&&(r=i.length))for(var r,i;--r>=0;)e.push(i[r])}function jo(t,n){for(var e=[t],r=[];null!=(t=e.pop());)if(r.push(t),(o=t.children)&&(i=o.length))for(var i,o,a=-1;++a<i;)e.push(o[a]);for(;null!=(t=r.pop());)n(t)}function Go(t){return t.children}function Vo(t){return t.value}function Bo(t,n){return n.value-t.value}function Fo(t){return o.merge(t.map((function(t){return(t.children||[]).map((function(n){return{source:t,target:n}}))})))}o.layout.hierarchy=function(){var t=Bo,n=Go,e=Vo;function r(i){var o,a=[i],s=[];for(i.depth=0;null!=(o=a.pop());)if(s.push(o),(c=n.call(r,o,o.depth))&&(u=c.length)){for(var u,c,l;--u>=0;)a.push(l=c[u]),l.parent=o,l.depth=o.depth+1;e&&(o.value=0),o.children=c}else e&&(o.value=+e.call(r,o,o.depth)||0),delete o.children;return jo(i,(function(n){var r,i;t&&(r=n.children)&&r.sort(t),e&&(i=n.parent)&&(i.value+=n.value)})),s}return r.sort=function(n){return arguments.length?(t=n,r):t},r.children=function(t){return arguments.length?(n=t,r):n},r.value=function(t){return arguments.length?(e=t,r):e},r.revalue=function(t){return e&&(Ro(t,(function(t){t.children&&(t.value=0)})),jo(t,(function(t){var n;t.children||(t.value=+e.call(r,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)}))),t},r},o.layout.partition=function(){var t=o.layout.hierarchy(),n=[1,1];function e(e,r){var i=t.call(this,e,r);return function t(n,e,r,i){var o=n.children;if(n.x=e,n.y=n.depth*i,n.dx=r,n.dy=i,o&&(a=o.length)){var a,s,u,c=-1;for(r=n.value?r/n.value:0;++c<a;)t(s=o[c],e,u=s.value*r,i),e+=u}}(i[0],0,n[0],n[1]/function t(n){var e=n.children,r=0;if(e&&(i=e.length))for(var i,o=-1;++o<i;)r=Math.max(r,t(e[o]));return 1+r}(i[0])),i}return e.size=function(t){return arguments.length?(n=t,e):n},qo(e,t)},o.layout.pie=function(){var t=Number,n=Ho,e=0,r=Pt,i=0;function a(s){var u,c=s.length,l=s.map((function(n,e){return+t.call(a,n,e)})),h=+("function"==typeof e?e.apply(this,arguments):e),f=("function"==typeof r?r.apply(this,arguments):r)-h,p=Math.min(Math.abs(f)/c,+("function"==typeof i?i.apply(this,arguments):i)),y=p*(f<0?-1:1),d=o.sum(l),g=d?(f-c*y)/d:0,v=o.range(c),x=[];return null!=n&&v.sort(n===Ho?function(t,n){return l[n]-l[t]}:function(t,e){return n(s[t],s[e])}),v.forEach((function(t){x[t]={data:s[t],value:u=l[t],startAngle:h,endAngle:h+=u*g+y,padAngle:p}})),x}return a.value=function(n){return arguments.length?(t=n,a):t},a.sort=function(t){return arguments.length?(n=t,a):n},a.startAngle=function(t){return arguments.length?(e=t,a):e},a.endAngle=function(t){return arguments.length?(r=t,a):r},a.padAngle=function(t){return arguments.length?(i=t,a):i},a};var Ho={};function Uo(t){return t.x}function Xo(t){return t.y}function Zo(t,n,e){t.y0=n,t.y=e}o.layout.stack=function(){var t=z,n=Wo,e=$o,r=Zo,i=Uo,a=Xo;function s(u,c){if(!(p=u.length))return u;var l=u.map((function(n,e){return t.call(s,n,e)})),h=l.map((function(t){return t.map((function(t,n){return[i.call(s,t,n),a.call(s,t,n)]}))})),f=n.call(s,h,c);l=o.permute(l,f),h=o.permute(h,f);var p,y,d,g,v=e.call(s,h,c),x=l[0].length;for(d=0;d<x;++d)for(r.call(s,l[0][d],g=v[d],h[0][d][1]),y=1;y<p;++y)r.call(s,l[y][d],g+=h[y-1][d][1],h[y][d][1]);return u}return s.values=function(n){return arguments.length?(t=n,s):t},s.order=function(t){return arguments.length?(n="function"==typeof t?t:Yo.get(t)||Wo,s):n},s.offset=function(t){return arguments.length?(e="function"==typeof t?t:Ko.get(t)||$o,s):e},s.x=function(t){return arguments.length?(i=t,s):i},s.y=function(t){return arguments.length?(a=t,s):a},s.out=function(t){return arguments.length?(r=t,s):r},s};var Yo=o.map({"inside-out":function(t){var n,e,r=t.length,i=t.map(Jo),a=t.map(Qo),s=o.range(r).sort((function(t,n){return i[t]-i[n]})),u=0,c=0,l=[],h=[];for(n=0;n<r;++n)e=s[n],u<c?(u+=a[e],l.push(e)):(c+=a[e],h.push(e));return h.reverse().concat(l)},reverse:function(t){return o.range(t.length).reverse()},default:Wo}),Ko=o.map({silhouette:function(t){var n,e,r,i=t.length,o=t[0].length,a=[],s=0,u=[];for(e=0;e<o;++e){for(n=0,r=0;n<i;n++)r+=t[n][e][1];r>s&&(s=r),a.push(r)}for(e=0;e<o;++e)u[e]=(s-a[e])/2;return u},wiggle:function(t){var n,e,r,i,o,a,s,u,c,l=t.length,h=t[0],f=h.length,p=[];for(p[0]=u=c=0,e=1;e<f;++e){for(n=0,i=0;n<l;++n)i+=t[n][e][1];for(n=0,o=0,s=h[e][0]-h[e-1][0];n<l;++n){for(r=0,a=(t[n][e][1]-t[n][e-1][1])/(2*s);r<n;++r)a+=(t[r][e][1]-t[r][e-1][1])/s;o+=a*t[n][e][1]}p[e]=u-=i?o/i*s:0,u<c&&(c=u)}for(e=0;e<f;++e)p[e]-=c;return p},expand:function(t){var n,e,r,i=t.length,o=t[0].length,a=1/i,s=[];for(e=0;e<o;++e){for(n=0,r=0;n<i;n++)r+=t[n][e][1];if(r)for(n=0;n<i;n++)t[n][e][1]/=r;else for(n=0;n<i;n++)t[n][e][1]=a}for(e=0;e<o;++e)s[e]=0;return s},zero:$o});function Wo(t){return o.range(t.length)}function $o(t){for(var n=-1,e=t[0].length,r=[];++n<e;)r[n]=0;return r}function Jo(t){for(var n,e=1,r=0,i=t[0][1],o=t.length;e<o;++e)(n=t[e][1])>i&&(r=e,i=n);return r}function Qo(t){return t.reduce(ta,0)}function ta(t,n){return t+n[1]}function na(t,n){return ea(t,Math.ceil(Math.log(n.length)/Math.LN2+1))}function ea(t,n){for(var e=-1,r=+t[0],i=(t[1]-r)/n,o=[];++e<=n;)o[e]=i*e+r;return o}function ra(t){return[o.min(t),o.max(t)]}function ia(t,n){return t.value-n.value}function oa(t,n){var e=t._pack_next;t._pack_next=n,n._pack_prev=t,n._pack_next=e,e._pack_prev=n}function aa(t,n){t._pack_next=n,n._pack_prev=t}function sa(t,n){var e=n.x-t.x,r=n.y-t.y,i=t.r+n.r;return.999*i*i>e*e+r*r}function ua(t){if((n=t.children)&&(u=n.length)){var n,e,r,i,o,a,s,u,c=1/0,l=-1/0,h=1/0,f=-1/0;if(n.forEach(ca),(e=n[0]).x=-e.r,e.y=0,m(e),u>1&&((r=n[1]).x=r.r,r.y=0,m(r),u>2))for(ha(e,r,i=n[2]),m(i),oa(e,i),e._pack_prev=i,oa(i,r),r=e._pack_next,o=3;o<u;o++){ha(e,r,i=n[o]);var p=0,y=1,d=1;for(a=r._pack_next;a!==r;a=a._pack_next,y++)if(sa(a,i)){p=1;break}if(1==p)for(s=e._pack_prev;s!==a._pack_prev&&!sa(s,i);s=s._pack_prev,d++);p?(y<d||y==d&&r.r<e.r?aa(e,r=a):aa(e=s,r),o--):(oa(e,i),r=i,m(i))}var g=(c+l)/2,v=(h+f)/2,x=0;for(o=0;o<u;o++)(i=n[o]).x-=g,i.y-=v,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));t.r=x,n.forEach(la)}function m(t){c=Math.min(t.x-t.r,c),l=Math.max(t.x+t.r,l),h=Math.min(t.y-t.r,h),f=Math.max(t.y+t.r,f)}}function ca(t){t._pack_next=t._pack_prev=t}function la(t){delete t._pack_next,delete t._pack_prev}function ha(t,n,e){var r=t.r+e.r,i=n.x-t.x,o=n.y-t.y;if(r&&(i||o)){var a=n.r+e.r,s=i*i+o*o,u=.5+((r*=r)-(a*=a))/(2*s),c=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);e.x=t.x+u*i+c*o,e.y=t.y+u*o-c*i}else e.x=t.x+r,e.y=t.y}function fa(t,n){return t.parent==n.parent?1:2}function pa(t){var n=t.children;return n.length?n[0]:t.t}function ya(t){var n,e=t.children;return(n=e.length)?e[n-1]:t.t}function da(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function ga(t,n,e){return t.a.parent===n.parent?t.a:e}function va(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function xa(t,n){var e=t.x+n[3],r=t.y+n[0],i=t.dx-n[1]-n[3],o=t.dy-n[0]-n[2];return i<0&&(e+=i/2,i=0),o<0&&(r+=o/2,o=0),{x:e,y:r,dx:i,dy:o}}function ma(t){var n=t[0],e=t[t.length-1];return n<e?[n,e]:[e,n]}function ba(t){return t.rangeExtent?t.rangeExtent():ma(t.range())}function wa(t,n,e,r){var i=e(t[0],t[1]),o=r(n[0],n[1]);return function(t){return o(i(t))}}function _a(t,n){var e,r=0,i=t.length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}function Ma(t){return t?{floor:function(n){return Math.floor(n/t)*t},ceil:function(n){return Math.ceil(n/t)*t}}:Sa}o.layout.histogram=function(){var t=!0,n=Number,e=ra,r=na;function i(i,a){for(var s,u,c=[],l=i.map(n,this),h=e.call(this,l,a),f=r.call(this,h,l,a),p=(a=-1,l.length),y=f.length-1,d=t?1:1/p;++a<y;)(s=c[a]=[]).dx=f[a+1]-(s.x=f[a]),s.y=0;if(y>0)for(a=-1;++a<p;)(u=l[a])>=h[0]&&u<=h[1]&&((s=c[o.bisect(f,u,1,y)-1]).y+=d,s.push(i[a]));return c}return i.value=function(t){return arguments.length?(n=t,i):n},i.range=function(t){return arguments.length?(e=mn(t),i):e},i.bins=function(t){return arguments.length?(r="number"==typeof t?function(n){return ea(n,t)}:mn(t),i):r},i.frequency=function(n){return arguments.length?(t=!!n,i):t},i},o.layout.pack=function(){var t,n=o.layout.hierarchy().sort(ia),e=0,r=[1,1];function i(i,o){var a=n.call(this,i,o),s=a[0],u=r[0],c=r[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,jo(s,(function(t){t.r=+l(t.value)})),jo(s,ua),e){var h=e*(t?1:Math.max(2*s.r/u,2*s.r/c))/2;jo(s,(function(t){t.r+=h})),jo(s,ua),jo(s,(function(t){t.r-=h}))}return function t(n,e,r,i){var o=n.children;if(n.x=e+=i*n.x,n.y=r+=i*n.y,n.r*=i,o)for(var a=-1,s=o.length;++a<s;)t(o[a],e,r,i)}(s,u/2,c/2,t?1:1/Math.max(2*s.r/u,2*s.r/c)),a}return i.size=function(t){return arguments.length?(r=t,i):r},i.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,i):t},i.padding=function(t){return arguments.length?(e=+t,i):e},qo(i,n)},o.layout.tree=function(){var t=o.layout.hierarchy().sort(null).value(null),n=fa,e=[1,1],r=null;function i(i,o){var c=t.call(this,i,o),l=c[0],h=function(t){var n,e={A:null,children:[t]},r=[e];for(;null!=(n=r.pop());)for(var i,o=n.children,a=0,s=o.length;a<s;++a)r.push((o[a]=i={_:o[a],parent:n,children:(i=o[a].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=i);return e.children[0]}(l);if(jo(h,a),h.parent.m=-h.z,Ro(h,s),r)Ro(l,u);else{var f=l,p=l,y=l;Ro(l,(function(t){t.x<f.x&&(f=t),t.x>p.x&&(p=t),t.depth>y.depth&&(y=t)}));var d=n(f,p)/2-f.x,g=e[0]/(p.x+n(p,f)/2+d),v=e[1]/(y.depth||1);Ro(l,(function(t){t.x=(t.x+d)*g,t.y=t.depth*v}))}return c}function a(t){var e=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(e.length){!function(t){var n,e=0,r=0,i=t.children,o=i.length;for(;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+n(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+n(t._,i._));t.parent.A=function(t,e,r){if(e){for(var i,o=t,a=t,s=e,u=o.parent.children[0],c=o.m,l=a.m,h=s.m,f=u.m;s=ya(s),o=pa(o),s&&o;)u=pa(u),(a=ya(a)).a=t,(i=s.z+h-o.z-c+n(s._,o._))>0&&(da(ga(s,t,r),t,i),c+=i,l+=i),h+=s.m,c+=o.m,f+=u.m,l+=a.m;s&&!ya(a)&&(a.t=s,a.m+=h-l),o&&!pa(u)&&(u.t=o,u.m+=c-f,r=t)}return r}(t,i,t.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=e[0],t.y=t.depth*e[1]}return i.separation=function(t){return arguments.length?(n=t,i):n},i.size=function(t){return arguments.length?(r=null==(e=t)?u:null,i):r?null:e},i.nodeSize=function(t){return arguments.length?(r=null==(e=t)?null:u,i):r?e:null},qo(i,t)},o.layout.cluster=function(){var t=o.layout.hierarchy().sort(null).value(null),n=fa,e=[1,1],r=!1;function i(i,a){var s,u=t.call(this,i,a),c=u[0],l=0;jo(c,(function(t){var e=t.children;e&&e.length?(t.x=function(t){return t.reduce((function(t,n){return t+n.x}),0)/t.length}(e),t.y=function(t){return 1+o.max(t,(function(t){return t.y}))}(e)):(t.x=s?l+=n(t,s):0,t.y=0,s=t)}));var h=function t(n){var e=n.children;return e&&e.length?t(e[0]):n}(c),f=function t(n){var e,r=n.children;return r&&(e=r.length)?t(r[e-1]):n}(c),p=h.x-n(h,f)/2,y=f.x+n(f,h)/2;return jo(c,r?function(t){t.x=(t.x-c.x)*e[0],t.y=(c.y-t.y)*e[1]}:function(t){t.x=(t.x-p)/(y-p)*e[0],t.y=(1-(c.y?t.y/c.y:1))*e[1]}),u}return i.separation=function(t){return arguments.length?(n=t,i):n},i.size=function(t){return arguments.length?(r=null==(e=t),i):r?null:e},i.nodeSize=function(t){return arguments.length?(r=null!=(e=t),i):r?e:null},qo(i,t)},o.layout.treemap=function(){var t,n=o.layout.hierarchy(),e=Math.round,r=[1,1],i=null,a=va,s=!1,u="squarify",c=.5*(1+Math.sqrt(5));function l(t,n){for(var e,r,i=-1,o=t.length;++i<o;)r=(e=t[i]).value*(n<0?0:n),e.area=isNaN(r)||r<=0?0:r}function h(t){var n=t.children;if(n&&n.length){var e,r,i,o=a(t),s=[],c=n.slice(),f=1/0,d="slice"===u?o.dx:"dice"===u?o.dy:"slice-dice"===u?1&t.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(l(c,o.dx*o.dy/t.value),s.area=0;(i=c.length)>0;)s.push(e=c[i-1]),s.area+=e.area,"squarify"!==u||(r=p(s,d))<=f?(c.pop(),f=r):(s.area-=s.pop().area,y(s,d,o,!1),d=Math.min(o.dx,o.dy),s.length=s.area=0,f=1/0);s.length&&(y(s,d,o,!0),s.length=s.area=0),n.forEach(h)}}function f(t){var n=t.children;if(n&&n.length){var e,r=a(t),i=n.slice(),o=[];for(l(i,r.dx*r.dy/t.value),o.area=0;e=i.pop();)o.push(e),o.area+=e.area,null!=e.z&&(y(o,e.z?r.dx:r.dy,r,!i.length),o.length=o.area=0);n.forEach(f)}}function p(t,n){for(var e,r=t.area,i=0,o=1/0,a=-1,s=t.length;++a<s;)(e=t[a].area)&&(e<o&&(o=e),e>i&&(i=e));return n*=n,(r*=r)?Math.max(n*i*c/r,r/(n*o*c)):1/0}function y(t,n,r,i){var o,a=-1,s=t.length,u=r.x,c=r.y,l=n?e(t.area/n):0;if(n==r.dx){for((i||l>r.dy)&&(l=r.dy);++a<s;)(o=t[a]).x=u,o.y=c,o.dy=l,u+=o.dx=Math.min(r.x+r.dx-u,l?e(o.area/l):0);o.z=!0,o.dx+=r.x+r.dx-u,r.y+=l,r.dy-=l}else{for((i||l>r.dx)&&(l=r.dx);++a<s;)(o=t[a]).x=u,o.y=c,o.dx=l,c+=o.dy=Math.min(r.y+r.dy-c,l?e(o.area/l):0);o.z=!1,o.dy+=r.y+r.dy-c,r.x+=l,r.dx-=l}}function d(e){var i=t||n(e),o=i[0];return o.x=o.y=0,o.value?(o.dx=r[0],o.dy=r[1]):o.dx=o.dy=0,t&&n.revalue(o),l([o],o.dx*o.dy/o.value),(t?f:h)(o),s&&(t=i),i}return d.size=function(t){return arguments.length?(r=t,d):r},d.padding=function(t){if(!arguments.length)return i;function n(n){var e=t.call(d,n,n.depth);return null==e?va(n):xa(n,"number"==typeof e?[e,e,e,e]:e)}function e(n){return xa(n,t)}var r;return a=null==(i=t)?va:"function"==(r=typeof t)?n:"number"===r?(t=[t,t,t,t],e):e,d},d.round=function(t){return arguments.length?(e=t?Math.round:Number,d):e!=Number},d.sticky=function(n){return arguments.length?(s=n,t=null,d):s},d.ratio=function(t){return arguments.length?(c=t,d):c},d.mode=function(t){return arguments.length?(u=t+"",d):u},qo(d,n)},o.random={normal:function(t,n){var e=arguments.length;return e<2&&(n=1),e<1&&(t=0),function(){var e,r,i;do{i=(e=2*Math.random()-1)*e+(r=2*Math.random()-1)*r}while(!i||i>1);return t+n*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=o.random.normal.apply(o,arguments);return function(){return Math.exp(t())}},bates:function(t){var n=o.random.irwinHall(t);return function(){return n()/t}},irwinHall:function(t){return function(){for(var n=0,e=0;e<t;e++)n+=Math.random();return n}}},o.scale={};var Sa={floor:z,ceil:z};function ka(t,n,e,r){var i=[],a=[],s=0,u=Math.min(t.length,n.length)-1;for(t[u]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++s<=u;)i.push(e(t[s-1],t[s])),a.push(r(n[s-1],n[s]));return function(n){var e=o.bisect(t,n,1,u)-1;return a[e](i[e](n))}}function Ea(t,n){return o.rebind(t,n,"range","rangeRound","interpolate","clamp")}function Aa(t,n){return _a(t,Ma(La(t,n)[2])),_a(t,Ma(La(t,n)[2])),t}function La(t,n){null==n&&(n=10);var e=ma(t),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/n)/Math.LN10)),o=n/r*i;return o<=.15?i*=10:o<=.35?i*=5:o<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Na(t,n){return o.range.apply(o,La(t,n))}function Ca(t,n,e){var r=La(t,n);if(e){var i=zn.exec(e);if(i.shift(),"s"===i[8]){var a=o.formatPrefix(Math.max(_(r[0]),_(r[1])));return i[7]||(i[7]="."+Ta(a.scale(r[2]))),i[8]="f",e=o.format(i.join("")),function(t){return e(a.scale(t))+a.symbol}}i[7]||(i[7]="."+function(t,n){var e=Ta(n[2]);return t in Pa?Math.abs(e-Ta(Math.max(_(n[0]),_(n[1]))))+ +("e"!==t):e-2*("%"===t)}(i[8],r)),e=i.join("")}else e=",."+Ta(r[2])+"f";return o.format(e)}o.scale.linear=function(){return function t(n,e,r,i){var o,a;function s(){var t=Math.min(n.length,e.length)>2?ka:wa,s=i?Ao:Eo;return o=t(n,e,s,r),a=t(e,n,s,ro),u}function u(t){return o(t)}return u.invert=function(t){return a(t)},u.domain=function(t){return arguments.length?(n=t.map(Number),s()):n},u.range=function(t){return arguments.length?(e=t,s()):e},u.rangeRound=function(t){return u.range(t).interpolate(mo)},u.clamp=function(t){return arguments.length?(i=t,s()):i},u.interpolate=function(t){return arguments.length?(r=t,s()):r},u.ticks=function(t){return Na(n,t)},u.tickFormat=function(t,e){return Ca(n,t,e)},u.nice=function(t){return Aa(n,t),s()},u.copy=function(){return t(n,e,r,i)},s()}([0,1],[0,1],ro,!1)};var Pa={s:1,g:1,p:1,r:1,e:1};function Ta(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}o.scale.log=function(){return function t(n,e,r,i){function a(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function s(t){return r?Math.pow(e,t):-Math.pow(e,-t)}function u(t){return n(a(t))}return u.invert=function(t){return s(n.invert(t))},u.domain=function(t){return arguments.length?(r=t[0]>=0,n.domain((i=t.map(Number)).map(a)),u):i},u.base=function(t){return arguments.length?(e=+t,n.domain(i.map(a)),u):e},u.nice=function(){var t=_a(i.map(a),r?Math:za);return n.domain(t),i=t.map(s),u},u.ticks=function(){var t=ma(i),n=[],o=t[0],u=t[1],c=Math.floor(a(o)),l=Math.ceil(a(u)),h=e%1?2:e;if(isFinite(l-c)){if(r){for(;c<l;c++)for(var f=1;f<h;f++)n.push(s(c)*f);n.push(s(c))}else for(n.push(s(c));c++<l;)for(f=h-1;f>0;f--)n.push(s(c)*f);for(c=0;n[c]<o;c++);for(l=n.length;n[l-1]>u;l--);n=n.slice(c,l)}return n},u.tickFormat=function(t,n){if(!arguments.length)return Ia;arguments.length<2?n=Ia:"function"!=typeof n&&(n=o.format(n));var r=Math.max(1,e*t/u.ticks().length);return function(t){var i=t/s(Math.round(a(t)));return i*e<e-.5&&(i*=e),i<=r?n(t):""}},u.copy=function(){return t(n.copy(),e,r,i)},Ea(u,n)}(o.scale.linear().domain([0,1]),10,!0,[1,10])};var Ia=o.format(".0e"),za={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Da(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}o.scale.pow=function(){return function t(n,e,r){var i=Da(e),o=Da(1/e);function a(t){return n(i(t))}return a.invert=function(t){return o(n.invert(t))},a.domain=function(t){return arguments.length?(n.domain((r=t.map(Number)).map(i)),a):r},a.ticks=function(t){return Na(r,t)},a.tickFormat=function(t,n){return Ca(r,t,n)},a.nice=function(t){return a.domain(Aa(r,t))},a.exponent=function(t){return arguments.length?(i=Da(e=t),o=Da(1/e),n.domain(r.map(i)),a):e},a.copy=function(){return t(n.copy(),e,r)},Ea(a,n)}(o.scale.linear(),1,[0,1])},o.scale.sqrt=function(){return o.scale.pow().exponent(.5)},o.scale.ordinal=function(){return function t(n,e){var r,i,a;function s(t){return i[((r.get(t)||("range"===e.t?r.set(t,n.push(t)):NaN))-1)%i.length]}function u(t,e){return o.range(n.length).map((function(n){return t+e*n}))}return s.domain=function(t){if(!arguments.length)return n;n=[],r=new k;for(var i,o=-1,a=t.length;++o<a;)r.has(i=t[o])||r.set(i,n.push(i));return s[e.t].apply(s,e.a)},s.range=function(t){return arguments.length?(i=t,a=0,e={t:"range",a:arguments},s):i},s.rangePoints=function(t,r){arguments.length<2&&(r=0);var o=t[0],c=t[1],l=n.length<2?(o=(o+c)/2,0):(c-o)/(n.length-1+r);return i=u(o+l*r/2,l),a=0,e={t:"rangePoints",a:arguments},s},s.rangeRoundPoints=function(t,r){arguments.length<2&&(r=0);var o=t[0],c=t[1],l=n.length<2?(o=c=Math.round((o+c)/2),0):(c-o)/(n.length-1+r)|0;return i=u(o+Math.round(l*r/2+(c-o-(n.length-1+r)*l)/2),l),a=0,e={t:"rangeRoundPoints",a:arguments},s},s.rangeBands=function(t,r,o){arguments.length<2&&(r=0),arguments.length<3&&(o=r);var c=t[1]<t[0],l=t[c-0],h=t[1-c],f=(h-l)/(n.length-r+2*o);return i=u(l+f*o,f),c&&i.reverse(),a=f*(1-r),e={t:"rangeBands",a:arguments},s},s.rangeRoundBands=function(t,r,o){arguments.length<2&&(r=0),arguments.length<3&&(o=r);var c=t[1]<t[0],l=t[c-0],h=t[1-c],f=Math.floor((h-l)/(n.length-r+2*o));return i=u(l+Math.round((h-l-(n.length-r)*f)/2),f),c&&i.reverse(),a=Math.round(f*(1-r)),e={t:"rangeRoundBands",a:arguments},s},s.rangeBand=function(){return a},s.rangeExtent=function(){return ma(e.a[0])},s.copy=function(){return t(n,e)},s.domain(n)}([],{t:"range",a:[[]]})},o.scale.category10=function(){return o.scale.ordinal().range(Oa)},o.scale.category20=function(){return o.scale.ordinal().range(qa)},o.scale.category20b=function(){return o.scale.ordinal().range(Ra)},o.scale.category20c=function(){return o.scale.ordinal().range(ja)};var Oa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ln),qa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ln),Ra=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ln),ja=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ln);function Ga(){return 0}o.scale.quantile=function(){return function t(n,e){var r;function i(){var t=0,i=e.length;for(r=[];++t<i;)r[t-1]=o.quantile(n,t/i);return a}function a(t){if(!isNaN(t=+t))return e[o.bisect(r,t)]}return a.domain=function(t){return arguments.length?(n=t.map(v).filter(x).sort(g),i()):n},a.range=function(t){return arguments.length?(e=t,i()):e},a.quantiles=function(){return r},a.invertExtent=function(t){return(t=e.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},a.copy=function(){return t(n,e)},i()}([],[])},o.scale.quantize=function(){return function t(n,e,r){var i,o;function a(t){return r[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function s(){return i=r.length/(e-n),o=r.length-1,a}return a.domain=function(t){return arguments.length?(n=+t[0],e=+t[t.length-1],s()):[n,e]},a.range=function(t){return arguments.length?(r=t,s()):r},a.invertExtent=function(t){return[t=(t=r.indexOf(t))<0?NaN:t/i+n,t+1/i]},a.copy=function(){return t(n,e,r)},s()}(0,1,[0,1])},o.scale.threshold=function(){return function t(n,e){function r(t){if(t<=t)return e[o.bisect(n,t)]}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(t){return arguments.length?(e=t,r):e},r.invertExtent=function(t){return t=e.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return t(n,e)},r}([.5],[0,1])},o.scale.identity=function(){return function t(n){function e(t){return+t}return e.invert=e,e.domain=e.range=function(t){return arguments.length?(n=t.map(e),e):n},e.ticks=function(t){return Na(n,t)},e.tickFormat=function(t,e){return Ca(n,t,e)},e.copy=function(){return t(n)},e}([0,1])},o.svg={},o.svg.arc=function(){var t=Ba,n=Fa,e=Ga,r=Va,i=Ha,o=Ua,a=Xa;function s(){var s=Math.max(0,+t.apply(this,arguments)),c=Math.max(0,+n.apply(this,arguments)),l=i.apply(this,arguments)-It,h=o.apply(this,arguments)-It,f=Math.abs(h-l),p=l>h?0:1;if(c<s&&(y=c,c=s,s=y),f>=Tt)return u(c,p)+(s?u(s,1-p):"")+"Z";var y,d,g,v,x,m,b,w,_,M,S,k,E=0,A=0,L=[];if((v=(+a.apply(this,arguments)||0)/2)&&(g=r===Va?Math.sqrt(s*s+c*c):+r.apply(this,arguments),p||(A*=-1),c&&(A=jt(g/c*Math.sin(v))),s&&(E=jt(g/s*Math.sin(v)))),c){x=c*Math.cos(l+A),m=c*Math.sin(l+A),b=c*Math.cos(h-A),w=c*Math.sin(h-A);var N=Math.abs(h-l-2*A)<=Ct?0:1;if(A&&Za(x,m,b,w)===p^N){var C=(l+h)/2;x=c*Math.cos(C),m=c*Math.sin(C),b=w=null}}else x=m=0;if(s){_=s*Math.cos(h-E),M=s*Math.sin(h-E),S=s*Math.cos(l+E),k=s*Math.sin(l+E);var P=Math.abs(l-h+2*E)<=Ct?0:1;if(E&&Za(_,M,S,k)===1-p^P){var T=(l+h)/2;_=s*Math.cos(T),M=s*Math.sin(T),S=k=null}}else _=M=0;if(f>Lt&&(y=Math.min(Math.abs(c-s)/2,+e.apply(this,arguments)))>.001){d=s<c^p?0:1;var I=y,z=y;if(f<Ct){var D=null==S?[_,M]:null==b?[x,m]:fi([x,m],[S,k],[b,w],[_,M]),O=x-D[0],q=m-D[1],R=b-D[0],j=w-D[1],G=1/Math.sin(Math.acos((O*R+q*j)/(Math.sqrt(O*O+q*q)*Math.sqrt(R*R+j*j)))/2),V=Math.sqrt(D[0]*D[0]+D[1]*D[1]);z=Math.min(y,(s-V)/(G-1)),I=Math.min(y,(c-V)/(G+1))}if(null!=b){var B=Ya(null==S?[_,M]:[S,k],[x,m],c,I,p),F=Ya([b,w],[_,M],c,I,p);y===I?L.push("M",B[0],"A",I,",",I," 0 0,",d," ",B[1],"A",c,",",c," 0 ",1-p^Za(B[1][0],B[1][1],F[1][0],F[1][1]),",",p," ",F[1],"A",I,",",I," 0 0,",d," ",F[0]):L.push("M",B[0],"A",I,",",I," 0 1,",d," ",F[0])}else L.push("M",x,",",m);if(null!=S){var H=Ya([x,m],[S,k],s,-z,p),U=Ya([_,M],null==b?[x,m]:[b,w],s,-z,p);y===z?L.push("L",U[0],"A",z,",",z," 0 0,",d," ",U[1],"A",s,",",s," 0 ",p^Za(U[1][0],U[1][1],H[1][0],H[1][1]),",",1-p," ",H[1],"A",z,",",z," 0 0,",d," ",H[0]):L.push("L",U[0],"A",z,",",z," 0 0,",d," ",H[0])}else L.push("L",_,",",M)}else L.push("M",x,",",m),null!=b&&L.push("A",c,",",c," 0 ",N,",",p," ",b,",",w),L.push("L",_,",",M),null!=S&&L.push("A",s,",",s," 0 ",P,",",1-p," ",S,",",k);return L.push("Z"),L.join("")}function u(t,n){return"M0,"+t+"A"+t+","+t+" 0 1,"+n+" 0,"+-t+"A"+t+","+t+" 0 1,"+n+" 0,"+t}return s.innerRadius=function(n){return arguments.length?(t=mn(n),s):t},s.outerRadius=function(t){return arguments.length?(n=mn(t),s):n},s.cornerRadius=function(t){return arguments.length?(e=mn(t),s):e},s.padRadius=function(t){return arguments.length?(r=t==Va?Va:mn(t),s):r},s.startAngle=function(t){return arguments.length?(i=mn(t),s):i},s.endAngle=function(t){return arguments.length?(o=mn(t),s):o},s.padAngle=function(t){return arguments.length?(a=mn(t),s):a},s.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-It;return[Math.cos(r)*e,Math.sin(r)*e]},s};var Va="auto";function Ba(t){return t.innerRadius}function Fa(t){return t.outerRadius}function Ha(t){return t.startAngle}function Ua(t){return t.endAngle}function Xa(t){return t&&t.padAngle}function Za(t,n,e,r){return(t-e)*n-(n-r)*t>0?0:1}function Ya(t,n,e,r,i){var o=t[0]-n[0],a=t[1]-n[1],s=(i?r:-r)/Math.sqrt(o*o+a*a),u=s*a,c=-s*o,l=t[0]+u,h=t[1]+c,f=n[0]+u,p=n[1]+c,y=(l+f)/2,d=(h+p)/2,g=f-l,v=p-h,x=g*g+v*v,m=e-r,b=l*p-f*h,w=(v<0?-1:1)*Math.sqrt(Math.max(0,m*m*x-b*b)),_=(b*v-g*w)/x,M=(-b*g-v*w)/x,S=(b*v+g*w)/x,k=(-b*g+v*w)/x,E=_-y,A=M-d,L=S-y,N=k-d;return E*E+A*A>L*L+N*N&&(_=S,M=k),[[_-u,M-c],[_*e/m,M*e/m]]}function Ka(t){var n=ai,e=si,r=$e,i=$a,o=i.key,a=.7;function s(o){var s,u=[],c=[],l=-1,h=o.length,f=mn(n),p=mn(e);function y(){u.push("M",i(t(c),a))}for(;++l<h;)r.call(this,s=o[l],l)?c.push([+f.call(this,s,l),+p.call(this,s,l)]):c.length&&(y(),c=[]);return c.length&&y(),u.length?u.join(""):null}return s.x=function(t){return arguments.length?(n=t,s):n},s.y=function(t){return arguments.length?(e=t,s):e},s.defined=function(t){return arguments.length?(r=t,s):r},s.interpolate=function(t){return arguments.length?(o="function"==typeof t?i=t:(i=Wa.get(t)||$a).key,s):o},s.tension=function(t){return arguments.length?(a=t,s):a},s}o.svg.line=function(){return Ka(z)};var Wa=o.map({linear:$a,"linear-closed":Ja,step:function(t){var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];for(;++n<e;)i.push("H",(r[0]+(r=t[n])[0])/2,"V",r[1]);e>1&&i.push("H",r[0]);return i.join("")},"step-before":Qa,"step-after":ts,basis:rs,"basis-open":function(t){if(t.length<4)return $a(t);var n,e=[],r=-1,i=t.length,o=[0],a=[0];for(;++r<3;)n=t[r],o.push(n[0]),a.push(n[1]);e.push(is(ss,o)+","+is(ss,a)),--r;for(;++r<i;)n=t[r],o.shift(),o.push(n[0]),a.shift(),a.push(n[1]),us(e,o,a);return e.join("")},"basis-closed":function(t){var n,e,r=-1,i=t.length,o=i+4,a=[],s=[];for(;++r<4;)e=t[r%i],a.push(e[0]),s.push(e[1]);n=[is(ss,a),",",is(ss,s)],--r;for(;++r<o;)e=t[r%i],a.shift(),a.push(e[0]),s.shift(),s.push(e[1]),us(n,a,s);return n.join("")},bundle:function(t,n){var e=t.length-1;if(e)for(var r,i,o=t[0][0],a=t[0][1],s=t[e][0]-o,u=t[e][1]-a,c=-1;++c<=e;)r=t[c],i=c/e,r[0]=n*r[0]+(1-n)*(o+i*s),r[1]=n*r[1]+(1-n)*(a+i*u);return rs(t)},cardinal:function(t,n){return t.length<3?$a(t):t[0]+ns(t,es(t,n))},"cardinal-open":function(t,n){return t.length<4?$a(t):t[1]+ns(t.slice(1,-1),es(t,n))},"cardinal-closed":function(t,n){return t.length<3?Ja(t):t[0]+ns((t.push(t[0]),t),es([t[t.length-2]].concat(t,[t[1]]),n))},monotone:function(t){return t.length<3?$a(t):t[0]+ns(t,function(t){var n,e,r,i,o=[],a=function(t){var n=0,e=t.length-1,r=[],i=t[0],o=t[1],a=r[0]=cs(i,o);for(;++n<e;)r[n]=(a+(a=cs(i=o,o=t[n+1])))/2;return r[n]=a,r}(t),s=-1,u=t.length-1;for(;++s<u;)n=cs(t[s],t[s+1]),_(n)<Lt?a[s]=a[s+1]=0:(e=a[s]/n,r=a[s+1]/n,(i=e*e+r*r)>9&&(i=3*n/Math.sqrt(i),a[s]=i*e,a[s+1]=i*r));s=-1;for(;++s<=u;)i=(t[Math.min(u,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([i||0,a[s]*i||0]);return o}(t))}});function $a(t){return t.length>1?t.join("L"):t+"Z"}function Ja(t){return t.join("L")+"Z"}function Qa(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("V",(r=t[n])[1],"H",r[0]);return i.join("")}function ts(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("H",(r=t[n])[0],"V",r[1]);return i.join("")}function ns(t,n){if(n.length<1||t.length!=n.length&&t.length!=n.length+2)return $a(t);var e=t.length!=n.length,r="",i=t[0],o=t[1],a=n[0],s=a,u=1;if(e&&(r+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],i=t[1],u=2),n.length>1){s=n[1],o=t[u],u++,r+="C"+(i[0]+a[0])+","+(i[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var c=2;c<n.length;c++,u++)o=t[u],s=n[c],r+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(e){var l=t[u];r+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+l[0]+","+l[1]}return r}function es(t,n){for(var e,r=[],i=(1-n)/2,o=t[0],a=t[1],s=1,u=t.length;++s<u;)e=o,o=a,a=t[s],r.push([i*(a[0]-e[0]),i*(a[1]-e[1])]);return r}function rs(t){if(t.length<3)return $a(t);var n=1,e=t.length,r=t[0],i=r[0],o=r[1],a=[i,i,i,(r=t[1])[0]],s=[o,o,o,r[1]],u=[i,",",o,"L",is(ss,a),",",is(ss,s)];for(t.push(t[e-1]);++n<=e;)r=t[n],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),us(u,a,s);return t.pop(),u.push("L",r),u.join("")}function is(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}Wa.forEach((function(t,n){n.key=t,n.closed=/-closed$/.test(t)}));var os=[0,2/3,1/3,0],as=[0,1/3,2/3,0],ss=[0,1/6,2/3,1/6];function us(t,n,e){t.push("C",is(os,n),",",is(os,e),",",is(as,n),",",is(as,e),",",is(ss,n),",",is(ss,e))}function cs(t,n){return(n[1]-t[1])/(n[0]-t[0])}function ls(t){for(var n,e,r,i=-1,o=t.length;++i<o;)e=(n=t[i])[0],r=n[1]-It,n[0]=e*Math.cos(r),n[1]=e*Math.sin(r);return t}function hs(t){var n=ai,e=ai,r=0,i=si,o=$e,a=$a,s=a.key,u=a,c="L",l=.7;function h(s){var h,f,p,y=[],d=[],g=[],v=-1,x=s.length,m=mn(n),b=mn(r),w=n===e?function(){return f}:mn(e),_=r===i?function(){return p}:mn(i);function M(){y.push("M",a(t(g),l),c,u(t(d.reverse()),l),"Z")}for(;++v<x;)o.call(this,h=s[v],v)?(d.push([f=+m.call(this,h,v),p=+b.call(this,h,v)]),g.push([+w.call(this,h,v),+_.call(this,h,v)])):d.length&&(M(),d=[],g=[]);return d.length&&M(),y.length?y.join(""):null}return h.x=function(t){return arguments.length?(n=e=t,h):e},h.x0=function(t){return arguments.length?(n=t,h):n},h.x1=function(t){return arguments.length?(e=t,h):e},h.y=function(t){return arguments.length?(r=i=t,h):i},h.y0=function(t){return arguments.length?(r=t,h):r},h.y1=function(t){return arguments.length?(i=t,h):i},h.defined=function(t){return arguments.length?(o=t,h):o},h.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=Wa.get(t)||$a).key,u=a.reverse||a,c=a.closed?"M":"L",h):s},h.tension=function(t){return arguments.length?(l=t,h):l},h}function fs(t){return t.radius}function ps(t){return[t.x,t.y]}function ys(t){return function(){var n=t.apply(this,arguments),e=n[0],r=n[1]-It;return[e*Math.cos(r),e*Math.sin(r)]}}function ds(){return 64}function gs(){return"circle"}function vs(t){var n=Math.sqrt(t/Ct);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}o.svg.line.radial=function(){var t=Ka(ls);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Qa.reverse=ts,ts.reverse=Qa,o.svg.area=function(){return hs(z)},o.svg.area.radial=function(){var t=hs(ls);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},o.svg.chord=function(){var t=Xr,n=Zr,e=fs,r=Ha,i=Ua;function o(e,r){var i,o,c=a(this,t,e,r),l=a(this,n,e,r);return"M"+c.p0+s(c.r,c.p1,c.a1-c.a0)+(o=l,((i=c).a0==o.a0&&i.a1==o.a1?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+s(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z")}function a(t,n,o,a){var s=n.call(t,o,a),u=e.call(t,s,a),c=r.call(t,s,a)-It,l=i.call(t,s,a)-It;return{r:u,a0:c,a1:l,p0:[u*Math.cos(c),u*Math.sin(c)],p1:[u*Math.cos(l),u*Math.sin(l)]}}function s(t,n,e){return"A"+t+","+t+" 0 "+ +(e>Ct)+",1 "+n}function u(t,n,e,r){return"Q 0,0 "+r}return o.radius=function(t){return arguments.length?(e=mn(t),o):e},o.source=function(n){return arguments.length?(t=mn(n),o):t},o.target=function(t){return arguments.length?(n=mn(t),o):n},o.startAngle=function(t){return arguments.length?(r=mn(t),o):r},o.endAngle=function(t){return arguments.length?(i=mn(t),o):i},o},o.svg.diagonal=function(){var t=Xr,n=Zr,e=ps;function r(r,i){var o=t.call(this,r,i),a=n.call(this,r,i),s=(o.y+a.y)/2,u=[o,{x:o.x,y:s},{x:a.x,y:s},a];return"M"+(u=u.map(e))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}return r.source=function(n){return arguments.length?(t=mn(n),r):t},r.target=function(t){return arguments.length?(n=mn(t),r):n},r.projection=function(t){return arguments.length?(e=t,r):e},r},o.svg.diagonal.radial=function(){var t=o.svg.diagonal(),n=ps,e=t.projection;return t.projection=function(t){return arguments.length?e(ys(n=t)):n},t},o.svg.symbol=function(){var t=gs,n=ds;function e(e,r){return(xs.get(t.call(this,e,r))||vs)(n.call(this,e,r))}return e.type=function(n){return arguments.length?(t=mn(n),e):t},e.size=function(t){return arguments.length?(n=mn(t),e):n},e};var xs=o.map({circle:vs,cross:function(t){var n=Math.sqrt(t/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(t){var n=Math.sqrt(t/(2*bs)),e=n*bs;return"M0,"+-n+"L"+e+",0 0,"+n+" "+-e+",0Z"},square:function(t){var n=Math.sqrt(t)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(t){var n=Math.sqrt(t/ms),e=n*ms/2;return"M0,"+e+"L"+n+","+-e+" "+-n+","+-e+"Z"},"triangle-up":function(t){var n=Math.sqrt(t/ms),e=n*ms/2;return"M0,"+-e+"L"+n+","+e+" "+-n+","+e+"Z"}});o.svg.symbolTypes=xs.keys();var ms=Math.sqrt(3),bs=Math.tan(30*zt);W.transition=function(t){for(var n,e,r=Ss||++As,i=Cs(t),o=[],a=ks||{time:Date.now(),ease:po,delay:0,duration:250},s=-1,u=this.length;++s<u;){o.push(n=[]);for(var c=this[s],l=-1,h=c.length;++l<h;)(e=c[l])&&Ps(e,l,i,r,a),n.push(e)}return Ms(o,i,r)},W.interrupt=function(t){return this.each(null==t?ws:_s(Cs(t)))};var ws=_s(Cs());function _s(t){return function(){var n,e,r;(n=this[t])&&(r=n[e=n.active])&&(r.timer.c=null,r.timer.t=NaN,--n.count?delete n[e]:delete this[t],n.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Ms(t,n,e){return U(t,Es),t.namespace=n,t.id=e,t}var Ss,ks,Es=[],As=0;function Ls(t,n,e,r){var i=t.id,o=t.namespace;return yt(t,"function"==typeof e?function(t,a,s){t[o][i].tween.set(n,r(e.call(t,t.__data__,a,s)))}:(e=r(e),function(t){t[o][i].tween.set(n,e)}))}function Ns(t){return null==t&&(t=""),function(){this.textContent=t}}function Cs(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ps(t,n,e,r,i){var o,a,s,u,c,l=t[e]||(t[e]={active:0,count:0}),h=l[r];function f(e){var i=l.active,f=l[i];for(var y in f&&(f.timer.c=null,f.timer.t=NaN,--l.count,delete l[i],f.event&&f.event.interrupt.call(t,t.__data__,f.index)),l)if(+y<r){var d=l[y];d.timer.c=null,d.timer.t=NaN,--l.count,delete l[y]}a.c=p,An((function(){return a.c&&p(e||1)&&(a.c=null,a.t=NaN),1}),0,o),l.active=r,h.event&&h.event.start.call(t,t.__data__,n),c=[],h.tween.forEach((function(e,r){(r=r.call(t,t.__data__,n))&&c.push(r)})),u=h.ease,s=h.duration}function p(i){for(var o=i/s,a=u(o),f=c.length;f>0;)c[--f].call(t,a);if(o>=1)return h.event&&h.event.end.call(t,t.__data__,n),--l.count?delete l[r]:delete t[e],1}h||(o=i.time,a=An((function(t){var n=h.delay;if(a.t=n+o,n<=t)return f(t-n);a.c=f}),0,o),h=l[r]={tween:new k,time:o,timer:a,delay:i.delay,duration:i.duration,ease:i.ease,index:n},i=null,++l.count)}Es.call=W.call,Es.empty=W.empty,Es.node=W.node,Es.size=W.size,o.transition=function(t,n){return t&&t.transition?Ss?t.transition(n):t:o.selection().transition(t)},o.transition.prototype=Es,Es.select=function(t){var n,e,r,i=this.id,o=this.namespace,a=[];t=$(t);for(var s=-1,u=this.length;++s<u;){a.push(n=[]);for(var c=this[s],l=-1,h=c.length;++l<h;)(r=c[l])&&(e=t.call(r,r.__data__,l,s))?("__data__"in r&&(e.__data__=r.__data__),Ps(e,l,o,i,r[o][i]),n.push(e)):n.push(null)}return Ms(a,o,i)},Es.selectAll=function(t){var n,e,r,i,o,a=this.id,s=this.namespace,u=[];t=J(t);for(var c=-1,l=this.length;++c<l;)for(var h=this[c],f=-1,p=h.length;++f<p;)if(r=h[f]){o=r[s][a],e=t.call(r,r.__data__,f,c),u.push(n=[]);for(var y=-1,d=e.length;++y<d;)(i=e[y])&&Ps(i,y,s,a,o),n.push(i)}return Ms(u,s,a)},Es.filter=function(t){var n,e,r=[];"function"!=typeof t&&(t=ft(t));for(var i=0,o=this.length;i<o;i++){r.push(n=[]);for(var a,s=0,u=(a=this[i]).length;s<u;s++)(e=a[s])&&t.call(e,e.__data__,s,i)&&n.push(e)}return Ms(r,this.namespace,this.id)},Es.tween=function(t,n){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(t):yt(this,null==n?function(n){n[r][e].tween.remove(t)}:function(i){i[r][e].tween.set(t,n)})},Es.attr=function(t,n){if(arguments.length<2){for(n in t)this.attr(n,t[n]);return this}var e="transform"==t?ko:ro,r=o.ns.qualify(t);function i(){this.removeAttribute(r)}function a(){this.removeAttributeNS(r.space,r.local)}function s(t){return null==t?i:(t+="",function(){var n,i=this.getAttribute(r);return i!==t&&(n=e(i,t),function(t){this.setAttribute(r,n(t))})})}function u(t){return null==t?a:(t+="",function(){var n,i=this.getAttributeNS(r.space,r.local);return i!==t&&(n=e(i,t),function(t){this.setAttributeNS(r.space,r.local,n(t))})})}return Ls(this,"attr."+t,n,r.local?u:s)},Es.attrTween=function(t,n){var e=o.ns.qualify(t);return this.tween("attr."+t,e.local?function(t,r){var i=n.call(this,t,r,this.getAttributeNS(e.space,e.local));return i&&function(t){this.setAttributeNS(e.space,e.local,i(t))}}:function(t,r){var i=n.call(this,t,r,this.getAttribute(e));return i&&function(t){this.setAttribute(e,i(t))}})},Es.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.style(e,t[e],n);return this}e=""}function i(){this.style.removeProperty(t)}function o(n){return null==n?i:(n+="",function(){var r,i=l(this).getComputedStyle(this,null).getPropertyValue(t);return i!==n&&(r=ro(i,n),function(n){this.style.setProperty(t,r(n),e)})})}return Ls(this,"style."+t,n,o)},Es.styleTween=function(t,n,e){function r(r,i){var o=n.call(this,r,i,l(this).getComputedStyle(this,null).getPropertyValue(t));return o&&function(n){this.style.setProperty(t,o(n),e)}}return arguments.length<3&&(e=""),this.tween("style."+t,r)},Es.text=function(t){return Ls(this,"text",t,Ns)},Es.remove=function(){var t=this.namespace;return this.each("end.transition",(function(){var n;this[t].count<2&&(n=this.parentNode)&&n.removeChild(this)}))},Es.ease=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].ease:("function"!=typeof t&&(t=o.ease.apply(o,arguments)),yt(this,(function(r){r[e][n].ease=t})))},Es.delay=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].delay:yt(this,"function"==typeof t?function(r,i,o){r[e][n].delay=+t.call(r,r.__data__,i,o)}:(t=+t,function(r){r[e][n].delay=t}))},Es.duration=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].duration:yt(this,"function"==typeof t?function(r,i,o){r[e][n].duration=Math.max(1,t.call(r,r.__data__,i,o))}:(t=Math.max(1,t),function(r){r[e][n].duration=t}))},Es.each=function(t,n){var e=this.id,r=this.namespace;if(arguments.length<2){var i=ks,a=Ss;try{Ss=e,yt(this,(function(n,i,o){ks=n[r][e],t.call(n,n.__data__,i,o)}))}finally{ks=i,Ss=a}}else yt(this,(function(i){var a=i[r][e];(a.event||(a.event=o.dispatch("start","end","interrupt"))).on(t,n)}));return this},Es.transition=function(){for(var t,n,e,r=this.id,i=++As,o=this.namespace,a=[],s=0,u=this.length;s<u;s++){a.push(t=[]);for(var c,l=0,h=(c=this[s]).length;l<h;l++)(n=c[l])&&Ps(n,l,o,i,{time:(e=n[o][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),t.push(n)}return Ms(a,o,i)},o.svg.axis=function(){var t,n=o.scale.linear(),e=Ts,r=6,i=6,a=3,u=[10],c=null;function l(s){s.each((function(){var s,l=o.select(this),h=this.__chart__||n,f=this.__chart__=n.copy(),p=null==c?f.ticks?f.ticks.apply(f,u):f.domain():c,y=null==t?f.tickFormat?f.tickFormat.apply(f,u):z:t,d=l.selectAll(".tick").data(p,f),g=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Lt),v=o.transition(d.exit()).style("opacity",Lt).remove(),x=o.transition(d.order()).style("opacity",1),m=Math.max(r,0)+a,b=ba(f),w=l.selectAll(".domain").data([0]),_=(w.enter().append("path").attr("class","domain"),o.transition(w));g.append("line"),g.append("text");var M,S,k,E,A=g.select("line"),L=x.select("line"),N=d.select("text").text(y),C=g.select("text"),P=x.select("text"),T="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===e?(s=zs,M="x",k="y",S="x2",E="y2",N.attr("dy",T<0?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+b[0]+","+T*i+"V0H"+b[1]+"V"+T*i)):(s=Ds,M="y",k="x",S="y2",E="x2",N.attr("dy",".32em").style("text-anchor",T<0?"end":"start"),_.attr("d","M"+T*i+","+b[0]+"H0V"+b[1]+"H"+T*i)),A.attr(E,T*r),C.attr(k,T*m),L.attr(S,0).attr(E,T*r),P.attr(M,0).attr(k,T*m),f.rangeBand){var I=f,D=I.rangeBand()/2;h=f=function(t){return I(t)+D}}else h.rangeBand?h=f:v.call(s,f,h);g.call(s,h,f),x.call(s,f,f)}))}return l.scale=function(t){return arguments.length?(n=t,l):n},l.orient=function(t){return arguments.length?(e=t in Is?t+"":Ts,l):e},l.ticks=function(){return arguments.length?(u=s(arguments),l):u},l.tickValues=function(t){return arguments.length?(c=t,l):c},l.tickFormat=function(n){return arguments.length?(t=n,l):t},l.tickSize=function(t){var n=arguments.length;return n?(r=+t,i=+arguments[n-1],l):r},l.innerTickSize=function(t){return arguments.length?(r=+t,l):r},l.outerTickSize=function(t){return arguments.length?(i=+t,l):i},l.tickPadding=function(t){return arguments.length?(a=+t,l):a},l.tickSubdivide=function(){return arguments.length&&l},l};var Ts="bottom",Is={top:1,right:1,bottom:1,left:1};function zs(t,n,e){t.attr("transform",(function(t){var r=n(t);return"translate("+(isFinite(r)?r:e(t))+",0)"}))}function Ds(t,n,e){t.attr("transform",(function(t){var r=n(t);return"translate(0,"+(isFinite(r)?r:e(t))+")"}))}o.svg.brush=function(){var t,n,e=F(f,"brushstart","brush","brushend"),r=null,i=null,a=[0,0],s=[0,0],u=!0,c=!0,h=qs[0];function f(t){t.each((function(){var t=o.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),n=t.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=t.selectAll(".resize").data(h,z);e.exit().remove(),e.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return Os[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",f.empty()?"none":null);var a,s=o.transition(t),u=o.transition(n);r&&(a=ba(r),u.attr("x",a[0]).attr("width",a[1]-a[0]),y(s)),i&&(a=ba(i),u.attr("y",a[0]).attr("height",a[1]-a[0]),d(s)),p(s)}))}function p(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+a[+/e$/.test(t)]+","+s[+/^s/.test(t)]+")"}))}function y(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function d(t){t.select(".extent").attr("y",s[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",s[1]-s[0])}function g(){var h,g,v=this,x=o.select(o.event.target),m=e.of(v,arguments),b=o.select(v),w=x.datum(),_=!/^(n|s)$/.test(w)&&r,M=!/^(e|w)$/.test(w)&&i,S=x.classed("extent"),k=St(v),E=o.mouse(v),A=o.select(l(v)).on("keydown.brush",C).on("keyup.brush",P);if(o.event.changedTouches?A.on("touchmove.brush",T).on("touchend.brush",z):A.on("mousemove.brush",T).on("mouseup.brush",z),b.interrupt().selectAll("*").interrupt(),S)E[0]=a[0]-E[0],E[1]=s[0]-E[1];else if(w){var L=+/w$/.test(w),N=+/^n/.test(w);g=[a[1-L]-E[0],s[1-N]-E[1]],E[0]=a[L],E[1]=s[N]}else o.event.altKey&&(h=E.slice());function C(){32==o.event.keyCode&&(S||(h=null,E[0]-=a[1],E[1]-=s[1],S=2),V())}function P(){32==o.event.keyCode&&2==S&&(E[0]+=a[1],E[1]+=s[1],S=0,V())}function T(){var t=o.mouse(v),n=!1;g&&(t[0]+=g[0],t[1]+=g[1]),S||(o.event.altKey?(h||(h=[(a[0]+a[1])/2,(s[0]+s[1])/2]),E[0]=a[+(t[0]<h[0])],E[1]=s[+(t[1]<h[1])]):h=null),_&&I(t,r,0)&&(y(b),n=!0),M&&I(t,i,1)&&(d(b),n=!0),n&&(p(b),m({type:"brush",mode:S?"move":"resize"}))}function I(e,r,i){var o,l,f=ba(r),p=f[0],y=f[1],d=E[i],g=i?s:a,v=g[1]-g[0];if(S&&(p-=d,y-=v+d),o=(i?c:u)?Math.max(p,Math.min(y,e[i])):e[i],S?l=(o+=d)+v:(h&&(d=Math.max(p,Math.min(y,2*h[i]-o))),d<o?(l=o,o=d):l=d),g[0]!=o||g[1]!=l)return i?n=null:t=null,g[0]=o,g[1]=l,!0}function z(){T(),b.style("pointer-events","all").selectAll(".resize").style("display",f.empty()?"none":null),o.select("body").style("cursor",null),A.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),k(),m({type:"brushend"})}b.style("pointer-events","none").selectAll(".resize").style("display",null),o.select("body").style("cursor",x.style("cursor")),m({type:"brushstart"}),T()}return f.event=function(r){r.each((function(){var r=e.of(this,arguments),i={x:a,y:s,i:t,j:n},u=this.__chart__||i;this.__chart__=i,Ss?o.select(this).transition().each("start.brush",(function(){t=u.i,n=u.j,a=u.x,s=u.y,r({type:"brushstart"})})).tween("brush:brush",(function(){var e=io(a,i.x),o=io(s,i.y);return t=n=null,function(t){a=i.x=e(t),s=i.y=o(t),r({type:"brush",mode:"resize"})}})).each("end.brush",(function(){t=i.i,n=i.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})})):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))}))},f.x=function(t){return arguments.length?(h=qs[!(r=t)<<1|!i],f):r},f.y=function(t){return arguments.length?(h=qs[!r<<1|!(i=t)],f):i},f.clamp=function(t){return arguments.length?(r&&i?(u=!!t[0],c=!!t[1]):r?u=!!t:i&&(c=!!t),f):r&&i?[u,c]:r?u:i?c:null},f.extent=function(e){var o,u,c,l,h;return arguments.length?(r&&(o=e[0],u=e[1],i&&(o=o[0],u=u[0]),t=[o,u],r.invert&&(o=r(o),u=r(u)),u<o&&(h=o,o=u,u=h),o==a[0]&&u==a[1]||(a=[o,u])),i&&(c=e[0],l=e[1],r&&(c=c[1],l=l[1]),n=[c,l],i.invert&&(c=i(c),l=i(l)),l<c&&(h=c,c=l,l=h),c==s[0]&&l==s[1]||(s=[c,l])),f):(r&&(t?(o=t[0],u=t[1]):(o=a[0],u=a[1],r.invert&&(o=r.invert(o),u=r.invert(u)),u<o&&(h=o,o=u,u=h))),i&&(n?(c=n[0],l=n[1]):(c=s[0],l=s[1],i.invert&&(c=i.invert(c),l=i.invert(l)),l<c&&(h=c,c=l,l=h))),r&&i?[[o,c],[u,l]]:r?[o,u]:i&&[c,l])},f.clear=function(){return f.empty()||(a=[0,0],s=[0,0],t=n=null),f},f.empty=function(){return!!r&&a[0]==a[1]||!!i&&s[0]==s[1]},o.rebind(f,e,"on")};var Os={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Rs=qn.format=fe.timeFormat,js=Rs.utc,Gs=js("%Y-%m-%dT%H:%M:%S.%LZ");function Vs(t){return t.toISOString()}function Bs(t,n,e){function r(n){return t(n)}function i(t,e){var r=(t[1]-t[0])/e,i=o.bisect(Hs,r);return i==Hs.length?[n.year,La(t.map((function(t){return t/31536e6})),e)[2]]:i?n[r/Hs[i-1]<Hs[i]/r?i-1:i]:[Zs,La(t,e)[2]]}return r.invert=function(n){return Fs(t.invert(n))},r.domain=function(n){return arguments.length?(t.domain(n),r):t.domain().map(Fs)},r.nice=function(t,n){var e=r.domain(),o=ma(e),a=null==t?i(o,10):"number"==typeof t&&i(o,t);function s(e){return!isNaN(e)&&!t.range(e,Fs(+e+1),n).length}return a&&(t=a[0],n=a[1]),r.domain(_a(e,n>1?{floor:function(n){for(;s(n=t.floor(n));)n=Fs(n-1);return n},ceil:function(n){for(;s(n=t.ceil(n));)n=Fs(+n+1);return n}}:t))},r.ticks=function(t,n){var e=ma(r.domain()),o=null==t?i(e,10):"number"==typeof t?i(e,t):!t.range&&[{range:t},n];return o&&(t=o[0],n=o[1]),t.range(e[0],Fs(+e[1]+1),n<1?1:n)},r.tickFormat=function(){return e},r.copy=function(){return Bs(t.copy(),n,e)},Ea(r,t)}function Fs(t){return new Date(t)}Rs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Vs:Gs,Vs.parse=function(t){var n=new Date(t);return isNaN(n)?null:n},Vs.toString=Gs.toString,qn.second=Vn((function(t){return new Rn(1e3*Math.floor(t/1e3))}),(function(t,n){t.setTime(t.getTime()+1e3*Math.floor(n))}),(function(t){return t.getSeconds()})),qn.seconds=qn.second.range,qn.seconds.utc=qn.second.utc.range,qn.minute=Vn((function(t){return new Rn(6e4*Math.floor(t/6e4))}),(function(t,n){t.setTime(t.getTime()+6e4*Math.floor(n))}),(function(t){return t.getMinutes()})),qn.minutes=qn.minute.range,qn.minutes.utc=qn.minute.utc.range,qn.hour=Vn((function(t){var n=t.getTimezoneOffset()/60;return new Rn(36e5*(Math.floor(t/36e5-n)+n))}),(function(t,n){t.setTime(t.getTime()+36e5*Math.floor(n))}),(function(t){return t.getHours()})),qn.hours=qn.hour.range,qn.hours.utc=qn.hour.utc.range,qn.month=Vn((function(t){return(t=qn.day(t)).setDate(1),t}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t){return t.getMonth()})),qn.months=qn.month.range,qn.months.utc=qn.month.utc.range;var Hs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Us=[[qn.second,1],[qn.second,5],[qn.second,15],[qn.second,30],[qn.minute,1],[qn.minute,5],[qn.minute,15],[qn.minute,30],[qn.hour,1],[qn.hour,3],[qn.hour,6],[qn.hour,12],[qn.day,1],[qn.day,2],[qn.week,1],[qn.month,1],[qn.month,3],[qn.year,1]],Xs=Rs.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",$e]]),Zs={range:function(t,n,e){return o.range(Math.ceil(t/e)*e,+n,e).map(Fs)},floor:z,ceil:z};Us.year=qn.year,qn.scale=function(){return Bs(o.scale.linear(),Us,Xs)};var Ys=Us.map((function(t){return[t[0].utc,t[1]]})),Ks=js.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",$e]]);function Ws(t){return JSON.parse(t.responseText)}function $s(t){var n=u.createRange();return n.selectNode(u.body),n.createContextualFragment(t.responseText)}Ys.year=qn.year.utc,qn.scale.utc=function(){return Bs(o.scale.linear(),Ys,Ks)},o.text=bn((function(t){return t.responseText})),o.json=function(t,n){return wn(t,"application/json",Ws,n)},o.html=function(t,n){return wn(t,"text/html",$s,n)},o.xml=bn((function(t){return t.responseXML})),this.d3=o,void 0===(i="function"==typeof(r=o)?r.call(n,e,n,t):r)||(t.exports=i)}()},function(t,n){function e(t,n){this.x=t||0,this.y=n||0,Object.freeze(this)}e.prototype.distance=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},e.prototype.manhattanDistance=function(t){var n=this.sub(t).abs();return n.x+n.y},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},t.exports=e},function(t,n,e){var r=e(1);function i(t){arguments.length>0&&this.init(t)}i.prototype.init=function(t){this.status=t,this.points=new Array},i.prototype.appendPoint=function(t){this.points.push(t)},i.prototype.appendPoints=function(t){this.points=this.points.concat(t)},i.intersectShapes=function(t,n){var e,r=t.getIntersectionParams(),o=n.getIntersectionParams();if(null!=r&&null!=o)if("Path"==r.name)e=i.intersectPathShape(t,n);else if("Path"==o.name)e=i.intersectPathShape(n,t);else{var a,s;if(r.name<o.name?(a="intersect"+r.name+o.name,s=r.params.concat(o.params)):(a="intersect"+o.name+r.name,s=o.params.concat(r.params)),!(a in i))throw new Error("Intersection not available: "+a);e=i[a].apply(null,s)}else e=new i("No Intersection");return e},i.intersectPathShape=function(t,n){return t.intersectShape(n)},i.intersectBezier2Bezier2=function(t,n,e,o,a,s){var u,c,l,h,f,p,y,d,g,v=new i("No Intersection");if(u=n.multiply(-2),l=t.add(u.add(e)),u=t.multiply(-2),c=n.multiply(2),h=u.add(c),f=new r(t.x,t.y),u=a.multiply(-2),p=o.add(u.add(s)),u=o.multiply(-2),c=a.multiply(2),y=u.add(c),d=new r(o.x,o.y),0==l.y){var x=(b=l.x*(f.y-d.y))+(w=b-h.x*h.y),m=h.y*h.y;g=new Polynomial(l.x*p.y*p.y,2*l.x*y.y*p.y,l.x*y.y*y.y-p.x*m-p.y*b-p.y*w,-y.x*m-y.y*b-y.y*w,(f.x-d.x)*m+(f.y-d.y)*w)}else{var b=l.x*p.y-l.y*p.x,w=l.x*y.y-y.x*l.y,_=(x=h.x*l.y-h.y*l.x,m=f.y-d.y,l.y*(f.x-d.x)-l.x*m),M=-h.y*x+l.y*_,S=x*x;g=new Polynomial(b*b,2*b*w,(-p.y*S+l.y*w*w+l.y*b*_+b*M)/l.y,(-y.y*S+l.y*w*_+w*M)/l.y,(m*S+_*M)/l.y)}for(var k=g.getRoots(),E=0;E<k.length;E++){var A=k[E];if(0<=A&&A<=1){var L=new Polynomial(l.x,h.x,f.x-d.x-A*y.x-A*A*p.x).getRoots(),N=new Polynomial(l.y,h.y,f.y-d.y-A*y.y-A*A*p.y).getRoots();if(L.length>0&&N.length>0){t:for(var C=0;C<L.length;C++){var P=L[C];if(0<=P&&P<=1)for(var T=0;T<N.length;T++)if(Math.abs(P-N[T])<1e-4){v.points.push(p.multiply(A*A).add(y.multiply(A).add(d)));break t}}}}}return v.points.length>0&&(v.status="Intersection"),v},i.intersectBezier2Bezier3=function(t,n,e,o,a,s,u){var c,l,h,f,p,y,d,g,v,x,m,b=new i("No Intersection");c=n.multiply(-2),p=t.add(c.add(e)),c=t.multiply(-2),l=n.multiply(2),y=c.add(l),d=new r(t.x,t.y),c=o.multiply(-1),l=a.multiply(3),h=s.multiply(-3),f=c.add(l.add(h.add(u))),g=new Vector2D(f.x,f.y),c=o.multiply(3),l=a.multiply(-6),h=s.multiply(3),f=c.add(l.add(h)),v=new Vector2D(f.x,f.y),c=o.multiply(-3),l=a.multiply(3),h=c.add(l),x=new Vector2D(h.x,h.y),m=new Vector2D(o.x,o.y);for(var w=d.x*d.x,_=d.y*d.y,M=y.x*y.x,S=y.y*y.y,k=p.x*p.x,E=p.y*p.y,A=m.x*m.x,L=m.y*m.y,N=x.x*x.x,C=x.y*x.y,P=v.x*v.x,T=v.y*v.y,I=g.x*g.x,z=g.y*g.y,D=new Polynomial(-2*p.x*p.y*g.x*g.y+k*z+E*I,-2*p.x*p.y*v.x*g.y-2*p.x*p.y*v.y*g.x+2*E*v.x*g.x+2*k*v.y*g.y,-2*p.x*x.x*p.y*g.y-2*p.x*p.y*x.y*g.x-2*p.x*p.y*v.x*v.y+2*x.x*E*g.x+E*P+k*(2*x.y*g.y+T),2*d.x*p.x*p.y*g.y+2*d.y*p.x*p.y*g.x+y.x*y.y*p.x*g.y+y.x*y.y*p.y*g.x-2*m.x*p.x*p.y*g.y-2*p.x*m.y*p.y*g.x-2*p.x*x.x*p.y*v.y-2*p.x*p.y*x.y*v.x-2*d.x*E*g.x-2*d.y*k*g.y+2*m.x*E*g.x+2*x.x*E*v.x-S*p.x*g.x-M*p.y*g.y+k*(2*m.y*g.y+2*x.y*v.y),2*d.x*p.x*p.y*v.y+2*d.y*p.x*p.y*v.x+y.x*y.y*p.x*v.y+y.x*y.y*p.y*v.x-2*m.x*p.x*p.y*v.y-2*p.x*m.y*p.y*v.x-2*p.x*x.x*p.y*x.y-2*d.x*E*v.x-2*d.y*k*v.y+2*m.x*E*v.x-S*p.x*v.x-M*p.y*v.y+N*E+k*(2*m.y*v.y+C),2*d.x*p.x*p.y*x.y+2*d.y*p.x*x.x*p.y+y.x*y.y*p.x*x.y+y.x*y.y*x.x*p.y-2*m.x*p.x*p.y*x.y-2*p.x*m.y*x.x*p.y-2*d.x*x.x*E-2*d.y*k*x.y+2*m.x*x.x*E-S*p.x*x.x-M*p.y*x.y+2*k*m.y*x.y,-2*d.x*d.y*p.x*p.y-d.x*y.x*y.y*p.y-d.y*y.x*y.y*p.x+2*d.x*p.x*m.y*p.y+2*d.y*m.x*p.x*p.y+y.x*m.x*y.y*p.y+y.x*y.y*p.x*m.y-2*m.x*p.x*m.y*p.y-2*d.x*m.x*E+d.x*S*p.x+d.y*M*p.y-2*d.y*k*m.y-m.x*S*p.x-M*m.y*p.y+w*E+_*k+A*E+k*L).getRootsInInterval(0,1),O=0;O<D.length;O++){var q=D[O],R=new Polynomial(p.x,y.x,d.x-m.x-q*x.x-q*q*v.x-q*q*q*g.x).getRoots(),j=new Polynomial(p.y,y.y,d.y-m.y-q*x.y-q*q*v.y-q*q*q*g.y).getRoots();if(R.length>0&&j.length>0){t:for(var G=0;G<R.length;G++){var V=R[G];if(0<=V&&V<=1)for(var B=0;B<j.length;B++)if(Math.abs(V-j[B])<1e-4){b.points.push(g.multiply(q*q*q).add(v.multiply(q*q).add(x.multiply(q).add(m))));break t}}}}return b.points.length>0&&(b.status="Intersection"),b},i.intersectBezier2Circle=function(t,n,e,r,o){return i.intersectBezier2Ellipse(t,n,e,r,o,o)},i.intersectBezier2Ellipse=function(t,n,e,o,a,s){var u,c,l,h,f,p=new i("No Intersection");u=n.multiply(-2),l=t.add(u.add(e)),u=t.multiply(-2),c=n.multiply(2),h=u.add(c),f=new r(t.x,t.y);for(var y=a*a,d=s*s,g=new Polynomial(d*l.x*l.x+y*l.y*l.y,2*(d*l.x*h.x+y*l.y*h.y),d*(2*l.x*f.x+h.x*h.x)+y*(2*l.y*f.y+h.y*h.y)-2*(d*o.x*l.x+y*o.y*l.y),2*(d*h.x*(f.x-o.x)+y*h.y*(f.y-o.y)),d*(f.x*f.x+o.x*o.x)+y*(f.y*f.y+o.y*o.y)-2*(d*o.x*f.x+y*o.y*f.y)-y*d).getRoots(),v=0;v<g.length;v++){var x=g[v];0<=x&&x<=1&&p.points.push(l.multiply(x*x).add(h.multiply(x).add(f)))}return p.points.length>0&&(p.status="Intersection"),p},i.intersectBezier2Line=function(t,n,e,o,a){var s,u,c,l,h,f,p,y=o.min(a),d=o.max(a),g=new i("No Intersection");s=n.multiply(-2),c=t.add(s.add(e)),s=t.multiply(-2),u=n.multiply(2),l=s.add(u),h=new r(t.x,t.y),p=new Vector2D(o.y-a.y,a.x-o.x),f=o.x*a.y-a.x*o.y,roots=new Polynomial(p.dot(c),p.dot(l),p.dot(h)+f).getRoots();for(var v=0;v<roots.length;v++){var x=roots[v];if(0<=x&&x<=1){var m=t.lerp(n,x),b=n.lerp(e,x),w=m.lerp(b,x);o.x==a.x?y.y<=w.y&&w.y<=d.y&&(g.status="Intersection",g.appendPoint(w)):o.y==a.y?y.x<=w.x&&w.x<=d.x&&(g.status="Intersection",g.appendPoint(w)):w.gte(y)&&w.lte(d)&&(g.status="Intersection",g.appendPoint(w))}}return g},i.intersectBezier2Polygon=function(t,n,e,r){for(var o=new i("No Intersection"),a=r.length,s=0;s<a;s++){var u=r[s],c=r[(s+1)%a],l=i.intersectBezier2Line(t,n,e,u,c);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},i.intersectBezier2Rectangle=function(t,n,e,o,a){var s=o.min(a),u=o.max(a),c=new r(u.x,s.y),l=new r(s.x,u.y),h=i.intersectBezier2Line(t,n,e,s,c),f=i.intersectBezier2Line(t,n,e,c,u),p=i.intersectBezier2Line(t,n,e,u,l),y=i.intersectBezier2Line(t,n,e,l,s),d=new i("No Intersection");return d.appendPoints(h.points),d.appendPoints(f.points),d.appendPoints(p.points),d.appendPoints(y.points),d.points.length>0&&(d.status="Intersection"),d},i.intersectBezier3Bezier3=function(t,n,e,r,o,a,s,u){var c,l,h,f,p,y,d,g,v,x,m,b,w=new i("No Intersection");c=t.multiply(-1),l=n.multiply(3),h=e.multiply(-3),f=c.add(l.add(h.add(r))),p=new Vector2D(f.x,f.y),c=t.multiply(3),l=n.multiply(-6),h=e.multiply(3),f=c.add(l.add(h)),y=new Vector2D(f.x,f.y),c=t.multiply(-3),l=n.multiply(3),h=c.add(l),d=new Vector2D(h.x,h.y),g=new Vector2D(t.x,t.y),c=o.multiply(-1),l=a.multiply(3),h=s.multiply(-3),f=c.add(l.add(h.add(u))),v=new Vector2D(f.x,f.y),c=o.multiply(3),l=a.multiply(-6),h=s.multiply(3),f=c.add(l.add(h)),x=new Vector2D(f.x,f.y),c=o.multiply(-3),l=a.multiply(3),h=c.add(l),m=new Vector2D(h.x,h.y),b=new Vector2D(o.x,o.y);for(var _=g.x*g.x,M=g.x*g.x*g.x,S=g.y*g.y,k=g.y*g.y*g.y,E=d.x*d.x,A=d.x*d.x*d.x,L=d.y*d.y,N=d.y*d.y*d.y,C=y.x*y.x,P=y.x*y.x*y.x,T=y.y*y.y,I=y.y*y.y*y.y,z=p.x*p.x,D=p.x*p.x*p.x,O=p.y*p.y,q=p.y*p.y*p.y,R=b.x*b.x,j=b.x*b.x*b.x,G=b.y*b.y,V=b.y*b.y*b.y,B=m.x*m.x,F=m.x*m.x*m.x,H=m.y*m.y,U=x.x*x.x,X=x.x*x.x*x.x,Z=x.y*x.y,Y=v.x*v.x,K=v.x*v.x*v.x,W=v.y*v.y,$=v.y*v.y*v.y,J=new Polynomial(-D*$+q*K-3*p.x*O*Y*v.y+3*z*p.y*v.x*W,-6*p.x*x.x*O*v.x*v.y+6*z*p.y*x.y*v.x*v.y+3*x.x*q*Y-3*D*x.y*W-3*p.x*O*x.y*Y+3*z*x.x*p.y*W,-6*m.x*p.x*O*v.x*v.y-6*p.x*x.x*O*x.y*v.x+6*z*x.x*p.y*x.y*v.y+3*m.x*q*Y+3*U*q*v.x+3*m.x*z*p.y*W-3*p.x*m.y*O*Y-3*p.x*U*O*v.y+z*p.y*v.x*(6*m.y*v.y+3*Z)+D*(-m.y*W-2*Z*v.y-v.y*(2*m.y*v.y+Z)),d.x*y.y*p.x*p.y*v.x*v.y-d.y*y.x*p.x*p.y*v.x*v.y+6*m.x*x.x*q*v.x+3*d.x*y.x*p.x*p.y*W+6*g.x*p.x*O*v.x*v.y-3*d.x*y.x*O*v.x*v.y-3*d.y*y.y*p.x*p.y*Y-6*g.y*z*p.y*v.x*v.y-6*b.x*p.x*O*v.x*v.y+3*d.y*y.y*z*v.x*v.y-2*y.x*T*p.x*v.x*v.y-6*m.x*p.x*x.x*O*v.y-6*m.x*p.x*O*x.y*v.x-6*p.x*m.y*x.x*O*v.x+6*m.x*z*p.y*x.y*v.y+2*C*y.y*p.y*v.x*v.y+X*q-3*g.x*q*Y+3*g.y*D*W+3*b.x*q*Y+I*p.x*Y-P*p.y*W-3*g.x*z*p.y*W+3*g.y*p.x*O*Y-2*d.x*y.y*z*W+d.x*y.y*O*Y-d.y*y.x*z*W+2*d.y*y.x*O*Y+3*b.x*z*p.y*W-y.x*T*p.y*Y-3*b.y*p.x*O*Y+C*y.y*p.x*W-3*p.x*U*O*x.y+z*p.y*v.x*(6*b.y*v.y+6*m.y*x.y)+z*x.x*p.y*(6*m.y*v.y+3*Z)+D*(-2*m.y*x.y*v.y-b.y*W-x.y*(2*m.y*v.y+Z)-v.y*(2*b.y*v.y+2*m.y*x.y)),6*d.x*y.x*p.x*p.y*x.y*v.y+d.x*y.y*p.x*x.x*p.y*v.y+d.x*y.y*p.x*p.y*x.y*v.x-d.y*y.x*p.x*x.x*p.y*v.y-d.y*y.x*p.x*p.y*x.y*v.x-6*d.y*y.y*p.x*x.x*p.y*v.x-6*g.x*x.x*q*v.x+6*b.x*x.x*q*v.x+6*g.y*D*x.y*v.y+2*I*p.x*x.x*v.x-2*P*p.y*x.y*v.y+6*g.x*p.x*x.x*O*v.y+6*g.x*p.x*O*x.y*v.x+6*g.y*p.x*x.x*O*v.x-3*d.x*y.x*x.x*O*v.y-3*d.x*y.x*O*x.y*v.x+2*d.x*y.y*x.x*O*v.x+4*d.y*y.x*x.x*O*v.x-6*g.x*z*p.y*x.y*v.y-6*g.y*z*x.x*p.y*v.y-6*g.y*z*p.y*x.y*v.x-4*d.x*y.y*z*x.y*v.y-6*b.x*p.x*x.x*O*v.y-6*b.x*p.x*O*x.y*v.x-2*d.y*y.x*z*x.y*v.y+3*d.y*y.y*z*x.x*v.y+3*d.y*y.y*z*x.y*v.x-2*y.x*T*p.x*x.x*v.y-2*y.x*T*p.x*x.y*v.x-2*y.x*T*x.x*p.y*v.x-6*b.y*p.x*x.x*O*v.x-6*m.x*p.x*m.y*O*v.x-6*m.x*p.x*x.x*O*x.y+6*b.x*z*p.y*x.y*v.y+2*C*y.y*p.x*x.y*v.y+2*C*y.y*x.x*p.y*v.y+2*C*y.y*p.y*x.y*v.x+3*m.x*U*q+3*B*q*v.x-3*p.x*m.y*U*O-3*B*p.x*O*v.y+z*x.x*p.y*(6*b.y*v.y+6*m.y*x.y)+z*p.y*v.x*(6*b.y*x.y+3*H)+m.x*z*p.y*(6*m.y*v.y+3*Z)+D*(-2*b.y*x.y*v.y-v.y*(2*b.y*x.y+H)-m.y*(2*m.y*v.y+Z)-x.y*(2*b.y*v.y+2*m.y*x.y)),d.x*m.x*y.y*p.x*p.y*v.y+d.x*y.y*p.x*m.y*p.y*v.x+d.x*y.y*p.x*x.x*p.y*x.y-d.y*y.x*m.x*p.x*p.y*v.y-d.y*y.x*p.x*m.y*p.y*v.x-d.y*y.x*p.x*x.x*p.y*x.y-6*d.y*m.x*y.y*p.x*p.y*v.x-6*g.x*m.x*q*v.x+6*b.x*m.x*q*v.x+2*m.x*I*p.x*v.x+6*g.x*m.x*p.x*O*v.y+6*g.x*p.x*m.y*O*v.x+6*g.x*p.x*x.x*O*x.y+6*g.y*m.x*p.x*O*v.x-3*d.x*y.x*m.x*O*v.y-3*d.x*y.x*m.y*O*v.x-3*d.x*y.x*x.x*O*x.y+2*d.x*m.x*y.y*O*v.x+4*d.y*y.x*m.x*O*v.x-6*g.y*m.x*z*p.y*v.y-6*g.y*z*m.y*p.y*v.x-6*g.y*z*x.x*p.y*x.y-6*b.x*m.x*p.x*O*v.y-6*b.x*p.x*m.y*O*v.x-6*b.x*p.x*x.x*O*x.y+3*d.y*m.x*y.y*z*v.y-3*d.y*y.y*p.x*U*p.y+3*d.y*y.y*z*m.y*v.x+3*d.y*y.y*z*x.x*x.y-2*y.x*m.x*T*p.x*v.y-2*y.x*m.x*T*p.y*v.x-2*y.x*T*p.x*m.y*v.x-2*y.x*T*p.x*x.x*x.y-6*b.y*m.x*p.x*O*v.x-6*m.x*p.x*m.y*x.x*O+6*b.y*z*m.y*p.y*v.x+2*C*m.x*y.y*p.y*v.y+2*C*y.y*m.y*p.y*v.x+2*C*y.y*x.x*p.y*x.y-3*g.x*U*q+3*b.x*U*q+3*B*x.x*q+I*p.x*U+3*g.y*p.x*U*O+d.x*y.y*U*O+2*d.y*y.x*U*O-y.x*T*U*p.y-3*b.y*p.x*U*O-3*B*p.x*O*x.y+C*y.y*p.x*(2*m.y*v.y+Z)+d.x*y.x*p.x*p.y*(6*m.y*v.y+3*Z)+m.x*z*p.y*(6*b.y*v.y+6*m.y*x.y)+P*p.y*(-2*m.y*v.y-Z)+g.y*D*(6*m.y*v.y+3*Z)+d.y*y.x*z*(-2*m.y*v.y-Z)+d.x*y.y*z*(-4*m.y*v.y-2*Z)+g.x*z*p.y*(-6*m.y*v.y-3*Z)+z*x.x*p.y*(6*b.y*x.y+3*H)+b.x*z*p.y*(6*m.y*v.y+3*Z)+D*(-2*b.y*m.y*v.y-x.y*(2*b.y*x.y+H)-b.y*(2*m.y*v.y+Z)-m.y*(2*b.y*v.y+2*m.y*x.y)),-g.x*d.x*y.y*p.x*p.y*v.y+g.x*d.y*y.x*p.x*p.y*v.y+6*g.x*d.y*y.y*p.x*p.y*v.x-6*g.y*d.x*y.x*p.x*p.y*v.y-g.y*d.x*y.y*p.x*p.y*v.x+g.y*d.y*y.x*p.x*p.y*v.x+d.x*d.y*y.x*y.y*p.x*v.y-d.x*d.y*y.x*y.y*p.y*v.x+d.x*b.x*y.y*p.x*p.y*v.y+d.x*b.y*y.y*p.x*p.y*v.x+d.x*m.x*y.y*p.x*p.y*x.y+d.x*y.y*p.x*m.y*x.x*p.y-b.x*d.y*y.x*p.x*p.y*v.y-6*b.x*d.y*y.y*p.x*p.y*v.x-d.y*y.x*b.y*p.x*p.y*v.x-d.y*y.x*m.x*p.x*p.y*x.y-d.y*y.x*p.x*m.y*x.x*p.y-6*d.y*m.x*y.y*p.x*x.x*p.y-6*g.x*b.x*q*v.x-6*g.x*m.x*x.x*q-2*g.x*I*p.x*v.x+6*b.x*m.x*x.x*q+2*b.x*I*p.x*v.x+2*m.x*I*p.x*x.x+2*g.y*P*p.y*v.y-6*g.x*g.y*p.x*O*v.x+3*g.x*d.x*y.x*O*v.y-2*g.x*d.x*y.y*O*v.x-4*g.x*d.y*y.x*O*v.x+3*g.y*d.x*y.x*O*v.x+6*g.x*g.y*z*p.y*v.y+6*g.x*b.x*p.x*O*v.y-3*g.x*d.y*y.y*z*v.y+2*g.x*y.x*T*p.x*v.y+2*g.x*y.x*T*p.y*v.x+6*g.x*b.y*p.x*O*v.x+6*g.x*m.x*p.x*O*x.y+6*g.x*p.x*m.y*x.x*O+4*g.y*d.x*y.y*z*v.y+6*g.y*b.x*p.x*O*v.x+2*g.y*d.y*y.x*z*v.y-3*g.y*d.y*y.y*z*v.x+2*g.y*y.x*T*p.x*v.x+6*g.y*m.x*p.x*x.x*O-3*d.x*b.x*y.x*O*v.y+2*d.x*b.x*y.y*O*v.x+d.x*d.y*T*p.x*v.x-3*d.x*y.x*b.y*O*v.x-3*d.x*y.x*m.x*O*x.y-3*d.x*y.x*m.y*x.x*O+2*d.x*m.x*y.y*x.x*O+4*b.x*d.y*y.x*O*v.x+4*d.y*y.x*m.x*x.x*O-2*g.x*C*y.y*p.y*v.y-6*g.y*b.x*z*p.y*v.y-6*g.y*b.y*z*p.y*v.x-6*g.y*m.x*z*p.y*x.y-2*g.y*C*y.y*p.x*v.y-2*g.y*C*y.y*p.y*v.x-6*g.y*z*m.y*x.x*p.y-d.x*d.y*C*p.y*v.y-2*d.x*L*p.x*p.y*v.x+3*b.x*d.y*y.y*z*v.y-2*b.x*y.x*T*p.x*v.y-2*b.x*y.x*T*p.y*v.x-6*b.x*b.y*p.x*O*v.x-6*b.x*m.x*p.x*O*x.y-6*b.x*p.x*m.y*x.x*O+3*d.y*b.y*y.y*z*v.x+3*d.y*m.x*y.y*z*x.y+3*d.y*y.y*z*m.y*x.x-2*y.x*b.y*T*p.x*v.x-2*y.x*m.x*T*p.x*x.y-2*y.x*m.x*T*x.x*p.y-2*y.x*T*p.x*m.y*x.x-6*b.y*m.x*p.x*x.x*O-L*y.x*y.y*p.x*v.x+2*b.x*C*y.y*p.y*v.y+6*b.y*z*m.y*x.x*p.y+2*E*d.y*p.x*p.y*v.y+E*y.x*y.y*p.y*v.y+2*C*b.y*y.y*p.y*v.x+2*C*m.x*y.y*p.y*x.y+2*C*y.y*m.y*x.x*p.y+F*q+3*_*q*v.x-3*S*D*v.y+3*R*q*v.x+N*z*v.x-A*O*v.y-d.x*L*z*v.y+E*d.y*O*v.x-3*_*p.x*O*v.y+3*S*z*p.y*v.x-E*T*p.x*v.y+L*C*p.y*v.x-3*B*p.x*m.y*O-3*R*p.x*O*v.y+3*G*z*p.y*v.x+d.x*y.x*p.x*p.y*(6*b.y*v.y+6*m.y*x.y)+P*p.y*(-2*b.y*v.y-2*m.y*x.y)+g.y*D*(6*b.y*v.y+6*m.y*x.y)+d.y*y.x*z*(-2*b.y*v.y-2*m.y*x.y)+C*y.y*p.x*(2*b.y*v.y+2*m.y*x.y)+d.x*y.y*z*(-4*b.y*v.y-4*m.y*x.y)+g.x*z*p.y*(-6*b.y*v.y-6*m.y*x.y)+b.x*z*p.y*(6*b.y*v.y+6*m.y*x.y)+m.x*z*p.y*(6*b.y*x.y+3*H)+D*(-2*b.y*m.y*x.y-G*v.y-m.y*(2*b.y*x.y+H)-b.y*(2*b.y*v.y+2*m.y*x.y)),-g.x*d.x*y.y*p.x*p.y*x.y+g.x*d.y*y.x*p.x*p.y*x.y+6*g.x*d.y*y.y*p.x*x.x*p.y-6*g.y*d.x*y.x*p.x*p.y*x.y-g.y*d.x*y.y*p.x*x.x*p.y+g.y*d.y*y.x*p.x*x.x*p.y+d.x*d.y*y.x*y.y*p.x*x.y-d.x*d.y*y.x*y.y*x.x*p.y+d.x*b.x*y.y*p.x*p.y*x.y+d.x*b.y*y.y*p.x*x.x*p.y+d.x*m.x*y.y*p.x*m.y*p.y-b.x*d.y*y.x*p.x*p.y*x.y-6*b.x*d.y*y.y*p.x*x.x*p.y-d.y*y.x*b.y*p.x*x.x*p.y-d.y*y.x*m.x*p.x*m.y*p.y-6*g.x*b.x*x.x*q-2*g.x*I*p.x*x.x+2*b.x*I*p.x*x.x+2*g.y*P*p.y*x.y-6*g.x*g.y*p.x*x.x*O+3*g.x*d.x*y.x*O*x.y-2*g.x*d.x*y.y*x.x*O-4*g.x*d.y*y.x*x.x*O+3*g.y*d.x*y.x*x.x*O+6*g.x*g.y*z*p.y*x.y+6*g.x*b.x*p.x*O*x.y-3*g.x*d.y*y.y*z*x.y+2*g.x*y.x*T*p.x*x.y+2*g.x*y.x*T*x.x*p.y+6*g.x*b.y*p.x*x.x*O+6*g.x*m.x*p.x*m.y*O+4*g.y*d.x*y.y*z*x.y+6*g.y*b.x*p.x*x.x*O+2*g.y*d.y*y.x*z*x.y-3*g.y*d.y*y.y*z*x.x+2*g.y*y.x*T*p.x*x.x-3*d.x*b.x*y.x*O*x.y+2*d.x*b.x*y.y*x.x*O+d.x*d.y*T*p.x*x.x-3*d.x*y.x*b.y*x.x*O-3*d.x*y.x*m.x*m.y*O+4*b.x*d.y*y.x*x.x*O-2*g.x*C*y.y*p.y*x.y-6*g.y*b.x*z*p.y*x.y-6*g.y*b.y*z*x.x*p.y-6*g.y*m.x*z*m.y*p.y-2*g.y*C*y.y*p.x*x.y-2*g.y*C*y.y*x.x*p.y-d.x*d.y*C*p.y*x.y-2*d.x*L*p.x*x.x*p.y+3*b.x*d.y*y.y*z*x.y-2*b.x*y.x*T*p.x*x.y-2*b.x*y.x*T*x.x*p.y-6*b.x*b.y*p.x*x.x*O-6*b.x*m.x*p.x*m.y*O+3*d.y*b.y*y.y*z*x.x+3*d.y*m.x*y.y*z*m.y-2*y.x*b.y*T*p.x*x.x-2*y.x*m.x*T*p.x*m.y-L*y.x*y.y*p.x*x.x+2*b.x*C*y.y*p.y*x.y-3*d.y*B*y.y*p.x*p.y+6*b.y*m.x*z*m.y*p.y+2*E*d.y*p.x*p.y*x.y+E*y.x*y.y*p.y*x.y+2*C*b.y*y.y*x.x*p.y+2*C*m.x*y.y*m.y*p.y-3*g.x*B*q+3*b.x*B*q+3*_*x.x*q-3*S*D*x.y+3*R*x.x*q+B*I*p.x+N*z*x.x-A*O*x.y+3*g.y*B*p.x*O-d.x*L*z*x.y+d.x*B*y.y*O+2*d.y*y.x*B*O+E*d.y*x.x*O-y.x*B*T*p.y-3*b.y*B*p.x*O-3*_*p.x*O*x.y+3*S*z*x.x*p.y-E*T*p.x*x.y+L*C*x.x*p.y-3*R*p.x*O*x.y+3*G*z*x.x*p.y+C*y.y*p.x*(2*b.y*x.y+H)+d.x*y.x*p.x*p.y*(6*b.y*x.y+3*H)+P*p.y*(-2*b.y*x.y-H)+g.y*D*(6*b.y*x.y+3*H)+d.y*y.x*z*(-2*b.y*x.y-H)+d.x*y.y*z*(-4*b.y*x.y-2*H)+g.x*z*p.y*(-6*b.y*x.y-3*H)+b.x*z*p.y*(6*b.y*x.y+3*H)+D*(-2*b.y*H-G*x.y-b.y*(2*b.y*x.y+H)),-g.x*d.x*y.y*p.x*m.y*p.y+g.x*d.y*y.x*p.x*m.y*p.y+6*g.x*d.y*m.x*y.y*p.x*p.y-6*g.y*d.x*y.x*p.x*m.y*p.y-g.y*d.x*m.x*y.y*p.x*p.y+g.y*d.y*y.x*m.x*p.x*p.y-d.x*d.y*y.x*m.x*y.y*p.y+d.x*d.y*y.x*y.y*p.x*m.y+d.x*b.x*y.y*p.x*m.y*p.y+6*d.x*y.x*b.y*p.x*m.y*p.y+d.x*b.y*m.x*y.y*p.x*p.y-b.x*d.y*y.x*p.x*m.y*p.y-6*b.x*d.y*m.x*y.y*p.x*p.y-d.y*y.x*b.y*m.x*p.x*p.y-6*g.x*b.x*m.x*q-2*g.x*m.x*I*p.x+6*g.y*b.y*D*m.y+2*b.x*m.x*I*p.x+2*g.y*P*m.y*p.y-2*P*b.y*m.y*p.y-6*g.x*g.y*m.x*p.x*O+3*g.x*d.x*y.x*m.y*O-2*g.x*d.x*m.x*y.y*O-4*g.x*d.y*y.x*m.x*O+3*g.y*d.x*y.x*m.x*O+6*g.x*g.y*z*m.y*p.y+6*g.x*b.x*p.x*m.y*O-3*g.x*d.y*y.y*z*m.y+2*g.x*y.x*m.x*T*p.y+2*g.x*y.x*T*p.x*m.y+6*g.x*b.y*m.x*p.x*O+4*g.y*d.x*y.y*z*m.y+6*g.y*b.x*m.x*p.x*O+2*g.y*d.y*y.x*z*m.y-3*g.y*d.y*m.x*y.y*z+2*g.y*y.x*m.x*T*p.x-3*d.x*b.x*y.x*m.y*O+2*d.x*b.x*m.x*y.y*O+d.x*d.y*m.x*T*p.x-3*d.x*y.x*b.y*m.x*O+4*b.x*d.y*y.x*m.x*O-6*g.x*b.y*z*m.y*p.y-2*g.x*C*y.y*m.y*p.y-6*g.y*b.x*z*m.y*p.y-6*g.y*b.y*m.x*z*p.y-2*g.y*C*m.x*y.y*p.y-2*g.y*C*y.y*p.x*m.y-d.x*d.y*C*m.y*p.y-4*d.x*b.y*y.y*z*m.y-2*d.x*L*m.x*p.x*p.y+3*b.x*d.y*y.y*z*m.y-2*b.x*y.x*m.x*T*p.y-2*b.x*y.x*T*p.x*m.y-6*b.x*b.y*m.x*p.x*O-2*d.y*y.x*b.y*z*m.y+3*d.y*b.y*m.x*y.y*z-2*y.x*b.y*m.x*T*p.x-L*y.x*m.x*y.y*p.x+6*b.x*b.y*z*m.y*p.y+2*b.x*C*y.y*m.y*p.y+2*E*d.y*p.x*m.y*p.y+E*y.x*y.y*m.y*p.y+2*C*b.y*m.x*y.y*p.y+2*C*b.y*y.y*p.x*m.y+3*_*m.x*q-3*S*D*m.y+3*R*m.x*q+N*m.x*z-A*m.y*O-3*G*D*m.y-d.x*L*z*m.y+E*d.y*m.x*O-3*_*p.x*m.y*O+3*S*m.x*z*p.y-E*T*p.x*m.y+L*C*m.x*p.y-3*R*p.x*m.y*O+3*G*m.x*z*p.y,g.x*g.y*d.x*y.y*p.x*p.y-g.x*g.y*d.y*y.x*p.x*p.y+g.x*d.x*d.y*y.x*y.y*p.y-g.y*d.x*d.y*y.x*y.y*p.x-g.x*d.x*b.y*y.y*p.x*p.y+6*g.x*b.x*d.y*y.y*p.x*p.y+g.x*d.y*y.x*b.y*p.x*p.y-g.y*d.x*b.x*y.y*p.x*p.y-6*g.y*d.x*y.x*b.y*p.x*p.y+g.y*b.x*d.y*y.x*p.x*p.y-d.x*b.x*d.y*y.x*y.y*p.y+d.x*d.y*y.x*b.y*y.y*p.x+d.x*b.x*b.y*y.y*p.x*p.y-b.x*d.y*y.x*b.y*p.x*p.y-2*g.x*b.x*I*p.x+2*g.y*P*b.y*p.y-3*g.x*g.y*d.x*y.x*O-6*g.x*g.y*b.x*p.x*O+3*g.x*g.y*d.y*y.y*z-2*g.x*g.y*y.x*T*p.x-2*g.x*d.x*b.x*y.y*O-g.x*d.x*d.y*T*p.x+3*g.x*d.x*y.x*b.y*O-4*g.x*b.x*d.y*y.x*O+3*g.y*d.x*b.x*y.x*O+6*g.x*g.y*b.y*z*p.y+2*g.x*g.y*C*y.y*p.y+2*g.x*d.x*L*p.x*p.y+2*g.x*b.x*y.x*T*p.y+6*g.x*b.x*b.y*p.x*O-3*g.x*d.y*b.y*y.y*z+2*g.x*y.x*b.y*T*p.x+g.x*L*y.x*y.y*p.x+g.y*d.x*d.y*C*p.y+4*g.y*d.x*b.y*y.y*z-3*g.y*b.x*d.y*y.y*z+2*g.y*b.x*y.x*T*p.x+2*g.y*d.y*y.x*b.y*z+d.x*b.x*d.y*T*p.x-3*d.x*b.x*y.x*b.y*O-2*g.x*C*b.y*y.y*p.y-6*g.y*b.x*b.y*z*p.y-2*g.y*b.x*C*y.y*p.y-2*g.y*E*d.y*p.x*p.y-g.y*E*y.x*y.y*p.y-2*g.y*C*b.y*y.y*p.x-2*d.x*b.x*L*p.x*p.y-d.x*d.y*C*b.y*p.y+3*b.x*d.y*b.y*y.y*z-2*b.x*y.x*b.y*T*p.x-b.x*L*y.x*y.y*p.x+3*S*d.x*y.x*p.x*p.y+3*d.x*y.x*G*p.x*p.y+2*b.x*C*b.y*y.y*p.y-3*_*d.y*y.y*p.x*p.y+2*E*d.y*b.y*p.x*p.y+E*y.x*b.y*y.y*p.y-3*R*d.y*y.y*p.x*p.y-M*q+k*D+j*q-V*D-3*g.x*R*q-g.x*N*z+3*_*b.x*q+g.y*A*O+3*g.y*G*D+b.x*N*z+_*I*p.x-3*S*b.y*D-S*P*p.y+R*I*p.x-A*b.y*O-P*G*p.y-g.x*E*d.y*O+g.y*d.x*L*z-3*g.x*S*z*p.y-g.x*L*C*p.y+g.y*E*T*p.x-d.x*L*b.y*z+3*_*g.y*p.x*O+_*d.x*y.y*O+2*_*d.y*y.x*O-2*S*d.x*y.y*z-S*d.y*y.x*z+E*b.x*d.y*O-3*g.x*G*z*p.y+3*g.y*R*p.x*O+d.x*R*y.y*O-2*d.x*G*y.y*z+b.x*L*C*p.y-d.y*y.x*G*z-_*y.x*T*p.y-3*_*b.y*p.x*O+3*S*b.x*z*p.y+S*C*y.y*p.x-E*b.y*T*p.x+2*R*d.y*y.x*O+3*b.x*G*z*p.y-R*y.x*T*p.y-3*R*b.y*p.x*O+C*G*y.y*p.x).getRootsInInterval(0,1),Q=0;Q<J.length;Q++){var tt=J[Q],nt=new Polynomial(p.x,y.x,d.x,g.x-b.x-tt*m.x-tt*tt*x.x-tt*tt*tt*v.x).getRoots(),et=new Polynomial(p.y,y.y,d.y,g.y-b.y-tt*m.y-tt*tt*x.y-tt*tt*tt*v.y).getRoots();if(nt.length>0&&et.length>0){t:for(var rt=0;rt<nt.length;rt++){var it=nt[rt];if(0<=it&&it<=1)for(var ot=0;ot<et.length;ot++)if(Math.abs(it-et[ot])<1e-4){w.points.push(v.multiply(tt*tt*tt).add(x.multiply(tt*tt).add(m.multiply(tt).add(b))));break t}}}}return w.points.length>0&&(w.status="Intersection"),w},i.intersectBezier3Circle=function(t,n,e,r,o,a){return i.intersectBezier3Ellipse(t,n,e,r,o,a,a)},i.intersectBezier3Ellipse=function(t,n,e,r,o,a,s){var u,c,l,h,f,p,y,d,g=new i("No Intersection");u=t.multiply(-1),c=n.multiply(3),l=e.multiply(-3),h=u.add(c.add(l.add(r))),f=new Vector2D(h.x,h.y),u=t.multiply(3),c=n.multiply(-6),l=e.multiply(3),h=u.add(c.add(l)),p=new Vector2D(h.x,h.y),u=t.multiply(-3),c=n.multiply(3),l=u.add(c),y=new Vector2D(l.x,l.y),d=new Vector2D(t.x,t.y);for(var v=a*a,x=s*s,m=new Polynomial(f.x*f.x*x+f.y*f.y*v,2*(f.x*p.x*x+f.y*p.y*v),2*(f.x*y.x*x+f.y*y.y*v)+p.x*p.x*x+p.y*p.y*v,2*f.x*x*(d.x-o.x)+2*f.y*v*(d.y-o.y)+2*(p.x*y.x*x+p.y*y.y*v),2*p.x*x*(d.x-o.x)+2*p.y*v*(d.y-o.y)+y.x*y.x*x+y.y*y.y*v,2*y.x*x*(d.x-o.x)+2*y.y*v*(d.y-o.y),d.x*d.x*x-2*d.y*o.y*v-2*d.x*o.x*x+d.y*d.y*v+o.x*o.x*x+o.y*o.y*v-v*x).getRootsInInterval(0,1),b=0;b<m.length;b++){var w=m[b];g.points.push(f.multiply(w*w*w).add(p.multiply(w*w).add(y.multiply(w).add(d))))}return g.points.length>0&&(g.status="Intersection"),g},i.intersectBezier3Line=function(t,n,e,r,o,a){var s,u,c,l,h,f,p,y,d,g,v=o.min(a),x=o.max(a),m=new i("No Intersection");s=t.multiply(-1),u=n.multiply(3),c=e.multiply(-3),l=s.add(u.add(c.add(r))),h=new Vector2D(l.x,l.y),s=t.multiply(3),u=n.multiply(-6),c=e.multiply(3),l=s.add(u.add(c)),f=new Vector2D(l.x,l.y),s=t.multiply(-3),u=n.multiply(3),c=s.add(u),p=new Vector2D(c.x,c.y),y=new Vector2D(t.x,t.y),g=new Vector2D(o.y-a.y,a.x-o.x),d=o.x*a.y-a.x*o.y,roots=new Polynomial(g.dot(h),g.dot(f),g.dot(p),g.dot(y)+d).getRoots();for(var b=0;b<roots.length;b++){var w=roots[b];if(0<=w&&w<=1){var _=t.lerp(n,w),M=n.lerp(e,w),S=e.lerp(r,w),k=_.lerp(M,w),E=M.lerp(S,w),A=k.lerp(E,w);o.x==a.x?v.y<=A.y&&A.y<=x.y&&(m.status="Intersection",m.appendPoint(A)):o.y==a.y?v.x<=A.x&&A.x<=x.x&&(m.status="Intersection",m.appendPoint(A)):A.gte(v)&&A.lte(x)&&(m.status="Intersection",m.appendPoint(A))}}return m},i.intersectBezier3Polygon=function(t,n,e,r,o){for(var a=new i("No Intersection"),s=o.length,u=0;u<s;u++){var c=o[u],l=o[(u+1)%s],h=i.intersectBezier3Line(t,n,e,r,c,l);a.appendPoints(h.points)}return a.points.length>0&&(a.status="Intersection"),a},i.intersectBezier3Rectangle=function(t,n,e,o,a,s){var u=a.min(s),c=a.max(s),l=new r(c.x,u.y),h=new r(u.x,c.y),f=i.intersectBezier3Line(t,n,e,o,u,l),p=i.intersectBezier3Line(t,n,e,o,l,c),y=i.intersectBezier3Line(t,n,e,o,c,h),d=i.intersectBezier3Line(t,n,e,o,h,u),g=new i("No Intersection");return g.appendPoints(f.points),g.appendPoints(p.points),g.appendPoints(y.points),g.appendPoints(d.points),g.points.length>0&&(g.status="Intersection"),g},i.intersectCircleCircle=function(t,n,e,o){var a,s=n+o,u=Math.abs(n-o),c=t.distanceFrom(e);if(c>s)a=new i("Outside");else if(c<u)a=new i("Inside");else{a=new i("Intersection");var l=(n*n-o*o+c*c)/(2*c),h=Math.sqrt(n*n-l*l),f=t.lerp(e,l/c),p=h/c;a.points.push(new r(f.x-p*(e.y-t.y),f.y+p*(e.x-t.x))),a.points.push(new r(f.x+p*(e.y-t.y),f.y-p*(e.x-t.x)))}return a},i.intersectCircleEllipse=function(t,n,e,r,o){return i.intersectEllipseEllipse(t,n,n,e,r,o)},i.intersectCircleLine=function(t,n,e,r){var o,a=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),s=2*((r.x-e.x)*(e.x-t.x)+(r.y-e.y)*(e.y-t.y)),u=s*s-4*a*(t.x*t.x+t.y*t.y+e.x*e.x+e.y*e.y-2*(t.x*e.x+t.y*e.y)-n*n);if(u<0)o=new i("Outside");else if(0==u)o=new i("Tangent");else{var c=Math.sqrt(u),l=(-s+c)/(2*a),h=(-s-c)/(2*a);(l<0||l>1)&&(h<0||h>1)?o=new i(l<0&&h<0||l>1&&h>1?"Outside":"Inside"):(o=new i("Intersection"),0<=l&&l<=1&&o.points.push(e.lerp(r,l)),0<=h&&h<=1&&o.points.push(e.lerp(r,h)))}return o},i.intersectCirclePolygon=function(t,n,e){for(var r,o=new i("No Intersection"),a=e.length,s=0;s<a;s++){var u=e[s],c=e[(s+1)%a];r=i.intersectCircleLine(t,n,u,c),o.appendPoints(r.points)}return o.points.length>0?o.status="Intersection":o.status=r.status,o},i.intersectCircleRectangle=function(t,n,e,o){var a=e.min(o),s=e.max(o),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectCircleLine(t,n,a,u),h=i.intersectCircleLine(t,n,u,s),f=i.intersectCircleLine(t,n,s,c),p=i.intersectCircleLine(t,n,c,a),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(h.points),y.appendPoints(f.points),y.appendPoints(p.points),y.points.length>0?y.status="Intersection":y.status=l.status,y},i.intersectEllipseEllipse=function(t,n,e,o,a,s){for(var u=[e*e,0,n*n,-2*e*e*t.x,-2*n*n*t.y,e*e*t.x*t.x+n*n*t.y*t.y-n*n*e*e],c=[s*s,0,a*a,-2*s*s*o.x,-2*a*a*o.y,s*s*o.x*o.x+a*a*o.y*o.y-a*a*s*s],l=i.bezout(u,c).getRoots(),h=.001*(u[0]*u[0]+2*u[1]*u[1]+u[2]*u[2]),f=.001*(c[0]*c[0]+2*c[1]*c[1]+c[2]*c[2]),p=new i("No Intersection"),y=0;y<l.length;y++)for(var d=new Polynomial(u[0],u[3]+l[y]*u[1],u[5]+l[y]*(u[4]+l[y]*u[2])).getRoots(),g=0;g<d.length;g++){var v=(u[0]*d[g]+u[1]*l[y]+u[3])*d[g]+(u[2]*l[y]+u[4])*l[y]+u[5];Math.abs(v)<h&&(v=(c[0]*d[g]+c[1]*l[y]+c[3])*d[g]+(c[2]*l[y]+c[4])*l[y]+c[5],Math.abs(v)<f&&p.appendPoint(new r(d[g],l[y])))}return p.points.length>0&&(p.status="Intersection"),p},i.intersectEllipseLine=function(t,n,e,r,o){var a,s=new Vector2D(r.x,r.y),u=Vector2D.fromPoints(r,o),c=new Vector2D(t.x,t.y),l=s.subtract(c),h=new Vector2D(u.x/(n*n),u.y/(e*e)),f=new Vector2D(l.x/(n*n),l.y/(e*e)),p=u.dot(h),y=u.dot(f),d=y*y-p*(t=l.dot(f)-1);if(d<0)a=new i("Outside");else if(d>0){var g=Math.sqrt(d),v=(-y-g)/p,x=(-y+g)/p;(v<0||1<v)&&(x<0||1<x)?a=new i(v<0&&x<0||v>1&&x>1?"Outside":"Inside"):(a=new i("Intersection"),0<=v&&v<=1&&a.appendPoint(r.lerp(o,v)),0<=x&&x<=1&&a.appendPoint(r.lerp(o,x)))}else{var m=-y/p;0<=m&&m<=1?(a=new i("Intersection")).appendPoint(r.lerp(o,m)):a=new i("Outside")}return a},i.intersectEllipsePolygon=function(t,n,e,r){for(var o=new i("No Intersection"),a=r.length,s=0;s<a;s++){var u=r[s],c=r[(s+1)%a],l=i.intersectEllipseLine(t,n,e,u,c);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},i.intersectEllipseRectangle=function(t,n,e,o,a){var s=o.min(a),u=o.max(a),c=new r(u.x,s.y),l=new r(s.x,u.y),h=i.intersectEllipseLine(t,n,e,s,c),f=i.intersectEllipseLine(t,n,e,c,u),p=i.intersectEllipseLine(t,n,e,u,l),y=i.intersectEllipseLine(t,n,e,l,s),d=new i("No Intersection");return d.appendPoints(h.points),d.appendPoints(f.points),d.appendPoints(p.points),d.appendPoints(y.points),d.points.length>0&&(d.status="Intersection"),d},i.intersectLineLine=function(t,n,e,o){var a,s=(o.x-e.x)*(t.y-e.y)-(o.y-e.y)*(t.x-e.x),u=(n.x-t.x)*(t.y-e.y)-(n.y-t.y)*(t.x-e.x),c=(o.y-e.y)*(n.x-t.x)-(o.x-e.x)*(n.y-t.y);if(0!=c){var l=s/c,h=u/c;0<=l&&l<=1&&0<=h&&h<=1?(a=new i("Intersection")).points.push(new r(t.x+l*(n.x-t.x),t.y+l*(n.y-t.y))):a=new i("No Intersection")}else a=new i(0==s||0==u?"Coincident":"Parallel");return a},i.intersectLinePolygon=function(t,n,e){for(var r=new i("No Intersection"),o=e.length,a=0;a<o;a++){var s=e[a],u=e[(a+1)%o],c=i.intersectLineLine(t,n,s,u);r.appendPoints(c.points)}return r.points.length>0&&(r.status="Intersection"),r},i.intersectLineRectangle=function(t,n,e,o){var a=e.min(o),s=e.max(o),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectLineLine(a,u,t,n),h=i.intersectLineLine(u,s,t,n),f=i.intersectLineLine(s,c,t,n),p=i.intersectLineLine(c,a,t,n),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(h.points),y.appendPoints(f.points),y.appendPoints(p.points),y.points.length>0&&(y.status="Intersection"),y},i.intersectPolygonPolygon=function(t,n){for(var e=new i("No Intersection"),r=t.length,o=0;o<r;o++){var a=t[o],s=t[(o+1)%r],u=i.intersectLinePolygon(a,s,n);e.appendPoints(u.points)}return e.points.length>0&&(e.status="Intersection"),e},i.intersectPolygonRectangle=function(t,n,e){var o=n.min(e),a=n.max(e),s=new r(a.x,o.y),u=new r(o.x,a.y),c=i.intersectLinePolygon(o,s,t),l=i.intersectLinePolygon(s,a,t),h=i.intersectLinePolygon(a,u,t),f=i.intersectLinePolygon(u,o,t),p=new i("No Intersection");return p.appendPoints(c.points),p.appendPoints(l.points),p.appendPoints(h.points),p.appendPoints(f.points),p.points.length>0&&(p.status="Intersection"),p},i.intersectRayRay=function(t,n,e,o){var a,s=(o.x-e.x)*(t.y-e.y)-(o.y-e.y)*(t.x-e.x),u=(n.x-t.x)*(t.y-e.y)-(n.y-t.y)*(t.x-e.x),c=(o.y-e.y)*(n.x-t.x)-(o.x-e.x)*(n.y-t.y);if(0!=c){var l=s/c;(a=new i("Intersection")).points.push(new r(t.x+l*(n.x-t.x),t.y+l*(n.y-t.y)))}else a=new i(0==s||0==u?"Coincident":"Parallel");return a},i.intersectRectangleRectangle=function(t,n,e,o){var a=t.min(n),s=t.max(n),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectLineRectangle(a,u,e,o),h=i.intersectLineRectangle(u,s,e,o),f=i.intersectLineRectangle(s,c,e,o),p=i.intersectLineRectangle(c,a,e,o),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(h.points),y.appendPoints(f.points),y.appendPoints(p.points),y.points.length>0&&(y.status="Intersection"),y},i.bezout=function(t,n){var e=t[0]*n[1]-n[0]*t[1],r=t[0]*n[2]-n[0]*t[2],i=t[0]*n[3]-n[0]*t[3],o=t[0]*n[4]-n[0]*t[4],a=t[0]*n[5]-n[0]*t[5],s=t[1]*n[2]-n[1]*t[2],u=t[1]*n[4]-n[1]*t[4],c=t[1]*n[5]-n[1]*t[5],l=t[2]*n[3]-n[2]*t[3],h=t[3]*n[4]-n[3]*t[4],f=t[3]*n[5]-n[3]*t[5],p=c+h,y=u-l;return new Polynomial(e*s-r*r,e*y+i*s-2*r*o,e*p+i*y-o*o-2*r*a,e*f+i*p-2*o*a,i*f-a*a)},t.exports=i},function(t){t.exports=JSON.parse('{"a":"2.0.1"}')},function(t,n,e){var r,i,o,a;function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}a=function(){return function t(n,e,r){function i(a,s){if(!e[a]){if(!n[a]){if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[a]={exports:{}};n[a][0].call(c.exports,(function(t){return i(n[a][1][t]||t)}),c,c.exports,t,n,e,r)}return e[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,n,e){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(t("./src/adaptor")),r(t("./src/d3adaptor")),r(t("./src/descent")),r(t("./src/geom")),r(t("./src/gridrouter")),r(t("./src/handledisconnected")),r(t("./src/layout")),r(t("./src/layout3d")),r(t("./src/linklengths")),r(t("./src/powergraph")),r(t("./src/pqueue")),r(t("./src/rbtree")),r(t("./src/rectangle")),r(t("./src/shortestpaths")),r(t("./src/vpsc")),r(t("./src/batch"))},{"./src/adaptor":2,"./src/batch":3,"./src/d3adaptor":4,"./src/descent":7,"./src/geom":8,"./src/gridrouter":9,"./src/handledisconnected":10,"./src/layout":11,"./src/layout3d":12,"./src/linklengths":13,"./src/powergraph":14,"./src/pqueue":15,"./src/rbtree":16,"./src/rectangle":17,"./src/shortestpaths":18,"./src/vpsc":19}],2:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(n){var e=t.call(this)||this,r=n;return r.trigger&&(e.trigger=r.trigger),r.kick&&(e.kick=r.kick),r.drag&&(e.drag=r.drag),r.on&&(e.on=r.on),e.dragstart=e.dragStart=o.Layout.dragStart,e.dragend=e.dragEnd=o.Layout.dragEnd,e}return i(n,t),n.prototype.trigger=function(t){},n.prototype.kick=function(){},n.prototype.drag=function(){},n.prototype.on=function(t,n){return this},n}(o.Layout);e.LayoutAdaptor=a,e.adaptor=function(t){return new a(t)}},{"./layout":11}],3:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./layout"),i=t("./gridrouter");e.gridify=function(t,n,e,r){return t.cola.start(0,0,0,10,!1),function(t,n,e,r){t.forEach((function(t){t.routerNode={name:t.name,bounds:t.bounds.inflate(-e)}})),n.forEach((function(n){n.routerNode={bounds:n.bounds.inflate(-r),children:(void 0!==n.groups?n.groups.map((function(n){return t.length+n.id})):[]).concat(void 0!==n.leaves?n.leaves.map((function(t){return t.index})):[])}}));var o=t.concat(n).map((function(t,n){return t.routerNode.id=n,t.routerNode}));return new i.GridRouter(o,{getChildren:function(t){return t.children},getBounds:function(t){return t.bounds}},e-r)}(t.cola.nodes(),t.cola.groups(),e,r).routeEdges(t.powerGraph.powerEdges,n,(function(t){return t.source.routerNode.id}),(function(t){return t.target.routerNode.id}))},e.powerGraphGridLayout=function(t,n,e){var i;t.nodes.forEach((function(t,n){return t.index=n})),(new r.Layout).avoidOverlaps(!1).nodes(t.nodes).links(t.links).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){return t.padding=e}))}));var o=t.nodes.length,a=[],s=t.nodes.slice(0);return s.forEach((function(t,n){return t.index=n})),i.groups.forEach((function(t){var n=t.index=t.id+o;s.push(t),void 0!==t.leaves&&t.leaves.forEach((function(t){return a.push({source:n,target:t.index})})),void 0!==t.groups&&t.groups.forEach((function(t){return a.push({source:n,target:t.id+o})}))})),i.powerEdges.forEach((function(t){a.push({source:t.source.index,target:t.target.index})})),(new r.Layout).size(n).nodes(s).links(a).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new r.Layout).convergenceThreshold(.001).size(n).avoidOverlaps(!0).nodes(t.nodes).links(t.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){t.padding=e}))})).start(50,0,100,0,!1),powerGraph:i}}},{"./gridrouter":9,"./layout":11}],4:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./d3v3adaptor"),i=t("./d3v4adaptor");e.d3adaptor=function(t){return!t||function(t){return t.version&&null!==t.version.match(/^3\./)}(t)?new r.D3StyleLayoutAdaptor:new i.D3StyleLayoutAdaptor(t)}},{"./d3v3adaptor":5,"./d3v4adaptor":6}],5:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(){var n=t.call(this)||this;n.event=d3.dispatch(o.EventType[o.EventType.start],o.EventType[o.EventType.tick],o.EventType[o.EventType.end]);var e=n;return n.drag=function(){if(!t)var t=d3.behavior.drag().origin(o.Layout.dragOrigin).on("dragstart.d3adaptor",o.Layout.dragStart).on("drag.d3adaptor",(function(t){o.Layout.drag(t,d3.event),e.resume()})).on("dragend.d3adaptor",o.Layout.dragEnd);if(!arguments.length)return t;this.call(t)},n}return i(n,t),n.prototype.trigger=function(t){var n={type:o.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event[n.type](n)},n.prototype.kick=function(){var n=this;d3.timer((function(){return t.prototype.tick.call(n)}))},n.prototype.on=function(t,n){return"string"==typeof t?this.event.on(t,n):this.event.on(o.EventType[t],n),this},n}(o.Layout);e.D3StyleLayoutAdaptor=a,e.d3adaptor=function(){return new a}},{"./layout":11}],6:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(n){var e=t.call(this)||this;e.d3Context=n,e.event=n.dispatch(o.EventType[o.EventType.start],o.EventType[o.EventType.tick],o.EventType[o.EventType.end]);var r=e;return e.drag=function(){if(!t)var t=n.drag().subject(o.Layout.dragOrigin).on("start.d3adaptor",o.Layout.dragStart).on("drag.d3adaptor",(function(t){o.Layout.drag(t,n.event),r.resume()})).on("end.d3adaptor",o.Layout.dragEnd);if(!arguments.length)return t;arguments[0].call(t)},e}return i(n,t),n.prototype.trigger=function(t){var n={type:o.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event.call(n.type,n)},n.prototype.kick=function(){var n=this,e=this.d3Context.timer((function(){return t.prototype.tick.call(n)&&e.stop()}))},n.prototype.on=function(t,n){return"string"==typeof t?this.event.on(t,n):this.event.on(o.EventType[t],n),this},n}(o.Layout);e.D3StyleLayoutAdaptor=a},{"./layout":11}],7:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.locks={}}return t.prototype.add=function(t,n){this.locks[t]=n},t.prototype.clear=function(){this.locks={}},t.prototype.isEmpty=function(){for(var t in this.locks)return!1;return!0},t.prototype.apply=function(t){for(var n in this.locks)t(Number(n),this.locks[n])},t}();e.Locks=r;var i=function(){function t(t,n,e){void 0===e&&(e=null),this.D=n,this.G=e,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new o,this.project=null,this.x=t,this.k=t.length;var i=this.n=t[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new r,this.minD=Number.MAX_VALUE;for(var a,s=i;s--;)for(a=i;--a>s;){var u=n[s][a];u>0&&u<this.minD&&(this.minD=u)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),s=this.k;s--;){for(this.g[s]=new Array(i),this.H[s]=new Array(i),a=i;a--;)this.H[s][a]=new Array(i);this.Hd[s]=new Array(i),this.a[s]=new Array(i),this.b[s]=new Array(i),this.c[s]=new Array(i),this.d[s]=new Array(i),this.e[s]=new Array(i),this.ia[s]=new Array(i),this.ib[s]=new Array(i),this.xtmp[s]=new Array(i)}}return t.createSquareMatrix=function(t,n){for(var e=new Array(t),r=0;r<t;++r){e[r]=new Array(t);for(var i=0;i<t;++i)e[r][i]=n(r,i)}return e},t.prototype.offsetDir=function(){for(var t=this,n=new Array(this.k),e=0,r=0;r<this.k;++r){var i=n[r]=this.random.getNextBetween(.01,1)-.5;e+=i*i}return e=Math.sqrt(e),n.map((function(n){return n*(t.minD/e)}))},t.prototype.computeDerivatives=function(t){var n=this,e=this.n;if(!(e<1)){for(var r,i=new Array(this.k),o=new Array(this.k),a=new Array(this.k),s=0,u=0;u<e;++u){for(r=0;r<this.k;++r)a[r]=this.g[r][u]=0;for(var c=0;c<e;++c)if(u!==c){for(var l=e,h=0;l--;){for(h=0,r=0;r<this.k;++r){var f=i[r]=t[r][u]-t[r][c];h+=o[r]=f*f}if(h>1e-9)break;var p=this.offsetDir();for(r=0;r<this.k;++r)t[r][c]+=p[r]}var y=Math.sqrt(h),d=this.D[u][c],g=null!=this.G?this.G[u][c]:1;if(g>1&&y>d||!isFinite(d))for(r=0;r<this.k;++r)this.H[r][u][c]=0;else{g>1&&(g=1);var v=d*d,x=2*g*(y-d)/(v*y),m=h*y,b=2*-g/(v*m);for(isFinite(x)||console.log(x),r=0;r<this.k;++r)this.g[r][u]+=i[r]*x,a[r]-=this.H[r][u][c]=b*(2*m+d*(o[r]-h))}}for(r=0;r<this.k;++r)s=Math.max(s,this.H[r][u][u]=a[r])}for(var w=this.snapGridSize/2,_=this.snapGridSize,M=this.snapStrength/(w*w),S=this.numGridSnapNodes,k=0;k<S;++k)for(r=0;r<this.k;++r){var E=this.x[r][k],A=E/_,L=A%1,N=A-L,C=Math.abs(L)<=.5?E-N*_:E>0?E-(N+1)*_:E-(N-1)*_;-w<C&&C<=w&&(this.scaleSnapByMaxH?(this.g[r][k]+=s*M*C,this.H[r][k][k]+=s*M):(this.g[r][k]+=M*C,this.H[r][k][k]+=M))}this.locks.isEmpty()||this.locks.apply((function(e,i){for(r=0;r<n.k;++r)n.H[r][e][e]+=s,n.g[r][e]-=s*(i[r]-t[r][e])}))}},t.dotProd=function(t,n){for(var e=0,r=t.length;r--;)e+=t[r]*n[r];return e},t.rightMultiply=function(n,e,r){for(var i=n.length;i--;)r[i]=t.dotProd(n[i],e)},t.prototype.computeStepSize=function(n){for(var e=0,r=0,i=0;i<this.k;++i)e+=t.dotProd(this.g[i],n[i]),t.rightMultiply(this.H[i],n[i],this.Hd[i]),r+=t.dotProd(n[i],this.Hd[i]);return 0!==r&&isFinite(r)?1*e/r:0},t.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var t=this.computeStepSize(this.g),n=0;n<this.k;++n)this.takeDescentStep(this.x[n],this.g[n],t);return this.computeStress()},t.copy=function(t,n){for(var e=t.length,r=n[0].length,i=0;i<e;++i)for(var o=0;o<r;++o)n[i][o]=t[i][o]},t.prototype.stepAndProject=function(n,e,r,i){t.copy(n,e),this.takeDescentStep(e[0],r[0],i),this.project&&this.project[0](n[0],n[1],e[0]),this.takeDescentStep(e[1],r[1],i),this.project&&this.project[1](e[0],n[1],e[1]);for(var o=2;o<this.k;o++)this.takeDescentStep(e[o],r[o],i)},t.mApply=function(t,n,e){for(var r=t;r-- >0;)for(var i=n;i-- >0;)e(r,i)},t.prototype.matrixApply=function(n){t.mApply(this.k,this.n,n)},t.prototype.computeNextPosition=function(t,n){var e=this;this.computeDerivatives(t);var r=this.computeStepSize(this.g);if(this.stepAndProject(t,n,this.g,r),this.project){this.matrixApply((function(r,i){return e.e[r][i]=t[r][i]-n[r][i]}));var i=this.computeStepSize(this.e);i=Math.max(.2,Math.min(i,1)),this.stepAndProject(t,n,this.e,i)}},t.prototype.run=function(t){for(var n=Number.MAX_VALUE,e=!1;!e&&t-- >0;){var r=this.rungeKutta();e=Math.abs(n/r-1)<this.threshold,n=r}return n},t.prototype.rungeKutta=function(){var n=this;this.computeNextPosition(this.x,this.a),t.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),t.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var e=0;return this.matrixApply((function(t,r){var i=(n.a[t][r]+2*n.b[t][r]+2*n.c[t][r]+n.d[t][r])/6,o=n.x[t][r]-i;e+=o*o,n.x[t][r]=i})),e},t.mid=function(n,e,r){t.mApply(n.length,n[0].length,(function(t,i){return r[t][i]=n[t][i]+(e[t][i]-n[t][i])/2}))},t.prototype.takeDescentStep=function(t,n,e){for(var r=0;r<this.n;++r)t[r]=t[r]-e*n[r]},t.prototype.computeStress=function(){for(var t=0,n=0,e=this.n-1;n<e;++n)for(var r=n+1,i=this.n;r<i;++r){for(var o=0,a=0;a<this.k;++a){var s=this.x[a][n]-this.x[a][r];o+=s*s}o=Math.sqrt(o);var u=this.D[n][r];if(isFinite(u)){var c=u-o;t+=c*c/(u*u)}}return t},t.zeroDistance=1e-10,t}();e.Descent=i;var o=function(){function t(t){void 0===t&&(t=1),this.seed=t,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return t.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},t.prototype.getNextBetween=function(t,n){return t+this.getNext()*(n-t)},t}();e.PseudoRandom=o},{}],8:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./rectangle"),a=function(){};e.Point=a;var s=function(t,n,e,r){this.x1=t,this.y1=n,this.x2=e,this.y2=r};e.LineSegment=s;var u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(a);function c(t,n,e){return(n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y)}function l(t,n,e){return c(t,n,e)>0}function h(t,n,e){return c(t,n,e)<0}function f(t,n){var e,r,i,o,a=n.length-1;if(h(t,n[1],n[0])&&!l(t,n[a-1],n[0]))return 0;for(e=0,r=a;;){if(r-e==1)return l(t,n[e],n[r])?e:r;if((o=h(t,n[(i=Math.floor((e+r)/2))+1],n[i]))&&!l(t,n[i-1],n[i]))return i;l(t,n[e+1],n[e])?o||l(t,n[e],n[i])?r=i:e=i:o&&h(t,n[e],n[i])?r=i:e=i}}function p(t,n){var e,r,i,o,a=n.length-1;if(l(t,n[a-1],n[0])&&!h(t,n[1],n[0]))return 0;for(e=0,r=a;;){if(r-e==1)return h(t,n[e],n[r])?e:r;if(o=h(t,n[(i=Math.floor((e+r)/2))+1],n[i]),l(t,n[i-1],n[i])&&!o)return i;h(t,n[e+1],n[e])?o?h(t,n[e],n[i])?r=i:e=i:r=i:o?e=i:l(t,n[e],n[i])?r=i:e=i}}function y(t,n,e,r,i,o){var a,s;s=r(t[a=e(n[0],t)],n);for(var u=!1;!u;){for(u=!0;a===t.length-1&&(a=0),!i(n[s],t[a],t[a+1]);)++a;for(;0===s&&(s=n.length-1),!o(t[a],n[s],n[s-1]);)--s,u=!1}return{t1:a,t2:s}}function d(t,n){return y(t,n,f,p,l,h)}e.PolyPoint=u,e.isLeft=c,e.ConvexHull=function(t){var n,e=t.slice(0).sort((function(t,n){return t.x!==n.x?n.x-t.x:n.y-t.y})),r=t.length,i=e[0].x;for(n=1;n<r&&e[n].x===i;++n);var o=n-1,a=[];if(a.push(e[0]),o===r-1)e[o].y!==e[0].y&&a.push(e[o]);else{var s,u=r-1,l=e[r-1].x;for(n=r-2;n>=0&&e[n].x===l;n--);for(s=n+1,n=o;++n<=s;)if(!(c(e[0],e[s],e[n])>=0&&n<s)){for(;a.length>1&&!(c(a[a.length-2],a[a.length-1],e[n])>0);)a.length-=1;0!=n&&a.push(e[n])}u!=s&&a.push(e[u]);var h=a.length;for(n=s;--n>=o;)if(!(c(e[u],e[o],e[n])>=0&&n>o)){for(;a.length>h&&!(c(a[a.length-2],a[a.length-1],e[n])>0);)a.length-=1;0!=n&&a.push(e[n])}}return a},e.clockwiseRadialSweep=function(t,n,e){n.slice(0).sort((function(n,e){return Math.atan2(n.y-t.y,n.x-t.x)-Math.atan2(e.y-t.y,e.x-t.x)})).forEach(e)},e.tangent_PolyPolyC=y,e.LRtangent_PolyPolyC=function(t,n){var e=d(n,t);return{t1:e.t2,t2:e.t1}},e.RLtangent_PolyPolyC=d,e.LLtangent_PolyPolyC=function(t,n){return y(t,n,p,p,h,h)},e.RRtangent_PolyPolyC=function(t,n){return y(t,n,f,f,l,l)};var g=function(t,n){this.t1=t,this.t2=n};e.BiTangent=g;var v=function(){};e.BiTangents=v;var x=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(a);e.TVGPoint=x;var m=function(t,n,e,r){this.id=t,this.polyid=n,this.polyvertid=e,this.p=r,r.vv=this};e.VisibilityVertex=m;var b=function(){function t(t,n){this.source=t,this.target=n}return t.prototype.length=function(){var t=this.source.p.x-this.target.p.x,n=this.source.p.y-this.target.p.y;return Math.sqrt(t*t+n*n)},t}();e.VisibilityEdge=b;var w=function(){function t(t,n){if(this.P=t,this.V=[],this.E=[],n)this.V=n.V.slice(0),this.E=n.E.slice(0);else{for(var e=t.length,r=0;r<e;r++){for(var i=t[r],o=0;o<i.length;++o){var a=i[o],s=new m(this.V.length,r,o,a);this.V.push(s),o>0&&this.E.push(new b(i[o-1].vv,s))}i.length>1&&this.E.push(new b(i[0].vv,i[i.length-1].vv))}for(r=0;r<e-1;r++){var u=t[r];for(o=r+1;o<e;o++){var c=t[o],l=M(u,c);for(var h in l){var f=l[h],p=u[f.t1],y=c[f.t2];this.addEdgeIfVisible(p,y,r,o)}}}}}return t.prototype.addEdgeIfVisible=function(t,n,e,r){this.intersectsPolys(new s(t.x,t.y,n.x,n.y),e,r)||this.E.push(new b(t.vv,n.vv))},t.prototype.addPoint=function(t,n){var e,r,i,o=this.P.length;this.V.push(new m(this.V.length,o,0,t));for(var a=0;a<o;++a)if(a!==n){var s=this.P[a],u=(e=t,i=void 0,(i=(r=s).slice(0)).push(r[0]),{rtan:f(e,i),ltan:p(e,i)});this.addEdgeIfVisible(t,s[u.ltan],n,a),this.addEdgeIfVisible(t,s[u.rtan],n,a)}return t.vv},t.prototype.intersectsPolys=function(t,n,e){for(var r=0,i=this.P.length;r<i;++r)if(r!=n&&r!=e&&_(t,this.P[r]).length>0)return!0;return!1},t}();function _(t,n){for(var e=[],r=1,i=n.length;r<i;++r){var a=o.Rectangle.lineIntersection(t.x1,t.y1,t.x2,t.y2,n[r-1].x,n[r-1].y,n[r].x,n[r].y);a&&e.push(a)}return e}function M(t,n){for(var e=t.length-1,r=n.length-1,i=new v,o=0;o<=e;++o)for(var a=0;a<=r;++a){var s=t[0==o?e:o-1],u=t[o],l=t[o==e?0:o+1],h=n[0==a?r:a-1],f=n[a],p=n[a==r?0:a+1],y=c(s,u,f),d=c(u,h,f),x=c(u,f,p),m=c(h,f,u),b=c(f,s,u),w=c(f,u,l);y>=0&&d>=0&&x<0&&m>=0&&b>=0&&w<0?i.ll=new g(o,a):y<=0&&d<=0&&x>0&&m<=0&&b<=0&&w>0?i.rr=new g(o,a):y<=0&&d>0&&x<=0&&m>=0&&b<0&&w>=0?i.rl=new g(o,a):y>=0&&d<0&&x>=0&&m<=0&&b>0&&w<=0&&(i.lr=new g(o,a))}return i}function S(t,n){return!t.every((function(t){return!function(t,n){for(var e=1,r=n.length;e<r;++e)if(h(n[e-1],n[e],t))return!1;return!0}(t,n)}))}e.TangentVisibilityGraph=w,e.tangents=M,e.polysOverlap=function(t,n){if(S(t,n))return!0;if(S(n,t))return!0;for(var e=1,r=t.length;e<r;++e){var i=t[e],o=t[e-1];if(_(new s(o.x,o.y,i.x,i.y),n).length>0)return!0}return!1}},{"./rectangle":17}],9:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./rectangle"),i=t("./vpsc"),o=t("./shortestpaths"),a=function(t,n,e){this.id=t,this.rect=n,this.children=e,this.leaf=void 0===e||0===e.length};e.NodeWrapper=a;var s=function(t,n,e,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this.id=t,this.x=n,this.y=e,this.node=r,this.line=i};e.Vert=s;var u=function(){function t(n,e){this.s=n,this.t=e;var r=t.findMatch(n,e),i=e.slice(0).reverse(),o=t.findMatch(n,i);r.length>=o.length?(this.length=r.length,this.si=r.si,this.ti=r.ti,this.reversed=!1):(this.length=o.length,this.si=o.si,this.ti=e.length-o.ti-o.length,this.reversed=!0)}return t.findMatch=function(t,n){for(var e=t.length,r=n.length,i={length:0,si:-1,ti:-1},o=new Array(e),a=0;a<e;a++){o[a]=new Array(r);for(var s=0;s<r;s++)if(t[a]===n[s]){var u=o[a][s]=0===a||0===s?1:o[a-1][s-1]+1;u>i.length&&(i.length=u,i.si=a-u+1,i.ti=s-u+1)}else o[a][s]=0}return i},t.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},t}();e.LongestCommonSubsequence=u;var c=function(){function t(t,n,e){var i=this;void 0===e&&(e=12),this.originalnodes=t,this.groupPadding=e,this.leaves=null,this.nodes=t.map((function(t,e){return new a(e,n.getBounds(t),n.getChildren(t))})),this.leaves=this.nodes.filter((function(t){return t.leaf})),this.groups=this.nodes.filter((function(t){return!t.leaf})),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach((function(t){return t.children.forEach((function(n){return i.nodes[n].parent=t}))})),this.root={children:[]},this.nodes.forEach((function(t){void 0===t.parent&&(t.parent=i.root,i.root.children.push(t.id)),t.ports=[]})),this.backToFront=this.nodes.slice(0),this.backToFront.sort((function(t,n){return i.getDepth(t)-i.getDepth(n)})),this.backToFront.slice(0).reverse().filter((function(t){return!t.leaf})).forEach((function(t){var n=r.Rectangle.empty();t.children.forEach((function(t){return n=n.union(i.nodes[t].rect)})),t.rect=n.inflate(i.groupPadding)}));var o=this.midPoints(this.cols.map((function(t){return t.pos}))),u=this.midPoints(this.rows.map((function(t){return t.pos}))),c=o[0],l=o[o.length-1],h=u[0],f=u[u.length-1],p=this.rows.map((function(t){return{x1:c,x2:l,y1:t.pos,y2:t.pos}})).concat(u.map((function(t){return{x1:c,x2:l,y1:t,y2:t}}))),y=this.cols.map((function(t){return{x1:t.pos,x2:t.pos,y1:h,y2:f}})).concat(o.map((function(t){return{x1:t,x2:t,y1:h,y2:f}}))),d=p.concat(y);d.forEach((function(t){return t.verts=[]})),this.verts=[],this.edges=[],p.forEach((function(t){return y.forEach((function(n){var e=new s(i.verts.length,n.x1,t.y1);t.verts.push(e),n.verts.push(e),i.verts.push(e);for(var r=i.backToFront.length;r-- >0;){var o=i.backToFront[r],a=o.rect,u=Math.abs(e.x-a.cx()),c=Math.abs(e.y-a.cy());if(u<a.width()/2&&c<a.height()/2){e.node=o;break}}}))})),d.forEach((function(t,n){i.nodes.forEach((function(n,e){n.rect.lineIntersections(t.x1,t.y1,t.x2,t.y2).forEach((function(e,r){var o=new s(i.verts.length,e.x,e.y,n,t);i.verts.push(o),t.verts.push(o),n.ports.push(o)}))}));var e=Math.abs(t.y1-t.y2)<.1,r=function(t,n){return e?n.x-t.x:n.y-t.y};t.verts.sort(r);for(var o=1;o<t.verts.length;o++){var a=t.verts[o-1],u=t.verts[o];a.node&&a.node===u.node&&a.node.leaf||i.edges.push({source:a.id,target:u.id,length:Math.abs(r(a,u))})}}))}return t.prototype.avg=function(t){return t.reduce((function(t,n){return t+n}))/t.length},t.prototype.getGridLines=function(t){for(var n=[],e=this.leaves.slice(0,this.leaves.length);e.length>0;){var r=e.filter((function(n){return n.rect["overlap"+t.toUpperCase()](e[0].rect)})),i={nodes:r,pos:this.avg(r.map((function(n){return n.rect["c"+t]()})))};n.push(i),i.nodes.forEach((function(t){return e.splice(e.indexOf(t),1)}))}return n.sort((function(t,n){return t.pos-n.pos})),n},t.prototype.getDepth=function(t){for(var n=0;t.parent!==this.root;)n++,t=t.parent;return n},t.prototype.midPoints=function(t){for(var n=t[1]-t[0],e=[t[0]-n/2],r=1;r<t.length;r++)e.push((t[r]+t[r-1])/2);return e.push(t[t.length-1]+n/2),e},t.prototype.findLineage=function(t){var n=[t];do{t=t.parent,n.push(t)}while(t!==this.root);return n.reverse()},t.prototype.findAncestorPathBetween=function(t,n){for(var e=this.findLineage(t),r=this.findLineage(n),i=0;e[i]===r[i];)i++;return{commonAncestor:e[i-1],lineages:e.slice(i).concat(r.slice(i))}},t.prototype.siblingObstacles=function(t,n){var e=this,r=this.findAncestorPathBetween(t,n),i={};r.lineages.forEach((function(t){return i[t.id]={}}));var o=r.commonAncestor.children.filter((function(t){return!(t in i)}));return r.lineages.filter((function(t){return t.parent!==r.commonAncestor})).forEach((function(t){return o=o.concat(t.parent.children.filter((function(n){return n!==t.id})))})),o.map((function(t){return e.nodes[t]}))},t.getSegmentSets=function(t,n,e){for(var r=[],i=0;i<t.length;i++)for(var o=t[i],a=0;a<o.length;a++){(h=o[a]).edgeid=i,h.i=a;var s=h[1][n]-h[0][n];Math.abs(s)<.1&&r.push(h)}r.sort((function(t,e){return t[0][n]-e[0][n]}));for(var u=[],c=null,l=0;l<r.length;l++){var h=r[l];(!c||Math.abs(h[0][n]-c.pos)>.1)&&(c={pos:h[0][n],segments:[]},u.push(c)),c.segments.push(h)}return u},t.nudgeSegs=function(t,n,e,r,o,a){var s=r.length;if(!(s<=1)){for(var u=r.map((function(n){return new i.Variable(n[0][t])})),c=[],l=0;l<s;l++)for(var h=0;h<s;h++)if(l!==h){var f=r[l],p=r[h],y=f.edgeid,d=p.edgeid,g=-1,v=-1;"x"==t?o(y,d)&&(f[0][n]<f[1][n]?(g=h,v=l):(g=l,v=h)):o(y,d)&&(f[0][n]<f[1][n]?(g=l,v=h):(g=h,v=l)),g>=0&&c.push(new i.Constraint(u[g],u[v],a))}new i.Solver(u,c).solve(),u.forEach((function(n,i){var o=r[i],a=n.position();o[0][t]=o[1][t]=a;var s=e[o.edgeid];o.i>0&&(s[o.i-1][1][t]=a),o.i<s.length-1&&(s[o.i+1][0][t]=a)}))}},t.nudgeSegments=function(n,e,r,i,o){for(var a=t.getSegmentSets(n,e,r),s=0;s<a.length;s++){for(var u=a[s],c=[],l=0;l<u.segments.length;l++){var h=u.segments[l];c.push({type:0,s:h,pos:Math.min(h[0][r],h[1][r])}),c.push({type:1,s:h,pos:Math.max(h[0][r],h[1][r])})}c.sort((function(t,n){return t.pos-n.pos+t.type-n.type}));var f=[],p=0;c.forEach((function(a){0===a.type?(f.push(a.s),p++):p--,0==p&&(t.nudgeSegs(e,r,n,f,i,o),f=[])}))}},t.prototype.routeEdges=function(n,e,r,i){var o=this,a=n.map((function(t){return o.route(r(t),i(t))})),s=t.orderEdges(a),u=a.map((function(n){return t.makeSegments(n)}));return t.nudgeSegments(u,"x","y",s,e),t.nudgeSegments(u,"y","x",s,e),t.unreverseEdges(u,a),u},t.unreverseEdges=function(t,n){t.forEach((function(t,e){n[e].reversed&&(t.reverse(),t.forEach((function(t){t.reverse()})))}))},t.angleBetween2Lines=function(t,n){var e=Math.atan2(t[0].y-t[1].y,t[0].x-t[1].x),r=Math.atan2(n[0].y-n[1].y,n[0].x-n[1].x),i=e-r;return(i>Math.PI||i<-Math.PI)&&(i=r-e),i},t.isLeft=function(t,n,e){return(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x)<=0},t.getOrder=function(t){for(var n={},e=0;e<t.length;e++){var r=t[e];void 0===n[r.l]&&(n[r.l]={}),n[r.l][r.r]=!0}return function(t,e){return void 0!==n[t]&&n[t][e]}},t.orderEdges=function(n){for(var e=[],r=0;r<n.length-1;r++)for(var i=r+1;i<n.length;i++){var o,a,s,c=n[r],l=n[i],h=new u(c,l);0!==h.length&&(h.reversed&&(l.reverse(),l.reversed=!0,h=new u(c,l)),(h.si<=0||h.ti<=0)&&(h.si+h.length>=c.length||h.ti+h.length>=l.length)?e.push({l:r,r:i}):(h.si+h.length>=c.length||h.ti+h.length>=l.length?(o=c[h.si+1],s=c[h.si-1],a=l[h.ti-1]):(o=c[h.si+h.length-2],a=c[h.si+h.length],s=l[h.ti+h.length]),t.isLeft(o,a,s)?e.push({l:i,r:r}):e.push({l:r,r:i})))}return t.getOrder(e)},t.makeSegments=function(t){function n(t){return{x:t.x,y:t.y}}for(var e=function(t,n,e){return Math.abs((n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x))<.001},r=[],i=n(t[0]),o=1;o<t.length;o++){var a=n(t[o]),s=o<t.length-1?t[o+1]:null;s&&e(i,a,s)||(r.push([i,a]),i=a)}return r},t.prototype.route=function(t,n){var e=this,r=this.nodes[t],i=this.nodes[n];this.obstacles=this.siblingObstacles(r,i);var a={};this.obstacles.forEach((function(t){return a[t.id]=t})),this.passableEdges=this.edges.filter((function(t){var n=e.verts[t.source],r=e.verts[t.target];return!(n.node&&n.node.id in a||r.node&&r.node.id in a)}));for(var s=1;s<r.ports.length;s++){var u=r.ports[0].id,c=r.ports[s].id;this.passableEdges.push({source:u,target:c,length:0})}for(s=1;s<i.ports.length;s++)u=i.ports[0].id,c=i.ports[s].id,this.passableEdges.push({source:u,target:c,length:0});var l=new o.Calculator(this.verts.length,this.passableEdges,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).PathFromNodeToNodeWithPrevCost(r.ports[0].id,i.ports[0].id,(function(t,n,o){var a=e.verts[t],s=e.verts[n],u=e.verts[o],c=Math.abs(u.x-a.x),l=Math.abs(u.y-a.y);return a.node===r&&a.node===s.node||s.node===i&&s.node===u.node?0:c>1&&l>1?1e3:0})).reverse().map((function(t){return e.verts[t]}));return l.push(this.nodes[i.id].ports[0]),l.filter((function(t,n){return!(n<l.length-1&&l[n+1].node===r&&t.node===r||n>0&&t.node===i&&l[n-1].node===i)}))},t.getRoutePath=function(n,e,r,i){var o,a,s,u={routepath:"M "+n[0][0].x+" "+n[0][0].y+" ",arrowpath:""};if(n.length>1)for(var c=0;c<n.length;c++){var l=(o=n[c])[1].x,h=o[1].y,f=l-o[0].x,p=h-o[0].y;if(c<n.length-1){Math.abs(f)>0?l-=f/Math.abs(f)*e:h-=p/Math.abs(p)*e,u.routepath+="L "+l+" "+h+" ";var y=n[c+1],d=y[0].x,g=y[0].y;f=y[1].x-d,p=y[1].y-g;var v,x,m=t.angleBetween2Lines(o,y)<0?1:0;Math.abs(f)>0?(v=d+f/Math.abs(f)*e,x=g):(v=d,x=g+p/Math.abs(p)*e);var b=Math.abs(v-l),w=Math.abs(x-h);u.routepath+="A "+b+" "+w+" 0 0 "+m+" "+v+" "+x+" "}else{var _=[l,h];Math.abs(f)>0?(a=[l-=f/Math.abs(f)*i,h+r],s=[l,h-r]):(a=[l+r,h-=p/Math.abs(p)*i],s=[l-r,h]),u.routepath+="L "+l+" "+h+" ",i>0&&(u.arrowpath="M "+_[0]+" "+_[1]+" L "+a[0]+" "+a[1]+" L "+s[0]+" "+s[1])}}else l=(o=n[0])[1].x,h=o[1].y,f=l-o[0].x,p=h-o[0].y,_=[l,h],Math.abs(f)>0?(a=[l-=f/Math.abs(f)*i,h+r],s=[l,h-r]):(a=[l+r,h-=p/Math.abs(p)*i],s=[l-r,h]),u.routepath+="L "+l+" "+h+" ",i>0&&(u.arrowpath="M "+_[0]+" "+_[1]+" L "+a[0]+" "+a[1]+" L "+s[0]+" "+s[1]);return u},t}();e.GridRouter=c},{"./rectangle":17,"./shortestpaths":18,"./vpsc":19}],10:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=10,i=(1+Math.sqrt(5))/2,o=1e-4;e.applyPacking=function(t,n,e,a,s,u){void 0===s&&(s=1),void 0===u&&(u=!0);var c=n,l=e,h=(s=void 0!==s?s:1,a=void 0!==a?a:0,0),f=0,p=0,y=0,d=[];function g(t,n){d=[],h=0,f=0,y=0;for(var e=0;e<t.length;e++)v(t[e],n);return Math.abs(h/f-s)}function v(t,n){for(var e=void 0,i=0;i<d.length;i++)if(d[i].space_left>=t.height&&d[i].x+d[i].width+t.width+r-n<=o){e=d[i];break}d.push(t),void 0!==e?(t.x=e.x+e.width+r,t.y=e.bottom,t.space_left=t.height,t.bottom=t.y,e.space_left-=t.height+r,e.bottom+=t.height+r):(t.y=y,y+=t.height+r,t.x=0,t.bottom=t.y,t.space_left=t.height),t.y+t.height-f>-o&&(f=t.y+t.height-0),t.x+t.width-h>-o&&(h=t.x+t.width-0)}0!=t.length&&(function(t){t.forEach((function(t){var n,e,r,i,o;n=t,e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=0,o=0,n.array.forEach((function(t){var n=void 0!==t.width?t.width:a,s=void 0!==t.height?t.height:a;n/=2,s/=2,i=Math.max(t.x+n,i),e=Math.min(t.x-n,e),o=Math.max(t.y+s,o),r=Math.min(t.y-s,r)})),n.width=i-e,n.height=o-r}))}(t),function(t,n){var e=Number.POSITIVE_INFINITY,a=0;t.sort((function(t,n){return n.height-t.height})),p=t.reduce((function(t,n){return t.width<n.width?t.width:n.width}));for(var s=v=p,u=x=function(t){var n=0;return t.forEach((function(t){return n+=t.width+r})),n}(t),c=0,l=Number.MAX_VALUE,h=Number.MAX_VALUE,f=-1,y=Number.MAX_VALUE,d=Number.MAX_VALUE;y>p||d>o;){if(1!=f){var v=u-(u-s)/i;l=g(t,v)}if(0!=f){var x=s+(u-s)/i;h=g(t,x)}if(y=Math.abs(v-x),d=Math.abs(l-h),l<e&&(e=l,a=v),h<e&&(e=h,a=x),l>h?(s=v,v=x,l=h,f=1):(u=x,x=v,h=l,f=0),c++>100)break}g(t,a)}(t),u&&function(t){t.forEach((function(t){var n={x:0,y:0};t.array.forEach((function(t){n.x+=t.x,n.y+=t.y})),n.x/=t.array.length,n.y/=t.array.length;var e=n.x-t.width/2,r=n.y-t.height/2,i=t.x-e+c/2-h/2,o=t.y-r+l/2-f/2;t.array.forEach((function(t){t.x+=i,t.y+=o}))}))}(t))},e.separateGraphs=function(t,n){for(var e={},r={},i=[],o=0,a=0;a<n.length;a++){var s=n[a],u=s.source,c=s.target;r[u.index]?r[u.index].push(c):r[u.index]=[c],r[c.index]?r[c.index].push(u):r[c.index]=[u]}for(a=0;a<t.length;a++){var l=t[a];e[l.index]||h(l,!0)}function h(t,n){if(void 0===e[t.index]){n&&(o++,i.push({array:[]})),e[t.index]=o,i[o-1].array.push(t);var a=r[t.index];if(a)for(var s=0;s<a.length;s++)h(a[s],!1)}}return i}},{}],11:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=t("./powergraph"),o=t("./linklengths"),a=t("./descent"),s=t("./rectangle"),u=t("./shortestpaths"),c=t("./geom"),l=t("./handledisconnected");function h(t){return void 0!==t.leaves||void 0!==t.groups}!function(t){t[t.start=0]="start",t[t.tick=1]="tick",t[t.end=2]="end"}(r=e.EventType||(e.EventType={}));var f=function(){function t(){var n=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:t.getSourceIndex,getTargetIndex:t.getTargetIndex,setLength:t.setLinkLength,getType:function(t){return"function"==typeof n._linkType?n._linkType(t):0}}}return t.prototype.on=function(t,n){return this.event||(this.event={}),"string"==typeof t?this.event[r[t]]=n:this.event[t]=n,this},t.prototype.trigger=function(t){this.event&&void 0!==this.event[t.type]&&this.event[t.type](t)},t.prototype.kick=function(){for(;!this.tick(););},t.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:r.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var t,n,e=this._nodes.length;for(this._links.length,this._descent.locks.clear(),n=0;n<e;++n)if((t=this._nodes[n]).fixed){void 0!==t.px&&void 0!==t.py||(t.px=t.x,t.py=t.y);var i=[t.px,t.py];this._descent.locks.add(n,i)}var o=this._descent.rungeKutta();return 0===o?this._alpha=0:void 0!==this._lastStress&&(this._alpha=o),this._lastStress=o,this.updateNodePositions(),this.trigger({type:r.tick,alpha:this._alpha,stress:this._lastStress}),!1},t.prototype.updateNodePositions=function(){for(var t,n=this._descent.x[0],e=this._descent.x[1],r=this._nodes.length;r--;)(t=this._nodes[r]).x=n[r],t.y=e[r]},t.prototype.nodes=function(t){if(!t){if(0===this._nodes.length&&this._links.length>0){var n=0;this._links.forEach((function(t){n=Math.max(n,t.source,t.target)})),this._nodes=new Array(++n);for(var e=0;e<n;++e)this._nodes[e]={}}return this._nodes}return this._nodes=t,this},t.prototype.groups=function(t){var n=this;return t?(this._groups=t,this._rootGroup={},this._groups.forEach((function(t){void 0===t.padding&&(t.padding=1),void 0!==t.leaves&&t.leaves.forEach((function(e,r){"number"==typeof e&&((t.leaves[r]=n._nodes[e]).parent=t)})),void 0!==t.groups&&t.groups.forEach((function(e,r){"number"==typeof e&&((t.groups[r]=n._groups[e]).parent=t)}))})),this._rootGroup.leaves=this._nodes.filter((function(t){return void 0===t.parent})),this._rootGroup.groups=this._groups.filter((function(t){return void 0===t.parent})),this):this._groups},t.prototype.powerGraphGroups=function(t){var n=i.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(n.groups),t(n),this},t.prototype.avoidOverlaps=function(t){return arguments.length?(this._avoidOverlaps=t,this):this._avoidOverlaps},t.prototype.handleDisconnected=function(t){return arguments.length?(this._handleDisconnected=t,this):this._handleDisconnected},t.prototype.flowLayout=function(t,n){return arguments.length||(t="y"),this._directedLinkConstraints={axis:t,getMinSeparation:"number"==typeof n?function(){return n}:n},this},t.prototype.links=function(t){return arguments.length?(this._links=t,this):this._links},t.prototype.constraints=function(t){return arguments.length?(this._constraints=t,this):this._constraints},t.prototype.distanceMatrix=function(t){return arguments.length?(this._distanceMatrix=t,this):this._distanceMatrix},t.prototype.size=function(t){return t?(this._canvasSize=t,this):this._canvasSize},t.prototype.defaultNodeSize=function(t){return t?(this._defaultNodeSize=t,this):this._defaultNodeSize},t.prototype.groupCompactness=function(t){return t?(this._groupCompactness=t,this):this._groupCompactness},t.prototype.linkDistance=function(t){return t?(this._linkDistance="function"==typeof t?t:+t,this._linkLengthCalculator=null,this):this._linkDistance},t.prototype.linkType=function(t){return this._linkType=t,this},t.prototype.convergenceThreshold=function(t){return t?(this._threshold="function"==typeof t?t:+t,this):this._threshold},t.prototype.alpha=function(t){return arguments.length?(t=+t,this._alpha?this._alpha=t>0?t:0:t>0&&(this._running||(this._running=!0,this.trigger({type:r.start,alpha:this._alpha=t}),this.kick())),this):this._alpha},t.prototype.getLinkLength=function(t){return"function"==typeof this._linkDistance?+this._linkDistance(t):this._linkDistance},t.setLinkLength=function(t,n){t.length=n},t.prototype.getLinkType=function(t){return"function"==typeof this._linkType?this._linkType(t):0},t.prototype.symmetricDiffLinkLengths=function(t,n){var e=this;return void 0===n&&(n=1),this.linkDistance((function(n){return t*n.length})),this._linkLengthCalculator=function(){return o.symmetricDiffLinkLengths(e._links,e.linkAccessor,n)},this},t.prototype.jaccardLinkLengths=function(t,n){var e=this;return void 0===n&&(n=1),this.linkDistance((function(n){return t*n.length})),this._linkLengthCalculator=function(){return o.jaccardLinkLengths(e._links,e.linkAccessor,n)},this},t.prototype.start=function(n,e,r,i,c,l){var h=this;void 0===n&&(n=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===c&&(c=!0),void 0===l&&(l=!0);var f,p=this.nodes().length,y=p+2*this._groups.length,d=(this._links.length,this._canvasSize[0]),g=this._canvasSize[1],v=new Array(y),x=new Array(y),m=null,b=this._avoidOverlaps;this._nodes.forEach((function(t,n){t.index=n,void 0===t.x&&(t.x=d/2,t.y=g/2),v[n]=t.x,x[n]=t.y})),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?f=this._distanceMatrix:(f=new u.Calculator(y,this._links,t.getSourceIndex,t.getTargetIndex,(function(t){return h.getLinkLength(t)})).DistanceMatrix(),m=a.Descent.createSquareMatrix(y,(function(){return 2})),this._links.forEach((function(t){"number"==typeof t.source&&(t.source=h._nodes[t.source]),"number"==typeof t.target&&(t.target=h._nodes[t.target])})),this._links.forEach((function(n){var e=t.getSourceIndex(n),r=t.getTargetIndex(n);m[e][r]=m[r][e]=n.weight||1})));var w=a.Descent.createSquareMatrix(y,(function(t,n){return f[t][n]}));if(this._rootGroup&&void 0!==this._rootGroup.groups){var _=p;this._groups.forEach((function(t){!function(t,n,e,r){m[t][n]=m[n][t]=e,w[t][n]=w[n][t]=r}(_,_+1,h._groupCompactness,.1),void 0===t.bounds?(v[_]=d/2,x[_++]=g/2,v[_]=d/2,x[_++]=g/2):(v[_]=t.bounds.x,x[_++]=t.bounds.y,v[_]=t.bounds.X,x[_++]=t.bounds.Y)}))}else this._rootGroup={leaves:this._nodes,groups:[]};var M=this._constraints||[];for(this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,M=M.concat(o.generateDirectedEdgeConstraints(p,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new a.Descent([v,x],w),this._descent.locks.clear(),_=0;_<p;++_){var S=this._nodes[_];if(S.fixed){S.px=S.x,S.py=S.y;var k=[S.x,S.y];this._descent.locks.add(_,k)}}if(this._descent.threshold=this._threshold,this.initialLayout(n,v,x),M.length>0&&(this._descent.project=new s.Projection(this._nodes,this._groups,this._rootGroup,M).projectFunctions()),this._descent.run(e),this.separateOverlappingComponents(d,g,l),this.avoidOverlaps(b),b&&(this._nodes.forEach((function(t,n){t.x=v[n],t.y=x[n]})),this._descent.project=new s.Projection(this._nodes,this._groups,this._rootGroup,M,!0).projectFunctions(),this._nodes.forEach((function(t,n){v[n]=t.x,x[n]=t.y}))),this._descent.G=m,this._descent.run(r),i){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=p,this._descent.scaleSnapByMaxH=p!=y;var E=a.Descent.createSquareMatrix(y,(function(t,n){return t>=p||n>=p?m[t][n]:0}));this._descent.G=E,this._descent.run(i)}return this.updateNodePositions(),this.separateOverlappingComponents(d,g,l),c?this.resume():this},t.prototype.initialLayout=function(n,e,r){if(this._groups.length>0&&n>0){var i=this._nodes.length,o=this._links.map((function(t){return{source:t.source.index,target:t.target.index}})),a=this._nodes.map((function(t){return{index:t.index}}));this._groups.forEach((function(t,n){a.push({index:t.index=i+n})})),this._groups.forEach((function(t,n){void 0!==t.leaves&&t.leaves.forEach((function(n){return o.push({source:t.index,target:n.index})})),void 0!==t.groups&&t.groups.forEach((function(n){return o.push({source:t.index,target:n.index})}))})),(new t).size(this.size()).nodes(a).links(o).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(n,0,0,0,!1),this._nodes.forEach((function(t){e[t.index]=a[t.index].x,r[t.index]=a[t.index].y}))}else this._descent.run(n)},t.prototype.separateOverlappingComponents=function(t,n,e){var r=this;if(void 0===e&&(e=!0),!this._distanceMatrix&&this._handleDisconnected){var i=this._descent.x[0],o=this._descent.x[1];this._nodes.forEach((function(t,n){t.x=i[n],t.y=o[n]}));var a=l.separateGraphs(this._nodes,this._links);l.applyPacking(a,t,n,this._defaultNodeSize,n/t,e),this._nodes.forEach((function(t,n){r._descent.x[0][n]=t.x,r._descent.x[1][n]=t.y,t.bounds&&(t.bounds.setXCentre(t.x),t.bounds.setYCentre(t.y))}))}},t.prototype.resume=function(){return this.alpha(.1)},t.prototype.stop=function(){return this.alpha(0)},t.prototype.prepareEdgeRouting=function(t){void 0===t&&(t=0),this._visibilityGraph=new c.TangentVisibilityGraph(this._nodes.map((function(n){return n.bounds.inflate(-t).vertices()})))},t.prototype.routeEdge=function(t,n,e){void 0===n&&(n=5);var r=[],i=new c.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),o={x:t.source.x,y:t.source.y},a={x:t.target.x,y:t.target.y},l=i.addPoint(o,t.source.index),h=i.addPoint(a,t.target.index);i.addEdgeIfVisible(o,a,t.source.index,t.target.index),void 0!==e&&e(i);var f=new u.Calculator(i.V.length,i.E,(function(t){return t.source.id}),(function(t){return t.target.id}),(function(t){return t.length()})).PathFromNodeToNode(l.id,h.id);if(1===f.length||f.length===i.V.length){var p=s.makeEdgeBetween(t.source.innerBounds,t.target.innerBounds,n);r=[p.sourceIntersection,p.arrowStart]}else{for(var y=f.length-2,d=i.V[f[y]].p,g=i.V[f[0]].p,v=(r=[t.source.innerBounds.rayIntersection(d.x,d.y)],y);v>=0;--v)r.push(i.V[f[v]].p);r.push(s.makeEdgeTo(g,t.target.innerBounds,n))}return r},t.getSourceIndex=function(t){return"number"==typeof t.source?t.source:t.source.index},t.getTargetIndex=function(t){return"number"==typeof t.target?t.target:t.target.index},t.linkId=function(n){return t.getSourceIndex(n)+"-"+t.getTargetIndex(n)},t.dragStart=function(n){h(n)?t.storeOffset(n,t.dragOrigin(n)):(t.stopNode(n),n.fixed|=2)},t.stopNode=function(t){t.px=t.x,t.py=t.y},t.storeOffset=function(n,e){void 0!==n.leaves&&n.leaves.forEach((function(n){n.fixed|=2,t.stopNode(n),n._dragGroupOffsetX=n.x-e.x,n._dragGroupOffsetY=n.y-e.y})),void 0!==n.groups&&n.groups.forEach((function(n){return t.storeOffset(n,e)}))},t.dragOrigin=function(t){return h(t)?{x:t.bounds.cx(),y:t.bounds.cy()}:t},t.drag=function(n,e){h(n)?(void 0!==n.leaves&&n.leaves.forEach((function(t){n.bounds.setXCentre(e.x),n.bounds.setYCentre(e.y),t.px=t._dragGroupOffsetX+e.x,t.py=t._dragGroupOffsetY+e.y})),void 0!==n.groups&&n.groups.forEach((function(n){return t.drag(n,e)}))):(n.px=e.x,n.py=e.y)},t.dragEnd=function(n){h(n)?(void 0!==n.leaves&&n.leaves.forEach((function(n){t.dragEnd(n),delete n._dragGroupOffsetX,delete n._dragGroupOffsetY})),void 0!==n.groups&&n.groups.forEach(t.dragEnd)):n.fixed&=-7},t.mouseOver=function(t){t.fixed|=4,t.px=t.x,t.py=t.y},t.mouseOut=function(t){t.fixed&=-5},t}();e.Layout=f},{"./descent":7,"./geom":8,"./handledisconnected":10,"./linklengths":13,"./powergraph":14,"./rectangle":17,"./shortestpaths":18}],12:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./shortestpaths"),i=t("./descent"),o=t("./rectangle"),a=t("./linklengths"),s=function(){function t(t,n){this.source=t,this.target=n}return t.prototype.actualLength=function(t){var n=this;return Math.sqrt(t.reduce((function(t,e){var r=e[n.target]-e[n.source];return t+r*r}),0))},t}();e.Link3D=s;var u=function(t,n,e){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),this.x=t,this.y=n,this.z=e};e.Node3D=u;var c=function(){function t(n,e,r){var i=this;void 0===r&&(r=1),this.nodes=n,this.links=e,this.idealLinkLength=r,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(t.k);for(var o=0;o<t.k;++o)this.result[o]=new Array(n.length);n.forEach((function(n,e){for(var r=0,o=t.dims;r<o.length;r++){var a=o[r];void 0===n[a]&&(n[a]=Math.random())}i.result[0][e]=n.x,i.result[1][e]=n.y,i.result[2][e]=n.z}))}return t.prototype.linkLength=function(t){return t.actualLength(this.result)},t.prototype.start=function(t){var n=this;void 0===t&&(t=100);var e=this.nodes.length,s=new l;this.useJaccardLinkLengths&&a.jaccardLinkLengths(this.links,s,1.5),this.links.forEach((function(t){return t.length*=n.idealLinkLength}));var u=new r.Calculator(e,this.links,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).DistanceMatrix(),c=i.Descent.createSquareMatrix(e,(function(t,n){return u[t][n]})),h=i.Descent.createSquareMatrix(e,(function(){return 2}));this.links.forEach((function(t){var n=t.source,e=t.target;return h[n][e]=h[e][n]=1})),this.descent=new i.Descent(this.result,c),this.descent.threshold=.001,this.descent.G=h,this.constraints&&(this.descent.project=new o.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var f=0;f<this.nodes.length;f++){var p=this.nodes[f];p.fixed&&this.descent.locks.add(f,[p.x,p.y,p.z])}return this.descent.run(t),this},t.prototype.tick=function(){this.descent.locks.clear();for(var t=0;t<this.nodes.length;t++){var n=this.nodes[t];n.fixed&&this.descent.locks.add(t,[n.x,n.y,n.z])}return this.descent.rungeKutta()},t.dims=["x","y","z"],t.k=t.dims.length,t}();e.Layout3D=c;var l=function(){function t(){}return t.prototype.getSourceIndex=function(t){return t.source},t.prototype.getTargetIndex=function(t){return t.target},t.prototype.getLength=function(t){return t.length},t.prototype.setLength=function(t,n){t.length=n},t}()},{"./descent":7,"./linklengths":13,"./rectangle":17,"./shortestpaths":18}],13:[function(t,n,e){"use strict";function r(t,n){var e={};for(var r in t)e[r]={};for(var r in n)e[r]={};return Object.keys(e).length}function i(t,n){var e=0;for(var r in t)void 0!==n[r]&&++e;return e}function o(t,n,e,r){var i=function(t,n){var e={},r=function(t,n){void 0===e[t]&&(e[t]={}),e[t][n]={}};return t.forEach((function(t){var e=n.getSourceIndex(t),i=n.getTargetIndex(t);r(e,i),r(i,e)})),e}(t,r);t.forEach((function(t){var o=i[r.getSourceIndex(t)],a=i[r.getTargetIndex(t)];r.setLength(t,1+n*e(o,a))}))}function a(t,n,e){var r=[],i=0,o=[],a=[];function s(t){t.index=t.lowlink=i++,o.push(t),t.onStack=!0;for(var n=0,e=t.out;n<e.length;n++){var r=e[n];void 0===r.index?(s(r),t.lowlink=Math.min(t.lowlink,r.lowlink)):r.onStack&&(t.lowlink=Math.min(t.lowlink,r.index))}if(t.lowlink===t.index){for(var u=[];o.length&&((r=o.pop()).onStack=!1,u.push(r),r!==t););a.push(u.map((function(t){return t.id})))}}for(var u=0;u<t;u++)r.push({id:u,out:[]});for(var c=0,l=n;c<l.length;c++){var h=l[c],f=r[e.getSourceIndex(h)],p=r[e.getTargetIndex(h)];f.out.push(p)}for(var y=0,d=r;y<d.length;y++){var g=d[y];void 0===g.index&&s(g)}return a}Object.defineProperty(e,"__esModule",{value:!0}),e.symmetricDiffLinkLengths=function(t,n,e){void 0===e&&(e=1),o(t,e,(function(t,n){return Math.sqrt(r(t,n)-i(t,n))}),n)},e.jaccardLinkLengths=function(t,n,e){void 0===e&&(e=1),o(t,e,(function(t,n){return Math.min(Object.keys(t).length,Object.keys(n).length)<1.1?0:i(t,n)/r(t,n)}),n)},e.generateDirectedEdgeConstraints=function(t,n,e,r){var i=a(t,n,r),o={};i.forEach((function(t,n){return t.forEach((function(t){return o[t]=n}))}));var s=[];return n.forEach((function(t){var n=r.getSourceIndex(t),i=r.getTargetIndex(t);o[n]!==o[i]&&s.push({axis:e,left:n,right:i,gap:r.getMinSeparation(t)})})),s},e.stronglyConnectedComponents=a},{}],14:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,n,e){this.source=t,this.target=n,this.type=e};e.PowerEdge=r;var i=function(){function t(t,n,e,r){var i=this;if(this.linkAccessor=e,this.modules=new Array(t),this.roots=[],r)this.initModulesFromGroup(r);else{this.roots.push(new s);for(var a=0;a<t;++a)this.roots[0].add(this.modules[a]=new o(a))}this.R=n.length,n.forEach((function(t){var n=i.modules[e.getSourceIndex(t)],r=i.modules[e.getTargetIndex(t)],o=e.getType(t);n.outgoing.add(o,r),r.incoming.add(o,n)}))}return t.prototype.initModulesFromGroup=function(t){var n=new s;this.roots.push(n);for(var e=0;e<t.leaves.length;++e){var r=t.leaves[e],i=new o(r.id);this.modules[r.id]=i,n.add(i)}if(t.groups)for(var a=0;a<t.groups.length;++a){var c=t.groups[a],l={};for(var h in c)"leaves"!==h&&"groups"!==h&&c.hasOwnProperty(h)&&(l[h]=c[h]);n.add(new o(-1-a,new u,new u,this.initModulesFromGroup(c),l))}return n},t.prototype.merge=function(t,n,e){void 0===e&&(e=0);var r=t.incoming.intersection(n.incoming),i=t.outgoing.intersection(n.outgoing),a=new s;a.add(t),a.add(n);var u=new o(this.modules.length,i,r,a);this.modules.push(u);var c=function(e,r,i){e.forAll((function(e,o){e.forAll((function(e){var a=e[r];a.add(o,u),a.remove(o,t),a.remove(o,n),t[i].remove(o,e),n[i].remove(o,e)}))}))};return c(i,"incoming","outgoing"),c(r,"outgoing","incoming"),this.R-=r.count()+i.count(),this.roots[e].remove(t),this.roots[e].remove(n),this.roots[e].add(u),u},t.prototype.rootMerges=function(t){void 0===t&&(t=0);for(var n=this.roots[t].modules(),e=n.length,r=new Array(e*(e-1)),i=0,o=0,a=e-1;o<a;++o)for(var s=o+1;s<e;++s){var u=n[o],c=n[s];r[i]={id:i,nEdges:this.nEdges(u,c),a:u,b:c},i++}return r},t.prototype.greedyMerge=function(){for(var t=0;t<this.roots.length;++t)if(!(this.roots[t].modules().length<2)){var n=this.rootMerges(t).sort((function(t,n){return t.nEdges==n.nEdges?t.id-n.id:t.nEdges-n.nEdges}))[0];if(!(n.nEdges>=this.R))return this.merge(n.a,n.b,t),!0}},t.prototype.nEdges=function(t,n){var e=t.incoming.intersection(n.incoming),r=t.outgoing.intersection(n.outgoing);return this.R-e.count()-r.count()},t.prototype.getGroupHierarchy=function(t){var n=this,e=[];return function t(n,e,r){n.forAll((function(n){if(n.isLeaf())e.leaves||(e.leaves=[]),e.leaves.push(n.id);else{var i=e;if(n.gid=r.length,!n.isIsland()||n.isPredefined()){if(i={id:n.gid},n.isPredefined())for(var o in n.definition)i[o]=n.definition[o];e.groups||(e.groups=[]),e.groups.push(n.gid),r.push(i)}t(n.children,i,r)}}))}(this.roots[0],{},e),this.allEdges().forEach((function(i){var o=n.modules[i.source],a=n.modules[i.target];t.push(new r(void 0===o.gid?i.source:e[o.gid],void 0===a.gid?i.target:e[a.gid],i.type))})),e},t.prototype.allEdges=function(){var n=[];return t.getEdges(this.roots[0],n),n},t.getEdges=function(n,e){n.forAll((function(n){n.getEdges(e),t.getEdges(n.children,e)}))},t}();e.Configuration=i;var o=function(){function t(t,n,e,r,i){void 0===n&&(n=new u),void 0===e&&(e=new u),void 0===r&&(r=new s),this.id=t,this.outgoing=n,this.incoming=e,this.children=r,this.definition=i}return t.prototype.getEdges=function(t){var n=this;this.outgoing.forAll((function(e,i){e.forAll((function(e){t.push(new r(n.id,e.id,i))}))}))},t.prototype.isLeaf=function(){return 0===this.children.count()},t.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},t.prototype.isPredefined=function(){return void 0!==this.definition},t}();function a(t,n){var e={};for(var r in t)r in n&&(e[r]=t[r]);return e}e.Module=o;var s=function(){function t(){this.table={}}return t.prototype.count=function(){return Object.keys(this.table).length},t.prototype.intersection=function(n){var e=new t;return e.table=a(this.table,n.table),e},t.prototype.intersectionCount=function(t){return this.intersection(t).count()},t.prototype.contains=function(t){return t in this.table},t.prototype.add=function(t){this.table[t.id]=t},t.prototype.remove=function(t){delete this.table[t.id]},t.prototype.forAll=function(t){for(var n in this.table)t(this.table[n])},t.prototype.modules=function(){var t=[];return this.forAll((function(n){n.isPredefined()||t.push(n)})),t},t}();e.ModuleSet=s;var u=function(){function t(){this.sets={},this.n=0}return t.prototype.count=function(){return this.n},t.prototype.contains=function(t){var n=!1;return this.forAllModules((function(e){n||e.id!=t||(n=!0)})),n},t.prototype.add=function(t,n){(t in this.sets?this.sets[t]:this.sets[t]=new s).add(n),++this.n},t.prototype.remove=function(t,n){var e=this.sets[t];e.remove(n),0===e.count()&&delete this.sets[t],--this.n},t.prototype.forAll=function(t){for(var n in this.sets)t(this.sets[n],Number(n))},t.prototype.forAllModules=function(t){this.forAll((function(n,e){return n.forAll(t)}))},t.prototype.intersection=function(n){var e=new t;return this.forAll((function(t,r){if(r in n.sets){var i=t.intersection(n.sets[r]),o=i.count();o>0&&(e.sets[r]=i,e.n+=o)}})),e},t}();e.LinkSets=u,e.getGroups=function(t,n,e,r){for(var o=t.length,a=new i(o,n,e,r);a.greedyMerge(););var s=[],u=a.getGroupHierarchy(s);return s.forEach((function(n){var e=function(e){var r=n[e];"number"==typeof r&&(n[e]=t[r])};e("source"),e("target")})),{groups:u,powerEdges:s}}},{}],15:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.elem=t,this.subheaps=[]}return t.prototype.toString=function(t){for(var n="",e=!1,r=0;r<this.subheaps.length;++r){var i=this.subheaps[r];i.elem?(e&&(n+=","),n+=i.toString(t),e=!0):e=!1}return""!==n&&(n="("+n+")"),(this.elem?t(this.elem):"")+n},t.prototype.forEach=function(t){this.empty()||(t(this.elem,this),this.subheaps.forEach((function(n){return n.forEach(t)})))},t.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce((function(t,n){return t+n.count()}),0)},t.prototype.min=function(){return this.elem},t.prototype.empty=function(){return null==this.elem},t.prototype.contains=function(t){if(this===t)return!0;for(var n=0;n<this.subheaps.length;n++)if(this.subheaps[n].contains(t))return!0;return!1},t.prototype.isHeap=function(t){var n=this;return this.subheaps.every((function(e){return t(n.elem,e.elem)&&e.isHeap(t)}))},t.prototype.insert=function(n,e){return this.merge(new t(n),e)},t.prototype.merge=function(t,n){return this.empty()?t:t.empty()?this:n(this.elem,t.elem)?(this.subheaps.push(t),this):(t.subheaps.push(this),t)},t.prototype.removeMin=function(t){return this.empty()?null:this.mergePairs(t)},t.prototype.mergePairs=function(n){if(0==this.subheaps.length)return new t(null);if(1==this.subheaps.length)return this.subheaps[0];var e=this.subheaps.pop().merge(this.subheaps.pop(),n),r=this.mergePairs(n);return e.merge(r,n)},t.prototype.decreaseKey=function(n,e,r,i){var o=n.removeMin(i);n.elem=o.elem,n.subheaps=o.subheaps,null!==r&&null!==o.elem&&r(n.elem,n);var a=new t(e);return null!==r&&r(e,a),this.merge(a,i)},t}();e.PairingHeap=r;var i=function(){function t(t){this.lessThan=t}return t.prototype.top=function(){return this.empty()?null:this.root.elem},t.prototype.push=function(){for(var t,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var i,o=0;i=n[o];++o)t=new r(i),this.root=this.empty()?t:this.root.merge(t,this.lessThan);return t},t.prototype.empty=function(){return!this.root||!this.root.elem},t.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},t.prototype.forEach=function(t){this.root.forEach(t)},t.prototype.pop=function(){if(this.empty())return null;var t=this.root.min();return this.root=this.root.removeMin(this.lessThan),t},t.prototype.reduceKey=function(t,n,e){void 0===e&&(e=null),this.root=this.root.decreaseKey(t,n,e,this.lessThan)},t.prototype.toString=function(t){return this.root.toString(t)},t.prototype.count=function(){return this.root.count()},t}();e.PriorityQueue=i},{}],16:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.findIter=function(t){for(var n=this._root,e=this.iterator();null!==n;){var r=this._comparator(t,n.data);if(0===r)return e._cursor=n,e;e._ancestors.push(n),n=n.get_child(r>0)}return null}}return t.prototype.clear=function(){this._root=null,this.size=0},t.prototype.find=function(t){for(var n=this._root;null!==n;){var e=this._comparator(t,n.data);if(0===e)return n.data;n=n.get_child(e>0)}return null},t.prototype.lowerBound=function(t){return this._bound(t,this._comparator)},t.prototype.upperBound=function(t){var n=this._comparator;return this._bound(t,(function(t,e){return n(e,t)}))},t.prototype.min=function(){var t=this._root;if(null===t)return null;for(;null!==t.left;)t=t.left;return t.data},t.prototype.max=function(){var t=this._root;if(null===t)return null;for(;null!==t.right;)t=t.right;return t.data},t.prototype.iterator=function(){return new a(this)},t.prototype.each=function(t){for(var n,e=this.iterator();null!==(n=e.next());)t(n)},t.prototype.reach=function(t){for(var n,e=this.iterator();null!==(n=e.prev());)t(n)},t.prototype._bound=function(t,n){for(var e=this._root,r=this.iterator();null!==e;){var i=this._comparator(t,e.data);if(0===i)return r._cursor=e,r;r._ancestors.push(e),e=e.get_child(i>0)}for(var o=r._ancestors.length-1;o>=0;--o)if(n(t,(e=r._ancestors[o]).data)>0)return r._cursor=e,r._ancestors.length=o,r;return r._ancestors.length=0,r},t}();e.TreeBase=o;var a=function(){function t(t){this._tree=t,this._ancestors=[],this._cursor=null}return t.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},t.prototype.next=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._minNode(t)}else{var n;if(null===this._cursor.right)do{if(n=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===n);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},t.prototype.prev=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._maxNode(t)}else{var n;if(null===this._cursor.left)do{if(n=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===n);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},t.prototype._minNode=function(t){for(;null!==t.left;)this._ancestors.push(t),t=t.left;this._cursor=t},t.prototype._maxNode=function(t){for(;null!==t.right;)this._ancestors.push(t),t=t.right;this._cursor=t},t}();e.Iterator=a;var s=function(){function t(t){this.data=t,this.left=null,this.right=null,this.red=!0}return t.prototype.get_child=function(t){return t?this.right:this.left},t.prototype.set_child=function(t,n){t?this.right=n:this.left=n},t}(),u=function(t){function n(n){var e=t.call(this)||this;return e._root=null,e._comparator=n,e.size=0,e}return i(n,t),n.prototype.insert=function(t){var e=!1;if(null===this._root)this._root=new s(t),e=!0,this.size++;else{var r=new s(void 0),i=!1,o=!1,a=null,u=r,c=null,l=this._root;for(u.right=this._root;;){if(null===l?(l=new s(t),c.set_child(i,l),e=!0,this.size++):n.is_red(l.left)&&n.is_red(l.right)&&(l.red=!0,l.left.red=!1,l.right.red=!1),n.is_red(l)&&n.is_red(c)){var h=u.right===a;l===c.get_child(o)?u.set_child(h,n.single_rotate(a,!o)):u.set_child(h,n.double_rotate(a,!o))}var f=this._comparator(l.data,t);if(0===f)break;o=i,i=f<0,null!==a&&(u=a),a=c,c=l,l=l.get_child(i)}this._root=r.right}return this._root.red=!1,e},n.prototype.remove=function(t){if(null===this._root)return!1;var e=new s(void 0),r=e;r.right=this._root;for(var i=null,o=null,a=null,u=!0;null!==r.get_child(u);){var c=u;o=i,i=r,r=r.get_child(u);var l=this._comparator(t,r.data);if(u=l>0,0===l&&(a=r),!n.is_red(r)&&!n.is_red(r.get_child(u)))if(n.is_red(r.get_child(!u))){var h=n.single_rotate(r,u);i.set_child(c,h),i=h}else if(!n.is_red(r.get_child(!u))){var f=i.get_child(!c);if(null!==f)if(n.is_red(f.get_child(!c))||n.is_red(f.get_child(c))){var p=o.right===i;n.is_red(f.get_child(c))?o.set_child(p,n.double_rotate(i,c)):n.is_red(f.get_child(!c))&&o.set_child(p,n.single_rotate(i,c));var y=o.get_child(p);y.red=!0,r.red=!0,y.left.red=!1,y.right.red=!1}else i.red=!1,f.red=!0,r.red=!0}}return null!==a&&(a.data=r.data,i.set_child(i.right===r,r.get_child(null===r.left)),this.size--),this._root=e.right,null!==this._root&&(this._root.red=!1),null!==a},n.is_red=function(t){return null!==t&&t.red},n.single_rotate=function(t,n){var e=t.get_child(!n);return t.set_child(!n,e.get_child(n)),e.set_child(n,t),t.red=!0,e.red=!1,e},n.double_rotate=function(t,e){return t.set_child(!e,n.single_rotate(t.get_child(!e),!e)),n.single_rotate(t,e)},n}(o);e.RBTree=u},{}],17:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./vpsc"),a=t("./rbtree");function s(t){return t.bounds=void 0!==t.leaves?t.leaves.reduce((function(t,n){return n.bounds.union(t)}),u.empty()):u.empty(),void 0!==t.groups&&(t.bounds=t.groups.reduce((function(t,n){return s(n).union(t)}),t.bounds)),t.bounds=t.bounds.inflate(t.padding),t.bounds}e.computeGroupBounds=s;var u=function(){function t(t,n,e,r){this.x=t,this.X=n,this.y=e,this.Y=r}return t.empty=function(){return new t(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},t.prototype.cx=function(){return(this.x+this.X)/2},t.prototype.cy=function(){return(this.y+this.Y)/2},t.prototype.overlapX=function(t){var n=this.cx(),e=t.cx();return n<=e&&t.x<this.X?this.X-t.x:e<=n&&this.x<t.X?t.X-this.x:0},t.prototype.overlapY=function(t){var n=this.cy(),e=t.cy();return n<=e&&t.y<this.Y?this.Y-t.y:e<=n&&this.y<t.Y?t.Y-this.y:0},t.prototype.setXCentre=function(t){var n=t-this.cx();this.x+=n,this.X+=n},t.prototype.setYCentre=function(t){var n=t-this.cy();this.y+=n,this.Y+=n},t.prototype.width=function(){return this.X-this.x},t.prototype.height=function(){return this.Y-this.y},t.prototype.union=function(n){return new t(Math.min(this.x,n.x),Math.max(this.X,n.X),Math.min(this.y,n.y),Math.max(this.Y,n.Y))},t.prototype.lineIntersections=function(n,e,r,i){for(var o=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],a=[],s=0;s<4;++s){var u=t.lineIntersection(n,e,r,i,o[s][0],o[s][1],o[s][2],o[s][3]);null!==u&&a.push({x:u.x,y:u.y})}return a},t.prototype.rayIntersection=function(t,n){var e=this.lineIntersections(this.cx(),this.cy(),t,n);return e.length>0?e[0]:null},t.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},t.lineIntersection=function(t,n,e,r,i,o,a,s){var u=e-t,c=a-i,l=r-n,h=s-o,f=h*u-c*l;if(0==f)return null;var p=t-i,y=n-o,d=(c*y-h*p)/f,g=(u*y-l*p)/f;return d>=0&&d<=1&&g>=0&&g<=1?{x:t+d*u,y:n+d*l}:null},t.prototype.inflate=function(n){return new t(this.x-n,this.X+n,this.y-n,this.Y+n)},t}();e.Rectangle=u,e.makeEdgeBetween=function(t,n,e){var r=t.rayIntersection(n.cx(),n.cy())||{x:t.cx(),y:t.cy()},i=n.rayIntersection(t.cx(),t.cy())||{x:n.cx(),y:n.cy()},o=i.x-r.x,a=i.y-r.y,s=Math.sqrt(o*o+a*a),u=s-e;return{sourceIntersection:r,targetIntersection:i,arrowStart:{x:r.x+u*o/s,y:r.y+u*a/s}}},e.makeEdgeTo=function(t,n,e){var r=n.rayIntersection(t.x,t.y);r||(r={x:n.cx(),y:n.cy()});var i=r.x-t.x,o=r.y-t.y,a=Math.sqrt(i*i+o*o);return{x:r.x-e*i/a,y:r.y-e*o/a}};var c=function(t,n,e){this.v=t,this.r=n,this.pos=e,this.prev=f(),this.next=f()},l=function(t,n,e){this.isOpen=t,this.v=n,this.pos=e};function h(t,n){return t.pos>n.pos?1:t.pos<n.pos||t.isOpen?-1:n.isOpen?1:0}function f(){return new a.RBTree((function(t,n){return t.pos-n.pos}))}var p={getCentre:function(t){return t.cx()},getOpen:function(t){return t.y},getClose:function(t){return t.Y},getSize:function(t){return t.width()},makeRect:function(t,n,e,r){return new u(e-r/2,e+r/2,t,n)},findNeighbours:function(t,n){var e=function(e,r){for(var i,o=n.findIter(t);null!==(i=o[e]());){var a=i.r.overlapX(t.r);if((a<=0||a<=i.r.overlapY(t.r))&&(t[e].insert(i),i[r].insert(t)),a<=0)break}};e("next","prev"),e("prev","next")}},y={getCentre:function(t){return t.cy()},getOpen:function(t){return t.x},getClose:function(t){return t.X},getSize:function(t){return t.height()},makeRect:function(t,n,e,r){return new u(t,n,e-r/2,e+r/2)},findNeighbours:function(t,n){var e=function(e,r){var i=n.findIter(t)[e]();null!==i&&i.r.overlapX(t.r)>0&&(t[e].insert(i),i[r].insert(t))};e("next","prev"),e("prev","next")}};function d(t,n,e,r){void 0===r&&(r=!1);var i=t.padding,o=void 0!==t.groups?t.groups.length:0,a=void 0!==t.leaves?t.leaves.length:0,s=o?t.groups.reduce((function(t,r){return t.concat(d(r,n,e,!0))}),[]):[],u=(r?2:0)+a+o,c=new Array(u),l=new Array(u),h=0,f=function(t,n){l[h]=t,c[h++]=n};if(r){var p=t.bounds,y=n.getCentre(p),v=n.getSize(p)/2,x=n.getOpen(p),m=n.getClose(p),b=y-v+i/2,w=y+v-i/2;t.minVar.desiredPosition=b,f(n.makeRect(x,m,b,i),t.minVar),t.maxVar.desiredPosition=w,f(n.makeRect(x,m,w,i),t.maxVar)}a&&t.leaves.forEach((function(t){return f(t.bounds,t.variable)})),o&&t.groups.forEach((function(t){var e=t.bounds;f(n.makeRect(n.getOpen(e),n.getClose(e),n.getCentre(e),n.getSize(e)),t.minVar)}));var _=g(l,c,n,e);return o&&(c.forEach((function(t){t.cOut=[],t.cIn=[]})),_.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),t.groups.forEach((function(t){var e=(t.padding-n.getSize(t.bounds))/2;t.minVar.cIn.forEach((function(t){return t.gap+=e})),t.minVar.cOut.forEach((function(n){n.left=t.maxVar,n.gap+=e}))}))),s.concat(_)}function g(t,n,e,r){var i,a=t.length,s=2*a;console.assert(n.length>=a);var u=new Array(s);for(i=0;i<a;++i){var p=t[i],y=new c(n[i],p,e.getCentre(p));u[i]=new l(!0,y,e.getOpen(p)),u[i+a]=new l(!1,y,e.getClose(p))}u.sort(h);var d=new Array,g=f();for(i=0;i<s;++i){var v=u[i];if(y=v.v,v.isOpen)g.insert(y),e.findNeighbours(y,g);else{g.remove(y);var x=function(t,n){var i=(e.getSize(t.r)+e.getSize(n.r))/2+r;d.push(new o.Constraint(t.v,n.v,i))},m=function(t,n,e){for(var r,i=y[t].iterator();null!==(r=i[t]());)e(r,y),r[n].remove(y)};m("prev","next",(function(t,n){return x(t,n)})),m("next","prev",(function(t,n){return x(n,t)}))}}return console.assert(0===g.size),d}function v(t,n){return g(t,n,p,1e-6)}function x(t,n){return g(t,n,y,1e-6)}function m(t){return d(t,p,1e-6)}function b(t){return d(t,y,1e-6)}e.generateXConstraints=v,e.generateYConstraints=x,e.generateXGroupConstraints=m,e.generateYGroupConstraints=b,e.removeOverlaps=function(t){var n=t.map((function(t){return new o.Variable(t.cx())})),e=v(t,n),r=new o.Solver(n,e);r.solve(),n.forEach((function(n,e){return t[e].setXCentre(n.position())})),n=t.map((function(t){return new o.Variable(t.cy())})),e=x(t,n),(r=new o.Solver(n,e)).solve(),n.forEach((function(n,e){return t[e].setYCentre(n.position())}))};var w=function(t){function n(n,e){var r=t.call(this,0,e)||this;return r.index=n,r}return i(n,t),n}(o.Variable);e.IndexedVariable=w;var _=function(){function t(t,n,e,r,i){var o=this;if(void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=!1),this.nodes=t,this.groups=n,this.rootGroup=e,this.avoidOverlaps=i,this.variables=t.map((function(t,n){return t.variable=new w(n,1)})),r&&this.createConstraints(r),i&&e&&void 0!==e.groups){t.forEach((function(t){if(t.width&&t.height){var n=t.width/2,e=t.height/2;t.bounds=new u(t.x-n,t.x+n,t.y-e,t.y+e)}else t.bounds=new u(t.x,t.x,t.y,t.y)})),s(e);var a=t.length;n.forEach((function(t){o.variables[a]=t.minVar=new w(a++,void 0!==t.stiffness?t.stiffness:.01),o.variables[a]=t.maxVar=new w(a++,void 0!==t.stiffness?t.stiffness:.01)}))}}return t.prototype.createSeparation=function(t){return new o.Constraint(this.nodes[t.left].variable,this.nodes[t.right].variable,t.gap,void 0!==t.equality&&t.equality)},t.prototype.makeFeasible=function(t){var n=this;if(this.avoidOverlaps){var e="x",r="width";"x"===t.axis&&(e="y",r="height");var i=t.offsets.map((function(t){return n.nodes[t.node]})).sort((function(t,n){return t[e]-n[e]})),o=null;i.forEach((function(t){if(o){var n=o[e]+o[r];n>t[e]&&(t[e]=n)}o=t}))}},t.prototype.createAlignment=function(t){var n=this,e=this.nodes[t.offsets[0].node].variable;this.makeFeasible(t);var r="x"===t.axis?this.xConstraints:this.yConstraints;t.offsets.slice(1).forEach((function(t){var i=n.nodes[t.node].variable;r.push(new o.Constraint(e,i,t.offset,!0))}))},t.prototype.createConstraints=function(t){var n=this,e=function(t){return void 0===t.type||"separation"===t.type};this.xConstraints=t.filter((function(t){return"x"===t.axis&&e(t)})).map((function(t){return n.createSeparation(t)})),this.yConstraints=t.filter((function(t){return"y"===t.axis&&e(t)})).map((function(t){return n.createSeparation(t)})),t.filter((function(t){return"alignment"===t.type})).forEach((function(t){return n.createAlignment(t)}))},t.prototype.setupVariablesAndBounds=function(t,n,e,r){this.nodes.forEach((function(i,o){i.fixed?(i.variable.weight=i.fixedWeight?i.fixedWeight:1e3,e[o]=r(i)):i.variable.weight=1;var a=(i.width||0)/2,s=(i.height||0)/2,c=t[o],l=n[o];i.bounds=new u(c-a,c+a,l-s,l+s)}))},t.prototype.xProject=function(t,n,e){(this.rootGroup||this.avoidOverlaps||this.xConstraints)&&this.project(t,n,t,e,(function(t){return t.px}),this.xConstraints,m,(function(t){return t.bounds.setXCentre(e[t.variable.index]=t.variable.position())}),(function(t){var n=e[t.minVar.index]=t.minVar.position(),r=e[t.maxVar.index]=t.maxVar.position(),i=t.padding/2;t.bounds.x=n-i,t.bounds.X=r+i}))},t.prototype.yProject=function(t,n,e){(this.rootGroup||this.yConstraints)&&this.project(t,n,n,e,(function(t){return t.py}),this.yConstraints,b,(function(t){return t.bounds.setYCentre(e[t.variable.index]=t.variable.position())}),(function(t){var n=e[t.minVar.index]=t.minVar.position(),r=e[t.maxVar.index]=t.maxVar.position(),i=t.padding/2;t.bounds.y=n-i,t.bounds.Y=r+i}))},t.prototype.projectFunctions=function(){var t=this;return[function(n,e,r){return t.xProject(n,e,r)},function(n,e,r){return t.yProject(n,e,r)}]},t.prototype.project=function(t,n,e,r,i,o,a,u,c){this.setupVariablesAndBounds(t,n,r,i),this.rootGroup&&this.avoidOverlaps&&(s(this.rootGroup),o=o.concat(a(this.rootGroup))),this.solve(this.variables,o,e,r),this.nodes.forEach(u),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(c),s(this.rootGroup))},t.prototype.solve=function(t,n,e,r){var i=new o.Solver(t,n);i.setStartingPositions(e),i.setDesiredPositions(r),i.solve()},t}();e.Projection=_},{"./rbtree":16,"./vpsc":19}],18:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./pqueue"),i=function(t,n){this.id=t,this.distance=n},o=function(t){this.id=t,this.neighbours=[]},a=function(t,n,e){this.node=t,this.prev=n,this.d=e},s=function(){function t(t,n,e,r,a){this.n=t,this.es=n,this.neighbours=new Array(this.n);for(var s=this.n;s--;)this.neighbours[s]=new o(s);for(s=this.es.length;s--;){var u=this.es[s],c=e(u),l=r(u),h=a(u);this.neighbours[c].neighbours.push(new i(l,h)),this.neighbours[l].neighbours.push(new i(c,h))}}return t.prototype.DistanceMatrix=function(){for(var t=new Array(this.n),n=0;n<this.n;++n)t[n]=this.dijkstraNeighbours(n);return t},t.prototype.DistancesFromNode=function(t){return this.dijkstraNeighbours(t)},t.prototype.PathFromNodeToNode=function(t,n){return this.dijkstraNeighbours(t,n)},t.prototype.PathFromNodeToNodeWithPrevCost=function(t,n,e){var i=new r.PriorityQueue((function(t,n){return t.d<=n.d})),o=this.neighbours[t],s=new a(o,null,0),u={};for(i.push(s);!i.empty()&&(o=(s=i.pop()).node).id!==n;)for(var c=o.neighbours.length;c--;){var l=o.neighbours[c],h=this.neighbours[l.id];if(!s.prev||h.id!==s.prev.node.id){var f=h.id+","+o.id;if(!(f in u&&u[f]<=s.d)){var p=s.prev?e(s.prev.node.id,o.id,h.id):0,y=s.d+l.distance+p;u[f]=y,i.push(new a(h,s,y))}}}for(var d=[];s.prev;)s=s.prev,d.push(s.node.id);return d},t.prototype.dijkstraNeighbours=function(t,n){void 0===n&&(n=-1);for(var e=new r.PriorityQueue((function(t,n){return t.d<=n.d})),i=this.neighbours.length,o=new Array(i);i--;){var a=this.neighbours[i];a.d=i===t?0:Number.POSITIVE_INFINITY,a.q=e.push(a)}for(;!e.empty();){var s=e.pop();if(o[s.id]=s.d,s.id===n){for(var u=[],c=s;void 0!==c.prev;)u.push(c.prev.id),c=c.prev;return u}for(i=s.neighbours.length;i--;){var l=s.neighbours[i],h=(c=this.neighbours[l.id],s.d+l.distance);s.d!==Number.MAX_VALUE&&c.d>h&&(c.d=h,c.prev=s,e.reduceKey(c.q,c,(function(t,n){return t.q=n})))}}return o},t}();e.Calculator=s},{"./pqueue":15}],19:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.scale=t,this.AB=0,this.AD=0,this.A2=0}return t.prototype.addVariable=function(t){var n=this.scale/t.scale,e=t.offset/t.scale,r=t.weight;this.AB+=r*n*e,this.AD+=r*n*t.desiredPosition,this.A2+=r*n*n},t.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},t}();e.PositionStats=r;var i=function(){function t(t,n,e,r){void 0===r&&(r=!1),this.left=t,this.right=n,this.gap=e,this.equality=r,this.active=!1,this.unsatisfiable=!1,this.left=t,this.right=n,this.gap=e,this.equality=r}return t.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},t}();e.Constraint=i;var o=function(){function t(t,n,e){void 0===n&&(n=1),void 0===e&&(e=1),this.desiredPosition=t,this.weight=n,this.scale=e,this.offset=0}return t.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},t.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},t.prototype.visitNeighbours=function(t,n){var e=function(e,r){return e.active&&t!==r&&n(e,r)};this.cOut.forEach((function(t){return e(t,t.right)})),this.cIn.forEach((function(t){return e(t,t.left)}))},t}();e.Variable=o;var a=function(){function t(t){this.vars=[],t.offset=0,this.ps=new r(t.scale),this.addVariable(t)}return t.prototype.addVariable=function(t){t.block=this,this.vars.push(t),this.ps.addVariable(t),this.posn=this.ps.getPosn()},t.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var t=0,n=this.vars.length;t<n;++t)this.ps.addVariable(this.vars[t]);this.posn=this.ps.getPosn()},t.prototype.compute_lm=function(t,n,e){var r=this,i=t.dfdv();return t.visitNeighbours(n,(function(n,o){var a=r.compute_lm(o,t,e);o===n.right?(i+=a*n.left.scale,n.lm=a):(i+=a*n.right.scale,n.lm=-a),e(n)})),i/t.scale},t.prototype.populateSplitBlock=function(t,n){var e=this;t.visitNeighbours(n,(function(n,r){r.offset=t.offset+(r===n.right?n.gap:-n.gap),e.addVariable(r),e.populateSplitBlock(r,t)}))},t.prototype.traverse=function(t,n,e,r){var i=this;void 0===e&&(e=this.vars[0]),void 0===r&&(r=null),e.visitNeighbours(r,(function(r,o){n.push(t(r)),i.traverse(t,n,o,e)}))},t.prototype.findMinLM=function(){var t=null;return this.compute_lm(this.vars[0],null,(function(n){!n.equality&&(null===t||n.lm<t.lm)&&(t=n)})),t},t.prototype.findMinLMBetween=function(t,n){this.compute_lm(t,null,(function(){}));var e=null;return this.findPath(t,null,n,(function(t,n){!t.equality&&t.right===n&&(null===e||t.lm<e.lm)&&(e=t)})),e},t.prototype.findPath=function(t,n,e,r){var i=this,o=!1;return t.visitNeighbours(n,(function(n,a){o||a!==e&&!i.findPath(a,t,e,r)||(o=!0,r(n,a))})),o},t.prototype.isActiveDirectedPathBetween=function(t,n){if(t===n)return!0;for(var e=t.cOut.length;e--;){var r=t.cOut[e];if(r.active&&this.isActiveDirectedPathBetween(r.right,n))return!0}return!1},t.split=function(n){return n.active=!1,[t.createSplitBlock(n.left),t.createSplitBlock(n.right)]},t.createSplitBlock=function(n){var e=new t(n);return e.populateSplitBlock(n,null),e},t.prototype.splitBetween=function(n,e){var r=this.findMinLMBetween(n,e);if(null!==r){var i=t.split(r);return{constraint:r,lb:i[0],rb:i[1]}}return null},t.prototype.mergeAcross=function(t,n,e){n.active=!0;for(var r=0,i=t.vars.length;r<i;++r){var o=t.vars[r];o.offset+=e,this.addVariable(o)}this.posn=this.ps.getPosn()},t.prototype.cost=function(){for(var t=0,n=this.vars.length;n--;){var e=this.vars[n],r=e.position()-e.desiredPosition;t+=r*r*e.weight}return t},t}();e.Block=a;var s=function(){function t(t){this.vs=t;var n=t.length;for(this.list=new Array(n);n--;){var e=new a(t[n]);this.list[n]=e,e.blockInd=n}}return t.prototype.cost=function(){for(var t=0,n=this.list.length;n--;)t+=this.list[n].cost();return t},t.prototype.insert=function(t){t.blockInd=this.list.length,this.list.push(t)},t.prototype.remove=function(t){var n=this.list.length-1,e=this.list[n];this.list.length=n,t!==e&&(this.list[t.blockInd]=e,e.blockInd=t.blockInd)},t.prototype.merge=function(t){var n=t.left.block,e=t.right.block,r=t.right.offset-t.left.offset-t.gap;n.vars.length<e.vars.length?(e.mergeAcross(n,t,r),this.remove(n)):(n.mergeAcross(e,t,-r),this.remove(e))},t.prototype.forEach=function(t){this.list.forEach(t)},t.prototype.updateBlockPositions=function(){this.list.forEach((function(t){return t.updateWeightedPosition()}))},t.prototype.split=function(t){var n=this;this.updateBlockPositions(),this.list.forEach((function(e){var r=e.findMinLM();null!==r&&r.lm<u.LAGRANGIAN_TOLERANCE&&(e=r.left.block,a.split(r).forEach((function(t){return n.insert(t)})),n.remove(e),t.push(r))}))},t}();e.Blocks=s;var u=function(){function t(t,n){this.vs=t,this.cs=n,this.vs=t,t.forEach((function(t){t.cIn=[],t.cOut=[]})),this.cs=n,n.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),this.inactive=n.map((function(t){return t.active=!1,t})),this.bs=null}return t.prototype.cost=function(){return this.bs.cost()},t.prototype.setStartingPositions=function(t){this.inactive=this.cs.map((function(t){return t.active=!1,t})),this.bs=new s(this.vs),this.bs.forEach((function(n,e){return n.posn=t[e]}))},t.prototype.setDesiredPositions=function(t){this.vs.forEach((function(n,e){return n.desiredPosition=t[e]}))},t.prototype.mostViolated=function(){for(var n=Number.MAX_VALUE,e=null,r=this.inactive,i=r.length,o=i,a=0;a<i;++a){var s=r[a];if(!s.unsatisfiable){var u=s.slack();if((s.equality||u<n)&&(n=u,e=s,o=a,s.equality))break}}return o!==i&&(n<t.ZERO_UPPERBOUND&&!e.active||e.equality)&&(r[o]=r[i-1],r.length=i-1),e},t.prototype.satisfy=function(){null==this.bs&&(this.bs=new s(this.vs)),this.bs.split(this.inactive);for(var n=null;(n=this.mostViolated())&&(n.equality||n.slack()<t.ZERO_UPPERBOUND&&!n.active);){var e=n.left.block;if(e!==n.right.block)this.bs.merge(n);else{if(e.isActiveDirectedPathBetween(n.right,n.left)){n.unsatisfiable=!0;continue}var r=e.splitBetween(n.left,n.right);if(null===r){n.unsatisfiable=!0;continue}this.bs.insert(r.lb),this.bs.insert(r.rb),this.bs.remove(e),this.inactive.push(r.constraint),n.slack()>=0?this.inactive.push(n):this.bs.merge(n)}}},t.prototype.solve=function(){this.satisfy();for(var t=Number.MAX_VALUE,n=this.bs.cost();Math.abs(t-n)>1e-4;)this.satisfy(),t=n,n=this.bs.cost();return n},t.LAGRANGIAN_TOLERANCE=-1e-4,t.ZERO_UPPERBOUND=-1e-10,t}();e.Solver=u,e.removeOverlapInOneDimension=function(t,n,e){for(var r=t.map((function(t){return new o(t.desiredCenter)})),a=[],s=t.length,c=0;c<s-1;c++){var l=t[c],h=t[c+1];a.push(new i(r[c],r[c+1],(l.size+h.size)/2))}var f=r[0],p=r[s-1],y=t[0].size/2,d=t[s-1].size/2,g=null,v=null;return n&&(g=new o(n,1e3*f.weight),r.push(g),a.push(new i(g,f,y))),e&&(v=new o(e,1e3*p.weight),r.push(v),a.push(new i(p,v,d))),new u(r,a).solve(),{newCenters:r.slice(0,t.length).map((function(t){return t.position()})),lowerBound:g?g.position():f.position()-y,upperBound:v?v.position():p.position()+d}}},{}]},{},[1])(1)},"object"===s(n)&&void 0!==t?t.exports=a():(i=[],void 0===(o="function"==typeof(r=a)?r.apply(n,i):r)||(t.exports=o))},,function(t,n,e){var r=e(7),i=e(8);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);t.exports=i.locals||{}},function(t,n,e){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[n]=e}return t[n]}}(),a=[];function s(t){for(var n=-1,e=0;e<a.length;e++)if(a[e].identifier===t){n=e;break}return n}function u(t,n){for(var e={},r=[],i=0;i<t.length;i++){var o=t[i],u=n.base?o[0]+n.base:o[0],c=e[u]||0,l="".concat(u," ").concat(c);e[u]=c+1;var h=s(l),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(a[h].references++,a[h].updater(f)):a.push({identifier:l,updater:g(f,n),references:1}),r.push(l)}return r}function c(t){var n=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=e.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){n.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(n);else{var a=o(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}return n}var l,h=(l=[],function(t,n){return l[t]=n,l.filter(Boolean).join("\n")});function f(t,n,e,r){var i=e?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=h(n,i);else{var o=document.createTextNode(i),a=t.childNodes;a[n]&&t.removeChild(a[n]),a.length?t.insertBefore(o,a[n]):t.appendChild(o)}}function p(t,n,e){var r=e.css,i=e.media,o=e.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var y=null,d=0;function g(t,n){var e,r,i;if(n.singleton){var o=d++;e=y||(y=c(n)),r=f.bind(null,e,o,!1),i=f.bind(null,e,o,!0)}else e=c(n),r=p.bind(null,e,n),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else i()}}t.exports=function(t,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=i());var e=u(t=t||[],n);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<e.length;r++){var i=s(e[r]);a[i].references--}for(var o=u(t,n),c=0;c<e.length;c++){var l=s(e[c]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}e=o}}}},function(t,n,e){(n=e(9)(!1)).push([t.i,"/*you need this to stop horrible looking flickering of text as you drag*/\nsvg {\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n}\n\n.highlight {\n    stroke: #ffff99;\n}\n\n.link {\n    stroke-linecap: round;\n    stroke: black;\n}\n\n.certain-link {\n    opacity: 0.6;\n    stroke-opacity: 0.6;\n}\n\n.uncertain-link {\n    opacity: 0.2;\n    stroke-opacity: 0.6;\n}\n\n.link-line {\n    stroke-width: 1;\n}\n\n.link-highlight {\n    stroke-width: 10;\n    stroke-opacity: 0;\n}\n\n.complex-outline {\n    stroke: white;\n    stroke-linejoin: round;\n    stroke-width: 7;\n}\n\n.linked-complex {\n    stroke: black;\n    stroke-linejoin: round;\n    stroke-width: 1;\n}\n\nfeature-link {\n    fill: black;\n}\n\n.protein {\n    cursor: crosshair;\n}\n\n/*todo - seperate out outline*/\n.label {\n    font-size: 10pt;\n    /*font-weight: bold;*/\n\n    /*color: #fff;*/\n    /*text-shadow: white 0px 0px 1px;*/\n    -webkit-font-smoothing: antialiased;\n\n    /*text-shadow: #fff 0px 0px 1px,   #fff 0px 0px 1px,   #fff 0px 0px 1px,*/\n    /*#fff 0px 0px 1px,   #fff 0px 0px 1px,   #fff 0px 0px 1px;*/\n\n    text-shadow: -1px -1px 0 white,\n    1px -1px 0 white,\n    -1px 1px 0 white,\n    1px 1px 0 white;\n       /*-2px -1px 0 white,*/\n       /* 2px -1px 0 white,*/\n       /* -2px 1px 0 white,*/\n       /* 2px 1px 0 white;*/\n    fill: black;\n    text-anchor: end;\n}\n\n.scale-label{\n    text-anchor: middle;\n}\n\n.tooltip{\n    text-anchor: start;\n}\n\n.outline {\n    stroke: black;\n    stroke-width: 1;\n    stroke-opacity: 1;\n    fill: white;\n    fill-opacity: 1;\n}\n\n.participant-highlight {\n    stroke-width: 5;\n    fill: none;\n}\n\n/*for protein bar scale*/\n.tick {\n    stroke: black;\n}\n\n.tick-labels {\n    font-size: 8pt;\n    text-anchor: middle;\n}\n\n/*not working right*/\n.sequence {\n    font-family: 'Courier New', monospace;\n    font-size: 10px;\n    text-anchor: middle;\n}\n\n.custom-menu-margin {\n    padding: 20px;\n    display: none;\n    z-index: 10000;\n    position: absolute;\n}\n\n.custom-menu {\n    overflow: hidden;\n    border: 1px solid #CCC;\n    white-space: nowrap;\n    background: #FFF;\n    color: #333;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    pointer-events: all;\n}\n\n.custom-menu li {\n    padding: 8px 12px;\n    cursor: pointer;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n}\n\n.custom-menu li:hover {\n    background-color: #DEF;\n}\n\n.bar-scale {\n    display: inline;\n    padding-left: 10px;\n}\n\n.tooltip-background {\n    fill-opacity: 0.6;\n    stroke-opacity: 1;\n    stroke-width: 1;\n}\n\n.tooltip-sub-background {\n    fill: white;\n    stroke: white;\n    opacity: 1;\n    stroke-width: 1;\n}\n\n@media only screen and (max-width : 1140px) {\n    .label {\n        text-shadow: none;\n    }\n}\n",""]),t.exports=n},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=function(t,n){var e=t[1]||"",r=t[3];if(!r)return e;if(n&&"function"==typeof btoa){var i=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([i]).join("\n")}var a,s,u;return[e].join("\n")}(n,t);return n[2]?"@media ".concat(n[2]," {").concat(e,"}"):e})).join("")},n.i=function(t,e,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);r&&i[u[0]]||(e&&(u[2]?u[2]="".concat(e," and ").concat(u[2]):u[2]=e),n.push(u))}},n}},function(t,n,e){"use strict";e.r(n),e.d(n,"App",(function(){return lt}));e(6);var r=e(3),i=e(0),o=function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e},a=o("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),s=e(4);function u(t,n){this.description=t.trim(),this.seqDatum=n}u.prototype.toString=function(){return this.description+" ["+(this.seqDatum?this.seqDatum.toString():this.seqDatum.begin+" - "+this.seqDatum.end)+"]"};var c="http://www.w3.org/2000/svg";function l(t,n,e){return e=e/360*Math.PI*2,[Math.cos(e)*(t[0]-n[0])-Math.sin(e)*(t[1]-n[1])+n[0],Math.sin(e)*(t[0]-n[0])+Math.cos(e)*(t[1]-n[1])+n[1]]}function h(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return f(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return f(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function p(){}function y(t,n){var e=n/360*Math.PI*2;return{x:t*Math.cos(e),y:t*Math.sin(e)}}function d(t,n){function e(t){return parseInt(t)?parseInt(t):t}if(this.participant=t,this.sequenceDatumString=n.trim(),"?-?"===this.sequenceDatumString)this.end=1,this.uncertainEnd=t.size?t.size:1;else if("n-n"===this.sequenceDatumString)this.uncertainBegin="n-n",t.nTerminusFeature=!0;else if("c-c"===this.sequenceDatumString)this.uncertainEnd="c-c";else{var r,i=n.indexOf("-"),o=n.substring(0,i),a=n.substring(i+1);-1===o.indexOf(".")?this.begin=e(o):(r=o.indexOf("."),this.uncertainBegin=e(o.substring(0,r)),this.begin=e(o.substring(r+2))),-1===a.indexOf(".")?this.end=e(a):(r=a.indexOf("."),this.end=e(a.substring(0,r)),this.uncertainEnd=e(a.substring(r+2))),"n"===this.begin&&(this.uncertainBegin=1,this.begin=e(this.end),this.end=null),"c"===this.end&&(this.uncertainEnd=t.size,this.end=e(this.begin),this.begin=null),o.indexOf("<")>-1&&(this.uncertainBegin=0,this.begin=e(o.substring(1,o.length))),a.indexOf(">")>-1&&(this.end=e(a.substring(1,o.length)),this.uncertainEnd=t.size),o.indexOf(">")>-1&&a.indexOf("<")>-1&&(this.uncertainBegin=e(o.substring(1,o.length)),this.begin=e(a.substring(1,o.length)),this.end=null)}}function g(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}(t,n)||x(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=x(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function x(t,n){if(t){if("string"==typeof t)return m(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?m(t,n):void 0}}function m(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function b(){}function w(t,n,e,r,i){this.init(t,n,e,r),this.type="protein",this.upperGroup=document.createElementNS(c,"g"),this.rotation=0,this.stickZoom=1,this.highlight=document.createElementNS(c,"rect"),this.highlight.classList.add("highlight","participant-highlight"),this.upperGroup.appendChild(this.highlight),this.background=document.createElementNS(c,"rect"),this.background.setAttribute("fill","#FFFFFF"),this.upperGroup.appendChild(this.background),this.initLabel(),this.ticks=document.createElementNS(c,"g"),this.annotationsSvgGroup=document.createElementNS(c,"g"),this.annotationsSvgGroup.setAttribute("opacity","1"),this.upperGroup.appendChild(this.annotationsSvgGroup),this.outline=document.createElementNS(c,"rect"),this.outline.setAttribute("stroke","black"),this.outline.setAttribute("stroke-width","1"),this.outline.setAttribute("fill","none"),this.upperGroup.appendChild(this.outline),this.scaleLabels=[];var o=this.getSymbolRadius();this.outline.setAttribute("x",-o),this.outline.setAttribute("y",-o),this.outline.setAttribute("width",2*o),this.outline.setAttribute("height",2*o),this.outline.setAttribute("rx",o),this.outline.setAttribute("ry",o),this.background.setAttribute("x",-o),this.background.setAttribute("y",-o),this.background.setAttribute("width",2*o),this.background.setAttribute("height",2*o),this.background.setAttribute("rx",o),this.background.setAttribute("ry",o),this.highlight.setAttribute("width",2*o+5),this.highlight.setAttribute("height",2*o+5),this.highlight.setAttribute("x",-o-2.5),this.highlight.setAttribute("y",-o-2.5),this.highlight.setAttribute("rx",o+2.5),this.highlight.setAttribute("ry",o+2.5),this.highlight.setAttribute("stroke-opacity","0"),this.labelSVG.setAttribute("transform","translate("+-(o+5)+",-5)"),this.initListeners();var a=this;Object.defineProperty(this,"height",{get:function(){return a.expanded?120:40}}),this.showHighlight(!1),i||(i="SEQUENCEMISSING"),this.sequence=i.replace(/[^A-Z]/g,""),this.size=this.sequence.length,this.annotationSets.set("Interactor",[new u(this.json.label,new d(null,"1-"+this.size))])}function _(t,n,e,r){this.init(t,n,e,r),this.upperGroup=document.createElementNS(c,"g"),this.initLabel();this.outline=document.createElementNS(c,"polygon"),this.outline.setAttribute("points","0, -10  8.66,5 -8.66,5"),this.initOutline(),this.initListeners()}function M(t,n,e,r){this.init(t,n,e,r),this.upperGroup=document.createElementNS(c,"g"),this.initLabel(),this.outline=document.createElementNS(c,"rect"),this.outline.setAttribute("x","-16"),this.outline.setAttribute("y","-8"),this.outline.setAttribute("width","32"),this.outline.setAttribute("height","16"),this.outline.setAttribute("rx","6"),this.outline.setAttribute("ry","6"),this.initOutline(),this.initListeners()}function S(t,n,e,r){this.init(t,n,e,r),this.upperGroup=document.createElementNS(c,"g"),this.initLabel();this.outline=document.createElementNS(c,"polygon"),this.outline.setAttribute("points","0, -5  10, -10 0, 10 -10, -10"),this.initOutline(),this.initListeners()}function k(t,n,e,r){this.init(t,n,e,r),this.upperGroup=document.createElementNS(c,"g"),this.initLabel();this.outline=document.createElementNS(c,"polygon"),this.outline.setAttribute("points","0, -10  10, 0 0, 10 -10, 0"),this.initOutline(),this.initListeners()}p.prototype={get width(){return this.expanded?this.size*this.stickZoom+5+this.labelSVG.getComputedTextLength():2*this.getSymbolRadius()+5+this.labelSVG.getComputedTextLength()},get height(){return 40}},p.prototype.init=function(t,n,e,r){this.id=t,this.app=n,this.json=e,this.name=r,this.expanded=!1,this.annotationSets=new Map,this.naryLinks=new Map,this.binaryLinks=new Map,this.sequenceLinks=new Map},p.prototype.initLabel=function(){this.labelSVG=document.createElementNS(c,"text"),this.labelSVG.setAttribute("x","0"),this.labelSVG.setAttribute("y","10"),this.labelSVG.classList.add("label"),this.name?this.labelText=this.name:this.labelText=this.id,this.labelText.length>25&&(this.labelText=this.labelText.substr(0,16)+"..."),this.labelText=this.name,this.labelTextNode=document.createTextNode(this.labelText),this.labelSVG.appendChild(this.labelTextNode),this.labelSVG.setAttribute("transform","translate( -"+this.getSymbolRadius()+" "+"-5)"),this.upperGroup.appendChild(this.labelSVG)},p.prototype.initOutline=function(){this.outline.classList.add("outline"),this.upperGroup.appendChild(this.outline)},p.prototype.initListeners=function(){var t=this;this.upperGroup.onmousedown=function(n){t.mouseDown(n)},this.upperGroup.onmouseenter=function(n){t.mouseOver(n)},this.upperGroup.onmouseleave=function(n){t.mouseOut(n)},this.upperGroup.ontouchstart=function(n){t.touchStart(n)}},p.prototype.addStoichiometryLabel=function(t){this.labelSVG&&(this.labelSVG.childNodes[0].data=this.labelSVG.childNodes[0].data+" ["+t+"]")},p.prototype.mouseDown=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1},p.prototype.touchStart=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1},p.prototype.mouseOver=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.showHighlight(!0),this.app.notifyHoverListeners([this.json.id]),!1},p.prototype.mouseOut=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.showHighlight(!1),this.app.hideTooltip(),this.app.notifyHoverListeners([]),!1},p.prototype.getSymbolRadius=function(){return 15},p.prototype.showHighlight=function(){},p.prototype.getPosition=function(){return[this.ix,this.iy]},p.prototype.setPosition=function(t,n){this.px=this.ix,this.py=this.iy,this.ix=t,this.iy=n,this.upperGroup.setAttribute("transform","translate("+this.ix+" "+this.iy+")")},p.prototype.changePosition=function(t,n){this.px=this.ix,this.py=this.iy,this.ix-=t,this.iy-=n,this.upperGroup.setAttribute("transform","translate("+this.ix+" "+this.iy+")")},p.prototype.getAggregateSelfLinkPath=function(){var t=this.getSymbolRadius()+7,n=y(t,70),e=y(t,20),r=y(t,85),i=y(t,5);return"M 0,0 Q "+r.x+","+-r.y+" "+n.x+","+-n.y+" A "+t+" "+t+" 0 0 1 "+e.x+","+-e.y+" Q "+i.x+","+-i.y+" 0,0"},p.prototype.checkLinks=function(){function t(t){var n,e=h(t.values());try{for(e.s();!(n=e.n()).done;){n.value.check()}}catch(t){e.e(t)}finally{e.f()}}t(this.binaryLinks),t(this.sequenceLinks),this.selfLink&&this.selfLink.check()},p.prototype.setAllLinkCoordinates=function(){var t,n=h(this.naryLinks.values());try{for(n.s();!(t=n.n()).done;){t.value.setLinkCoordinates()}}catch(t){n.e(t)}finally{n.f()}var e,r=h(this.binaryLinks.values());try{for(r.s();!(e=r.n()).done;){e.value.setLinkCoordinates()}}catch(t){r.e(t)}finally{r.f()}this.selfLink&&this.selfLink.setLinkCoordinates();var i,o=h(this.sequenceLinks.values());try{for(o.s();!(i=o.n()).done;){i.value.setLinkCoordinates()}}catch(t){o.e(t)}finally{o.f()}},d.prototype.toString=function(){return this.sequenceDatumString},d.prototype.overlaps=function(t){if(this.participant===t.participant){var n=this.uncertainBegin||this.begin||this.end||this.uncertainEnd,e=this.uncertainEnd||this.end||this.begin||this.uncertainBegin,r=t.uncertainBegin||t.begin||t.end;if(n<=(t.uncertainEnd||t.end||t.begin)&&r<=e)return!0}return!1},b.STICKHEIGHT=20,b.MAXSIZE=0,b.transitionTime=650,b.prototype=new p,b.prototype.getSymbolRadius=function(){return 15},b.prototype.showHighlight=function(t){this.highlight.setAttribute("stroke-opacity",t?"1":"0")},b.minXDist=30,b.prototype.setStickScale=function(t,n){var e=this.stickZoom,r=this.ix-n.x,i=this.iy-n.y,o=r*t/e-r,a=i*t/e-i;0!==this.rotation&&180!==this.rotation||(a=0);var s=this.ix+o,u=this.iy+a;this.stickZoom=t,this.scale(),this.setPosition(s,u),this.setAllLinkCoordinates()},b.prototype.scale=function(){var t=this.size*this.stickZoom;if(this.expanded){var n=i.transform(this.labelSVG.getAttribute("transform")),e=this.app.svgElement.createSVGMatrix().rotate(n.rotate).translate(-(this.size/2*this.stickZoom+(this.nTerminusFeature?25:10)),-5);this.labelSVG.transform.baseVal.initialize(this.app.svgElement.createSVGTransformFromMatrix(e)),this.updateAnnotationRectanglesNoTransition(),i.select(this.background).attr("width",t).attr("x",this.getResXWithStickZoom(.5)),i.select(this.outline).attr("width",t).attr("x",this.getResXWithStickZoom(.5)),i.select(this.highlight).attr("width",t+5).attr("x",this.getResXWithStickZoom(.5)-2.5),this.setScaleGroup()}},b.prototype.setScaleGroup=function(){this.upperGroup.appendChild(this.ticks),this.ticks.textContent="",this.scaleLabels=[];for(var t=-1,n=this.getResXWithStickZoom(this.size),e=1;e<=this.size;e++){if(1===e||e%100==0&&200*this.stickZoom>b.minXDist||e%10==0&&20*this.stickZoom>b.minXDist){var r=this.getResXWithStickZoom(e);(this.stickZoom>=8||1!==e)&&s(this,r),0===(t=(t+1)%2)&&r+b.minXDist<n&&a(this,e,r)}if(this.stickZoom>=8){var i=document.createElementNS(c,"g");i.setAttribute("transform","translate("+this.getResXWithStickZoom(e)+" 0)");var o=document.createElementNS(c,"text");o.classList.add("label","sequence"),o.setAttribute("x","0"),o.setAttribute("y","3"),o.appendChild(document.createTextNode(this.sequence[e-1])),i.appendChild(o),this.scaleLabels.push(o),this.ticks.appendChild(i)}}function a(t,n,e){var r=document.createElementNS(c,"g");r.setAttribute("transform","translate("+e+" 0)");var i=document.createElementNS(c,"text");i.classList.add("label","scale-label"),i.setAttribute("x","0"),i.setAttribute("y",b.STICKHEIGHT+4),i.appendChild(document.createTextNode(n)),r.appendChild(i),t.scaleLabels.push(i),t.ticks.appendChild(r)}function s(t,n){var e=document.createElementNS(c,"line");e.classList.add("tick"),e.setAttribute("x1",n),e.setAttribute("y1","5"),e.setAttribute("x2",n),e.setAttribute("y2","10"),t.ticks.appendChild(e)}a(this,this.size,n),this.stickZoom>=8&&s(this,n)},b.prototype.setForm=function(t,n){!0!==this.busy&&(1===t?this.toStick():this.toCircle(n))},b.prototype.toCircle=function(t){this.busy=!0;var n=this.getSymbolRadius();i.select(this.background).transition().attr("x",-n).attr("y",-n).attr("width",2*n).attr("height",2*n).attr("rx",n).attr("ry",n).duration(b.transitionTime),i.select(this.outline).transition().attr("x",-n).attr("y",-n).attr("width",2*n).attr("height",2*n).attr("rx",n).attr("ry",n).duration(b.transitionTime),i.select(this.highlight).transition().attr("width",2*n+5).attr("height",2*n+5).attr("x",-n-2.5).attr("y",-n-2.5).attr("rx",n+2.5).attr("ry",n+2.5).duration(b.transitionTime);var e=i.interpolate(this.stickZoom,0),r=i.transform(this.labelSVG.getAttribute("transform")).translate[0],o=i.interpolate(r,-(n+5)),a=null,s=null;null!=t&&(a=i.interpolate(this.ix,t.x),s=i.interpolate(this.iy,t.y));var u=this;i.select(this.ticks).transition().attr("opacity",0).duration(b.transitionTime/4).each("end",(function(){i.select(this).selectAll("*").remove()}));var c,l=v(this.annotationSets);try{for(l.s();!(c=l.n()).done;){var h=g(c.value,2),f=h[0],p=h[1];if(!0===this.app.annotationSetsShown.get(f)){var y,d=v(p);try{for(d.s();!(y=d.n()).done;){var x=y.value;if(x.fuzzyStart){var m=x.fuzzyStart;i.select(m).transition().attr("d",this.getAnnotationPieSlicePath(x.seqDatum.uncertainBegin,x.seqDatum.begin,x,!1)).duration(b.transitionTime)}if(x.certain){var w=x.certain;i.select(w).transition().attr("d",this.getAnnotationPieSlicePath(x.seqDatum.begin,x.seqDatum.end,x,!1)).duration(b.transitionTime)}if(x.fuzzyEnd){var _=x.fuzzyEnd;i.select(_).transition().attr("d",this.getAnnotationPieSlicePath(x.seqDatum.end,x.seqDatum.uncertainEnd,x,!1)).duration(b.transitionTime)}}}catch(t){d.e(t)}finally{d.f()}}}}catch(t){l.e(t)}finally{l.f()}var M=this.stickZoom,S=this.rotation,k=i.ease("cubic-in-out");i.timer((function(t){return function t(n){var r=i.transform(u.labelSVG.getAttribute("transform")),c=u.app.svgElement.createSVGMatrix().rotate(r.rotate).translate(o(k(n)),-5);u.labelSVG.transform.baseVal.initialize(u.app.svgElement.createSVGTransformFromMatrix(c)),null!==a&&u.setPosition(a(k(n)),s(k(n)));if(u.stickZoom=e(k(n)),u.setAllLinkCoordinates(),1===n){u.expanded=!1,u.checkLinks();var l,h=v(u.annotationSets);try{for(h.s();!(l=h.n()).done;){var f=g(l.value,2),p=f[0],y=f[1];if(!0===u.app.annotationSetsShown.get(p)){var d,x=v(y);try{for(x.s();!(d=x.n()).done;){var m=d.value;if(m.fuzzyStart){var b=m.fuzzyStart;i.select(b).attr("d",u.getAnnotationPieSlicePath(m.seqDatum.uncertainBegin,m.seqDatum.begin,m))}if(m.certain){var w=m.certain;i.select(w).attr("d",u.getAnnotationPieSlicePath(m.seqDatum.begin,m.seqDatum.end,m))}if(m.fuzzyEnd){var _=m.fuzzyEnd;i.select(_).attr("d",u.getAnnotationPieSlicePath(m.seqDatum.end,m.seqDatum.uncertainEnd,m))}}}catch(t){x.e(t)}finally{x.f()}}}}catch(t){h.e(t)}finally{h.f()}return u.stickZoom=M,u.rotation=S,u.busy=!1,!0}return n>1&&t(1)}(t/b.transitionTime)}))},b.prototype.toStick=function(){this.busy=!0,this.expanded=!0;var t=this.size*this.stickZoom,n=this.getSymbolRadius(),e=i.interpolate(2*n,t),r=i.interpolate(0,this.stickZoom),o=i.interpolate(-(n+5),-(this.size/2*this.stickZoom+(this.nTerminusFeature?25:10))),a=this.stickZoom;this.stickZoom=0,this.checkLinks(),this.stickZoom=a,i.select(this.background).transition().attr("height",b.STICKHEIGHT).attr("y",-b.STICKHEIGHT/2).attr("rx",0).attr("ry",0).duration(b.transitionTime),i.select(this.outline).transition().attr("height",b.STICKHEIGHT).attr("y",-b.STICKHEIGHT/2).attr("rx",0).attr("ry",0).duration(b.transitionTime),i.select(this.highlight).transition().attr("width",t+5).attr("height",b.STICKHEIGHT+5).attr("x",this.getResXWithStickZoom(.5)-2.5).attr("y",-b.STICKHEIGHT/2-2.5).attr("rx",0).attr("ry",0).duration(b.transitionTime);var s,u=v(this.annotationSets);try{for(u.s();!(s=u.n()).done;){var c=g(s.value,2),l=c[0],h=c[1];if(!0===this.app.annotationSetsShown.get(l)){var f,p=v(h);try{for(p.s();!(f=p.n()).done;){var y=f.value;if(y.fuzzyStart){var d=y.fuzzyStart;d.setAttribute("d",this.getAnnotationPieSlicePath(y.seqDatum.uncertainBegin,y.seqDatum.begin,y,!1)),i.select(d).transition().attr("d",this.getAnnotationRectPath(y.seqDatum.uncertainBegin,y.seqDatum.begin,y)).duration(b.transitionTime)}if(y.certain){var x=y.certain,m=y.seqDatum.begin,w=y.seqDatum.end;y.seqDatum.uncertainBegin&&(m+=1),y.seqDatum.uncertainEnd&&(w-=1),x.setAttribute("d",this.getAnnotationPieSlicePath(m,w,y,!1)),i.select(x).transition().attr("d",this.getAnnotationRectPath(m,w,y)).duration(b.transitionTime)}if(y.fuzzyEnd){var _=y.fuzzyEnd;_.setAttribute("d",this.getAnnotationPieSlicePath(y.seqDatum.end,y.seqDatum.uncertainEnd,y,!1)),i.select(_).transition().attr("d",this.getAnnotationRectPath(y.seqDatum.end,y.seqDatum.uncertainEnd,y)).duration(b.transitionTime)}}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){u.e(t)}finally{u.f()}var M=this,S=i.ease("cubic-in-out");i.timer((function(t){return function t(n){var a=i.transform(M.labelSVG.getAttribute("transform")),s=M.app.svgElement.createSVGMatrix().rotate(a.rotate).translate(o(S(n)),-5);M.labelSVG.transform.baseVal.initialize(M.app.svgElement.createSVGTransformFromMatrix(s));var u=e(S(n));return i.select(M.highlight).attr("width",u).attr("x",-u/2+.5*M.stickZoom),i.select(M.outline).attr("width",u).attr("x",-u/2+.5*M.stickZoom),i.select(M.background).attr("width",u).attr("x",-u/2+.5*M.stickZoom),M.stickZoom=r(S(n)),M.setAllLinkCoordinates(),1===n?(M.updateAnnotationRectanglesNoTransition(),M.busy=!1,!0):n>1&&t(1)}(t/b.transitionTime)})),i.select(this.ticks).attr("opacity",0),this.setScaleGroup(),i.select(this.ticks).transition().attr("opacity",1).delay(.8*b.transitionTime).duration(b.transitionTime/2)},b.prototype.toStickNoTransition=function(){this.busy=!0,this.expanded=!0;var t=this.size*this.stickZoom,n=this.getSymbolRadius(),e=i.interpolate(2*n,t),r=i.interpolate(-(n+5),-(this.size/2*this.stickZoom+(this.nTerminusFeature?25:10)));this.checkLinks(),i.select(this.background).attr("height",b.STICKHEIGHT).attr("y",-b.STICKHEIGHT/2).attr("rx",0).attr("ry",0),i.select(this.outline).attr("height",b.STICKHEIGHT).attr("y",-b.STICKHEIGHT/2).attr("rx",0).attr("ry",0),i.select(this.highlight).attr("width",t+5).attr("height",b.STICKHEIGHT+5).attr("x",this.getResXWithStickZoom(.5)-2.5).attr("y",-b.STICKHEIGHT/2-2.5).attr("rx",0).attr("ry",0);this.updateAnnotationRectanglesNoTransition();var o=i.transform(this.labelSVG.getAttribute("transform")),a=this.app.svgElement.createSVGMatrix().rotate(o.rotate).translate(r(1),-5);this.labelSVG.transform.baseVal.initialize(this.app.svgElement.createSVGTransformFromMatrix(a));var s=e(1);i.select(this.highlight).attr("width",s).attr("x",-s/2+.5*this.stickZoom),i.select(this.outline).attr("width",s).attr("x",-s/2+.5*this.stickZoom),i.select(this.background).attr("width",s).attr("x",-s/2+.5*this.stickZoom),this.setAllLinkCoordinates(),this.setScaleGroup(),i.select(this.ticks).attr("opacity",1),this.busy=!1},b.prototype.updateAnnotationRectanglesNoTransition=function(){var t,n=v(this.annotationSets);try{for(n.s();!(t=n.n()).done;){var e=g(t.value,2),r=e[0],o=e[1];if(!0===this.app.annotationSetsShown.get(r)){var a,s=v(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.fuzzyStart){var c=u.fuzzyStart;i.select(c).attr("d",this.getAnnotationRectPath(u.seqDatum.uncertainBegin,u.seqDatum.begin,u))}if(u.certain){var l=u.seqDatum.begin,h=u.seqDatum.end;u.seqDatum.uncertainBegin&&(l+=1),u.seqDatum.uncertainEnd&&(h-=1),u.certain.setAttribute("d",this.getAnnotationRectPath(l,h,u))}if(u.fuzzyEnd){var f=u.fuzzyEnd;i.select(f).attr("d",this.getAnnotationRectPath(u.seqDatum.end,u.seqDatum.uncertainEnd,u))}}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){n.e(t)}finally{n.f()}},b.prototype.getResXWithStickZoom=function(t){return"n-n"===t?-this.size/2*this.stickZoom-20:"c-c"===t?this.size/2*this.stickZoom+20:(t-this.size/2)*this.stickZoom},b.prototype.getResidueCoordinates=function(t,n){void 0===t&&console.error("ERROR: residue number is undefined");var e,r=this.getResXWithStickZoom(1*t);if(0!==r){var i=Math.abs(r),o=Math.acos(r/i),a=this.rotation/360*Math.PI*2;r=i*Math.cos(a+o),e=i*Math.sin(a+o),void 0!==n&&(r+=n*Math.cos(a+Math.PI/2),e+=n*Math.sin(a+Math.PI/2))}else e=n;return[r+=this.ix,e+=this.iy]},b.prototype.clearPositionalFeatures=function(){this.annotations=[],this.annotationTypes=[],this.annotationsSvgGroup.textContent=""},b.prototype.updatePositionalFeatures=function(){var t=this,n=function(n){var e=n.target.correspondingUseElement?n.target.correspondingUseElement:n.target;t.app.preventDefaultsAndStopPropagation(n),t.app.setTooltip(e.name,e.getAttribute("fill")),t.showHighlight(!0)},e=-1,r=[];function i(t,n){var e,r=v(t);try{for(r.s();!(e=r.n()).done;){if(e.value.seqDatum.overlaps(n.seqDatum))return!0}}catch(t){r.e(t)}finally{r.f()}return!1}var o,a=v(this.annotationSets);try{for(a.s();!(o=a.n()).done;){var s=g(o.value,2),u=s[0],l=s[1];if(!0===this.app.annotationSetsShown.get(u)){l&&l.length>0&&(r[++e]=[]);var h,f=new Set,p=v(Array.from(l.values()).sort((function(t,n){var e=t.description,r=n.description;return e<r?-1:e>r?1:0})));try{for(p.s();!(h=p.n()).done;){var y=h.value;if(!f.has(y.toString()))if(f.add(y.toString()),"n-n"===y.seqDatum.sequenceDatumString||"c-c"===y.seqDatum.sequenceDatumString)y.rung=-1;else{var d=r[e];i(d,y)&&(r[++e]=[],d=r[e]),y.rung=e,d.push(y)}}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){a.e(t)}finally{a.f()}this.rungCount=e+1;var x,m=v(this.annotationSets);try{for(m.s();!(x=m.n()).done;){var b=g(x.value,2),w=b[0],_=b[1];if(!0===this.app.annotationSetsShown.get(w)){var M,S=new Set,k=v(_.values());try{for(k.s();!(M=k.n()).done;){var E=M.value;if(!S.has(E.toString())){S.add(E.toString());var A=E.toString();if(E.seqDatum.uncertainBegin&&(E.fuzzyStart=document.createElementNS(c,"path"),this.expanded?E.fuzzyStart.setAttribute("d",this.getAnnotationRectPath(E.seqDatum.uncertainBegin,E.seqDatum.begin,E)):E.fuzzyStart.setAttribute("d",this.getAnnotationPieSlicePath(E.seqDatum.uncertainBegin,E.seqDatum.begin,E)),E.fuzzyStart.setAttribute("stroke-width","1"),E.fuzzyStart.setAttribute("fill-opacity","0.6"),E.fuzzyStart.name=A,E.fuzzyStart.onmouseover=n,this.annotationsSvgGroup.appendChild(E.fuzzyStart)),E.seqDatum.begin&&E.seqDatum.end){E.certain=document.createElementNS(c,"path");var L=E.seqDatum.begin,N=E.seqDatum.end;E.seqDatum.uncertainBegin&&(L+=1),E.seqDatum.uncertainEnd&&(N-=1),this.expanded?E.certain.setAttribute("d",this.getAnnotationRectPath(L,N,E)):E.certain.setAttribute("d",this.getAnnotationPieSlicePath(L,N,E)),E.certain.setAttribute("stroke-width","1"),E.certain.name=A,E.certain.onmouseover=n,this.annotationsSvgGroup.appendChild(E.certain)}E.seqDatum.uncertainEnd&&(E.fuzzyEnd=document.createElementNS(c,"path"),this.expanded?E.fuzzyEnd.setAttribute("d",this.getAnnotationRectPath(E.seqDatum.end,E.seqDatum.uncertainEnd,E)):E.fuzzyEnd.setAttribute("d",this.getAnnotationPieSlicePath(E.seqDatum.end,E.seqDatum.uncertainEnd,E)),E.fuzzyEnd.setAttribute("stroke-width","1"),E.fuzzyEnd.setAttribute("fill-opacity","0.6"),E.fuzzyEnd.name=A,E.fuzzyEnd.onmouseover=n,this.annotationsSvgGroup.appendChild(E.fuzzyEnd))}}}catch(t){k.e(t)}finally{k.f()}}}}catch(t){m.e(t)}finally{m.f()}},b.stepsInArc=5,b.prototype.getAnnotationPieSlicePath=function(t,n,e){var r,i,o,a,s,u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=this.getSymbolRadius(),h=e.rung;-1===h?(i=0,r=c):r=(i=h*(o=c/this.rungCount))+o,"n-n"===t?(a=-20,s=0):"c-c"===n?(a=0,s=20):(a=(t-1)/this.size*360,s=(n-1)/this.size*360);var f=0;(s-a>180||s===a)&&(f=1);var p=l([0,i],[0,0],a-180),y=l([0,r],[0,0],a-180),d=l([0,r],[0,0],s-180),g=l([0,i],[0,0],s-180),v="M"+p[0]+","+p[1]+" L"+y[0]+","+y[1];if(u)v+=" A"+r+","+r+" 0 "+f+" 1 "+d[0]+","+d[1];else for(var x=0;x<=b.stepsInArc;x++){var m=a+(s-a)/b.stepsInArc*x,w=l([0,r],[0,0],m-180);v+=" L"+w[0]+","+w[1]}if(u)v+=" L"+g[0]+","+g[1],v+=" A"+i+","+i+" 0 "+f+" 0 "+p[0]+","+p[1];else for(var _=b.stepsInArc;_>=0;_--){var M=a+(s-a)/b.stepsInArc*_,S=l([0,i],[0,0],M-180);v+=" L"+S[0]+","+S[1]}return v+=" Z"},b.prototype.getAnnotationRectPath=function(t,n,e){var r,i,o,a,s,u=e.rung;-1===u?(i=b.STICKHEIGHT/2,r=-b.STICKHEIGHT/2):(o=b.STICKHEIGHT/this.rungCount,i=(r=-b.STICKHEIGHT/2+u*o)+o),"n-n"===t?(a=this.getResXWithStickZoom(.5)-20,s=20):"c-c"===n?(a=this.getResXWithStickZoom(this.size+.5),s=20):(a=this.getResXWithStickZoom(t-.5),s=(n-t+1)*this.stickZoom);for(var c="M"+a+","+i+" L"+a+","+r,l=0;l<=b.stepsInArc;l++){c+=" L "+(a+s*(l/b.stepsInArc))+","+r}for(var h=b.stepsInArc;h>=0;h--){c+=" L "+(a+s*(h/b.stepsInArc))+","+i}return c+=" Z"},w.prototype=new b,_.prototype=new p,M.prototype=new p,M.prototype.getSymbolRadius=function(){return 21},S.prototype=new p,k.prototype=new p;var E=e(1),A=e(2);function L(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return N(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function N(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function C(t,n){this.init(t,n),this.type="complex",this.padding=22}function P(t,n,e,r){this.init(t,n,r,e),this.upperGroup=document.createElementNS(c,"g"),this.initLabel();this.outline=document.createElementNS(c,"polygon"),this.outline.setAttribute("points","15,0 8,-13 -7,-13 -15,0 -8,13 7,13"),this.initOutline(),this.initListeners()}function T(t,n,e,r){this.init(t,n,e,r),this.upperGroup=document.createElementNS(c,"g"),this.initLabel(),this.outline=document.createElementNS(c,"rect"),this.outline.setAttribute("x","-20"),this.outline.setAttribute("y","-10"),this.outline.setAttribute("width","40"),this.outline.setAttribute("height","20"),this.outline.setAttribute("rx","5"),this.outline.setAttribute("ry","5"),this.outline.setAttribute("stroke","black"),this.outline.setAttribute("stroke-width","4"),this.outline.setAttribute("stroke-opacity","1"),this.outline.setAttribute("fill-opacity","1"),this.outline.setAttribute("fill","#ffffff"),this.upperGroup.appendChild(this.outline),this.upperLine=document.createElementNS(c,"rect"),this.upperLine.setAttribute("x","-20"),this.upperLine.setAttribute("y","-10"),this.upperLine.setAttribute("width","40"),this.upperLine.setAttribute("height","20"),this.upperLine.setAttribute("rx","5"),this.upperLine.setAttribute("ry","5"),this.upperLine.setAttribute("stroke","white"),this.upperLine.setAttribute("stroke-width","2"),this.upperLine.setAttribute("stroke-opacity","1"),this.upperLine.setAttribute("fill","none"),this.upperGroup.appendChild(this.upperLine),this.initListeners()}function I(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return z(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function z(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function D(){}function O(t,n){this.id=t,this.participants=[],this.sequenceLinks=new Map,this.binaryLinks=new Map,this.unaryLinks=new Map,this.app=n,this.initSVG()}function q(t,n,e,r){this.init(t,n,e,r)}function R(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return j(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function j(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function G(t,n,e,r){this.id=t,this.participants=[e,r],this.sequenceLinks=new Map,this.app=n,this.line=document.createElementNS(c,"line"),this.highlightLine=document.createElementNS(c,"line"),this.initSVG()}function V(t,n,e){this.id=t,this.participants=[e],this.sequenceLinks=new Map,this.app=n,this.line=document.createElementNS(c,"path"),this.highlightLine=document.createElementNS(c,"path"),this.initSVG()}function B(t){var n=t.data.filter((function(t){return"interaction"===t.object})),e=t.data.filter((function(t){return"interactor"===t.object})),r=[];return n.forEach((function(t){t.participants.filter((function(t){if(t.stoichiometry>1)return t})).forEach((function(n){if(F(e,"id",n.interactorRef))for(var i=function(e){var i=JSON.parse(JSON.stringify(n));i.id=i.id+"_"+e,i.cloneParentID=n.id,i.cloneIteration=e,n.cloned=!0,i.features&&i.features.forEach((function(t){t.clonedfrom=t.id,t.id=t.id+"_"+e,t.sequenceData.forEach((function(t){t.participantRef=i.id}))})),t.participants.push(i),r.push(i)},o=0;o<n.stoichiometry-1;o++)i(o)}));var n=new Map;t.participants.forEach((function(t){t.features&&t.features.forEach((function(e){e.parentParticipant=t.id,n.set(e.id,e)}))}));var i=Array.from(n.values());i.forEach((function(n){n.clonedfrom&&i.forEach((function(e){var r=e.linkedFeatures;if(r&&r.indexOf(n.clonedfrom)>-1){var i=JSON.parse(JSON.stringify(e));i.id=e.id+"_"+n.id,i.linkedFeatures=[],i.linkedFeatures.push(n.id),F(t.participants,"id",i.parentParticipant).features.push(i)}}))}))})),n.forEach((function(t){t.participants.forEach((function(t){t.stoichiometry=null}))})),t}function F(t,n,e){for(var r=0;r<t.length;r+=1)if(t[r][n]===e)return t[r]}function H(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return U(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return U(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function U(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,n){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t="object"===X(t)?t:JSON.parse(t)).data=t.data.reverse(),n.features=new Map;var r=new Map;n.proteinCount=0,n.interactors=new Map;var i,o=H(t.data);try{for(o.s();!(i=o.n()).done;){var a=i.value;"interactor"===a.object&&(n.interactors.set(a.id,a),0===a.id.indexOf("uniprotkb_")&&n.proteinCount++)}}catch(t){o.e(t)}finally{o.f()}e?xt():wt();var s,c=H(t.data);try{for(c.s();!(s=c.n()).done;){var l=s.value;if("interaction"===l.object){var h,f=H(l.participants);try{for(f.s();!(h=f.n()).done;){var p=h.value,y=new Array(0);p.features&&(y=p.features);var g,v=H(y);try{for(v.s();!(g=v.n()).done;){var x=g.value,m=x.sequenceData;if(x.linkedFeatures)for(var b=x.linkedFeatures,E=b.length,A=0;A<E;A++){var L,N=new Map,I=n.features.get(b[A]),z=H(I.sequenceData);try{for(z.s();!(L=z.n()).done;){var D=L.value,R=D.interactorRef;e&&(R=R+"("+D.participantRef+")");var j=N.get(R);void 0===j&&(j=[],N.set(R,j)),j=j.push(D)}}catch(t){z.e(t)}finally{z.f()}var F,U=H(N.values());try{for(U.s();!(F=U.n()).done;){var Z=F.value,Y=Mt(m[0]),K=Mt(Z[0]),W=void 0;W=Y===K?kt(Y,l):Et(Y,K,l);var $=St(m,Z,l);Y.sequenceLinks.set($.id,$),K.sequenceLinks.set($.id,$),W.sequenceLinks.set($.id,$)}}catch(t){U.e(t)}finally{U.f()}}}}catch(t){v.e(t)}finally{v.f()}}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){c.e(t)}finally{c.f()}n.complexes=Array.from(r.values());for(var J=0;J<n.complexes.length;J++){var Q=n.complexes[J],tt=void 0;tt=e?Q.id.substring(0,Q.id.indexOf("(")):Q.id;var nt,et=H(t.data);try{for(et.s();!(nt=et.n()).done;){var rt=nt.value;if("interaction"===rt.object&&rt.id===tt){var it=_t(rt),ot=n.allNaryLinks.get(it);Q.initLink(ot),ot.complex=Q}}}catch(t){et.e(t)}finally{et.f()}}var at,st=H(n.features.values());try{for(st.s();!(at=st.n()).done;){var ut=at.value,ct="";if(void 0!==ut.name&&(ct+=ut.name+" "),void 0!==ut.detmethod&&(ct+=", "+ut.detmethod.name),ut.sequenceData){var lt,ht=H(ut.sequenceData);try{for(ht.s();!(lt=ht.n()).done;){var ft=lt.value,pt=ft.interactorRef;e&&(pt=pt+"("+ft.participantRef+")");var yt=n.participants.get(pt),dt=new d(yt,ft.pos),gt=new u(ct,dt),vt=yt.annotationSets.get("MI Features");vt||(vt=[],yt.annotationSets.set("MI Features",vt)),vt.push(gt)}}catch(t){ht.e(t)}finally{ht.f()}}}}catch(t){st.e(t)}finally{st.f()}function xt(){var e,r=0,i=H(t.data);try{for(i.s();!(e=i.n()).done;){var o=e.value;if("interaction"===o.object){var a,s=H(o.participants);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.stoichiometry&&u.stoichiometry-0>r&&(r=u.stoichiometry-0)}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){i.e(t)}finally{i.f()}r<30&&(t=B(t)),bt();var c,l=H(t.data);try{for(l.s();!(c=l.n()).done;){var h=c.value;if("interaction"===h.object){var f=h.id||_t(h),p=n.allNaryLinks.get(f);void 0===p&&(p=new O(f,n),n.allNaryLinks.set(f,p),h.naryId=f);var y,d=H(h.participants);try{for(d.s();!(y=d.n()).done;){var g=y.value,v=g.interactorRef,x=v+"("+g.id+")",m=n.participants.get(x);if(void 0===m)m=mt(n.interactors.get(v),x,v),n.participants.set(x,m);if(m.naryLinks.set(f,p),-1===p.participants.indexOf(m)&&p.participants.push(m),g.stoichiometry)n.participants.get(x).addStoichiometryLabel(g.stoichiometry)}}catch(t){d.e(t)}finally{d.f()}}}}catch(t){l.e(t)}finally{l.f()}}function mt(e,i,o){var a;if(void 0===e||"MI:1302"===e.type.id){var s,u=!1,c=H(t.data);try{for(c.s();!(s=c.n()).done;){var l=s.value;if("interaction"===l.object&&l.id===o){u=!0;break}}}catch(t){c.e(t)}finally{c.f()}u?(a=new C(i,n,o),r.set(i,a)):a=new P(i,n,o,e)}else"MI:1304"===e.type.id||"MI:1305"===e.type.id||"MI:1307"===e.type.id||"MI:1306"===e.type.id?a=new T(i,n,e,e.label):"MI:1100"===e.type.id||"MI:0904"===e.type.id||"MI:0328"===e.type.id?a=new _(i,n,e,e.label):"MI:0326"===e.type.id||"MI:0327"===e.type.id?a=new w(i,n,e,e.label,e.sequence):"MI:0250"===e.type.id?a=new M(i,n,e,e.label):"MI:0320"===e.type.id||"MI:0321"===e.type.id||"MI:0322"===e.type.id||"MI:0323"===e.type.id||"MI:2190"===e.type.id||"MI:0324"===e.type.id||"MI:0679"===e.type.id||"MI:0608"===e.type.id||"MI:0611"===e.type.id||"MI:0610"===e.type.id||"MI:0607"===e.type.id||"MI:0609"===e.type.id||"MI:0325"===e.type.id?a=new k(i,n,e,e.label):"MI:0319"===e.type.id||"MI:0681"===e.type.id||"MI:0680"===e.type.id?a=new S(i,n,e,e.label):alert("Unrecognised type:"+e.type.name);return a}function bt(){var e,r=H(t.data);try{for(r.s();!(e=r.n()).done;){var i=e.value;if("interaction"===i.object){var o,a=H(i.participants);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=new Array(0);s.features&&(u=s.features);for(var c=u.length,l=0;l<c;l++){var h,f=u[l],p=H(f.sequenceData);try{for(p.s();!(h=p.n()).done;){var y=h.value;y.interactorRef||(y.interactorRef=s.interactorRef),y.participantRef||(y.participantRef=f.parentParticipant)}}catch(t){p.e(t)}finally{p.f()}n.features.set(f.id,f)}}}catch(t){a.e(t)}finally{a.f()}}}}catch(t){r.e(t)}finally{r.f()}}function wt(){var e,i=H(n.interactors.values());try{for(i.s();!(e=i.n()).done;){var o=e.value,a=o.id,s=mt(o,a);n.participants.set(a,s)}}catch(t){i.e(t)}finally{i.f()}bt();var u,c=H(t.data);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("interaction"===l.object){var h=l.participants,f=h.length,p=_t(l),y=n.allNaryLinks.get(p);void 0===y&&(y=new O(p,n),n.allNaryLinks.set(p,y));for(var d=0;d<f;d++){var g=h[d],v=g.interactorRef,x=n.participants.get(v);void 0===x&&(x=new C(v,n),r.set(v,x),n.participants.set(v,x)),x.naryLinks.set(p,y),-1===y.participants.indexOf(x)&&y.participants.push(x);var m=n.participants.get(v);m.stoich=m.stoich?m.stoich:0,g.stoichiometry?m.stoich+=+g.stoichiometry:m.stoich+=1}for(var b=n.participants.values(),w=b.length,_=0;_<w;_++){var M=b[_];M.addStoichiometryLabel(M.stoich)}}}}catch(t){c.e(t)}finally{c.f()}}function _t(t){if(t.naryId)return t.naryId;for(var n=t.participants,r=n.length,i=new Set,o=0;o<r;o++){var a=n[o].interactorRef;e&&(a=a+"("+n[o].id+")"),i.add(a)}return Array.from(i.values()).sort().join("-")}function Mt(t){var r=t.interactorRef;return e&&(r=r+"("+t.participantRef+")"),n.participants.get(r)}function St(t,r,i){function o(t){for(var n=new Set,r=0;r<t.length;r++){var i=t[r],o=i.interactorRef;e&&(o=o+"("+i.participantRef+")"),o=o+":"+i.pos,n.add(o)}return Array.from(n.values()).sort().join(";")}var a,s=o(t),u=o(r);a=s<u?s+"><"+u:u+"><"+s;var c=n.allSequenceLinks.get(a);if(void 0===c){var l,h=[],f=H(t);try{for(f.s();!(l=f.n()).done;){var p=l.value;h.push(new d(Mt(p),p.pos))}}catch(t){f.e(t)}finally{f.f()}var y,g=[],v=H(r);try{for(v.s();!(y=v.n()).done;){var x=y.value;g.push(new d(Mt(x),x.pos))}}catch(t){v.e(t)}finally{v.f()}c=new q(a,h,g,n,i),n.allSequenceLinks.set(a,c)}var m=_t(i);return n.allNaryLinks.get(m).sequenceLinks.set(a,c),c}function kt(t,e){var r="-"+t.id+"-"+t.id,i=n.allUnaryLinks.get(r);void 0===i&&(i=new V(r,n,t),n.allUnaryLinks.set(r,i),t.appLink=i);var o=_t(e);return n.allNaryLinks.get(o).unaryLinks.set(r,i),i}function Et(t,e,r){var i,o,a;t.id<e.id?(i="-"+t.id+"-"+e.id,o=t,a=e):(i="-"+e.id+"-"+t.id,o=e,a=t);var s=n.allBinaryLinks.get(i);void 0===s&&(s=new G(i,n,o,a),o.binaryLinks.set(i,s),a.binaryLinks.set(i,s),n.allBinaryLinks.set(i,s));var u=_t(r);return n.allNaryLinks.get(u).binaryLinks.set(i,s),s}}C.prototype=new p,C.prototype.initLink=function(t){this.naryLink=t,this.naryLink.path.classList.add("complex-outline")},C.prototype.setLinked=function(){this.naryLink.path2.classList.add("linked-complex")},C.prototype.getPosition=function(t){for(var n=this.naryLink.mapped,e=n.length,r=0,i=0,o=0;o<e;o++)r+=n[o][0],i+=n[o][1];var a=[r/e,i/e];if(t){var s,u=[],c=L(this.naryLink.hull);try{for(c.s();!(s=c.n()).done;){var l=s.value;u.push(new E(l[0],l[1]))}}catch(t){c.e(t)}finally{c.f()}var h=new E(a[0],a[1]),f=new E(t[0],t[1]),p=A.intersectLinePolygon(h,f,u);if(p.points[0])return[p.points[0].x,p.points[0].y];this.setLinked()}return a},C.prototype.setPosition=function(){console.error("bad - called setPosition on ",this)},C.prototype.changePosition=function(t,n){var e,r=L(this.naryLink.participants);try{for(r.s();!(e=r.n()).done;){e.value.changePosition(t,n)}}catch(t){r.e(t)}finally{r.f()}},C.prototype.getResidueCoordinates=function(){return this.getPosition()},P.prototype=new p,P.prototype.getSymbolRadius=function(){return 20},T.prototype=new p,T.prototype.getSymbolRadius=function(){return 25},D.prototype.highlightParticipants=function(t){var n,e=I(this.participants);try{for(e.s();!(n=e.n()).done;){n.value.showHighlight(t)}}catch(t){e.e(t)}finally{e.f()}},D.prototype.initSVG=function(){this.line.classList.add("link","link-line"),this.highlightLine.classList.add("link","highlight","link-highlight");var t=this;this.line.onmousedown=function(n){t.mouseDown(n)},this.line.onmouseover=function(n){t.mouseOver(n)},this.line.onmouseout=function(n){t.mouseOut(n)},this.highlightLine.onmousedown=function(n){t.mouseDown(n)},this.highlightLine.onmouseover=function(n){t.mouseOver(n)},this.highlightLine.onmouseout=function(n){t.mouseOut(n)}},D.prototype.mouseDown=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1},D.prototype.mouseOver=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.setTooltip(this.getToolTip(),this.color),!1},D.prototype.getToolTip=function(){return this.id},D.prototype.mouseOut=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.hideTooltip(),!1},D.prototype.touchStart=function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1},D.prototype.hide=function(){this.highlightLine.remove(),this.line.remove()},O.orbitNodes=20,O.orbitRadius=22,O.prototype=new D,O.prototype.initSVG=function(){this.path=document.createElementNS(c,"path"),this.color=O.naryColors(this.id),this.path.setAttribute("fill",this.color);var t=this;this.path.onmousedown=function(n){t.mouseDown(n)},this.path.onmouseover=function(n){t.mouseOver(n)},this.path.onmouseout=function(n){t.mouseOut(n)},this.path.ontouchstart=function(n){t.touchStart(n)},this.path2=document.createElementNS(c,"path"),this.path2.setAttribute("fill","none"),this.path2.onmousedown=function(n){t.mouseDown(n)},this.path2.onmouseover=function(n){t.mouseOver(n)},this.path2.onmouseout=function(n){t.mouseOut(n)},this.path2.ontouchstart=function(n){t.touchStart(n)}},O.prototype.showHighlight=function(t){this.highlightParticipants(t)},O.prototype.check=function(){return this.show(),!0},O.prototype.show=function(){this.setLinkCoordinates(),this.app.naryLinks.appendChild(this.path),this.app.naryLinks.appendChild(this.path2)},O.prototype.hide=function(){},O.prototype.setLinkCoordinates=function(t){var n=this;this.mapped=this.orbitNodes(this.getMappedCoordinates());var e,r,o=(e=this.mapped,r=i.geom.hull(e),n.hull=r,"M"+r.join("L")+"Z");o&&(this.path.setAttribute("d",o),this.path2.setAttribute("d",o)),this.complex&&!t&&this.complex.setAllLinkCoordinates()},O.prototype.getMappedCoordinates=function(){for(var t=this.participants,n=[],e=t.length,r=0;r<e;r++){var i=t[r];if("complex"===i.type)n=n.concat(this.orbitNodes(i.naryLink.getMappedCoordinates()));else if(i.expanded){var o=i.getResidueCoordinates(0),a=i.getResidueCoordinates(i.size);isNaN(o[0])||isNaN(o[1])||isNaN(a[0])||isNaN(a[1])?n.push(i.getPosition()):(n.push(o),n.push(a))}else n.push(i.getPosition())}return n},O.prototype.orbitNodes=function(t){for(var n=[],e=t.length,r=0;r<e;r++)for(var i=t[r],o=0;o<O.orbitNodes;o++){var a=360/O.orbitNodes*o,s=[i[0]+O.orbitRadius,i[1]];n.push(l(s,i,a))}return n},q.prototype=new D,q.prototype.init=function(t,n,e,r){this.id=t,this.app=r,this.fromSequenceData=n,this.toSequenceData=e,this.participants=[this.fromSequenceData[0].participant,this.toSequenceData[0].participant],this.glyph=document.createElementNS(c,"path"),this.uncertainGlyph=document.createElementNS(c,"path"),this.glyph.classList.add("link","feature-link","certain-link"),this.uncertainGlyph.classList.add("link","feature-link","uncertain-link");var i=this;this.uncertainGlyph.onmousedown=function(t){i.mouseDown(t)},this.uncertainGlyph.onmouseover=function(t){i.mouseOver(t)},this.uncertainGlyph.onmouseout=function(t){i.mouseOut(t)},this.glyph.onmousedown=function(t){i.mouseDown(t)},this.glyph.onmouseover=function(t){i.mouseOver(t)},this.glyph.onmouseout=function(t){i.mouseOut(t)}},q.prototype.check=function(){return!0===this.anyParticipantIsBar()?(this.show(),!0):(this.hide(),!1)},q.prototype.anyParticipantIsBar=function(){for(var t=this.participants.length,n=0;n<t;n++)if(this.participants[n].expanded)return!0;return!1},q.prototype.show=function(){this.setLinkCoordinates();var t=this.app.res_resLinks;this.participants[0]===this.participants[1]&&(t=this.app.selfRes_resLinks),t.appendChild(this.glyph),t.appendChild(this.uncertainGlyph)},q.prototype.hide=function(){this.glyph.remove(),this.uncertainGlyph.remove()},q.prototype.setLinkCoordinates=function(){function t(t){return!isNaN(parseFloat(t))&&isFinite(t)}function n(t,n,e,r,i,o,a){var s,u;return i.expanded?(s=i.getResidueCoordinates(e,o),u=i.getResidueCoordinates(r,o)):u=s=i.getPosition(a)," Q"+n[0]+","+n[1]+" "+s[0]+","+s[1]+" L"+u[0]+","+u[1]+" Q"+n[0]+","+n[1]+" "+t[0]+","+t[1]}function e(t,n){for(var e=null,r=null,i=t.length,o=0;o<i;o++){var a=t[o];if(!isNaN(parseFloat(a.begin))&&isFinite(a.begin)){var s=1*a.begin;(null===e||s<e)&&(e=s)}if(!isNaN(parseFloat(a.uncertainBegin))&&isFinite(a.uncertainBegin)){var u=1*a.uncertainBegin;(null===e||u<e)&&(e=u)}if(!isNaN(parseFloat(a.end))&&isFinite(a.end)){var c=1*a.end;(null===r||c>r)&&(r=c)}if(!isNaN(parseFloat(a.uncertainEnd))&&isFinite(a.uncertainEnd)){var l=1*a.uncertainEnd;(null===r||l>r)&&(r=l)}}return n.getResidueCoordinates((e+r)/2,0)}var r,i,o=this.fromSequenceData[0].participant,a=this.toSequenceData[0].participant;o.expanded&&(r=e(this.fromSequenceData,o)),a.expanded&&(i=e(this.toSequenceData,a)),o.expanded||(r=o.getPosition(i)),a.expanded||(i=a.getPosition(r));var s=r,u=i,c=r[0]-i[0],l=r[1]-i[1],h=Math.atan2(l,c)/(2*Math.PI)*360;h<0&&(h+=360);var f=h-o.rotation;f<0&&(f+=360);var p=10;f<180&&(p=-10);var y=o.rotation/360*Math.PI*2;f>180&&(y-=Math.PI),(f=h-a.rotation)<0&&(f+=360);var d=10;f>180&&(d=-10);var g=a.rotation/360*Math.PI*2;f<180&&(g-=Math.PI);var v=[r[0]+30*Math.sin(y)*this.app.z,r[1]-30*Math.cos(y)*this.app.z];o.expanded||(v=r);var x=[i[0]+30*Math.sin(g)*this.app.z,i[1]-30*Math.cos(g)*this.app.z];a.expanded||(x=i);for(var m,b=[(v[0]+x[0])/2,(v[1]+x[1])/2],w=this.fromSequenceData.length,_=this.toSequenceData.length,M="M"+b[0]+","+b[1],S="M"+b[0]+","+b[1],k=0;k<w;k++)(t((m=this.fromSequenceData[k]).begin)&&t(m.end)||"complex"===o.type)&&(M+=n(b,v,m.begin,m.end,o,p,u)),t(m.uncertainBegin)&&(S+=n(b,v,m.uncertainBegin,m.begin,o,p,u)),t(m.uncertainEnd)&&(S+=n(b,v,m.end,m.uncertainEnd,o,p,u));for(var E=0;E<_;E++)(t((m=this.toSequenceData[E]).begin)&&t(m.end)||"complex"===a.type)&&(M+=n(b,x,m.begin,m.end,a,d,s)),t(m.uncertainBegin)&&(S+=n(b,x,m.uncertainBegin,m.begin,a,d,s)),t(m.uncertainEnd)&&(S+=n(b,x,m.end,m.uncertainEnd,a,d,s));this.glyph||this.initSVG(),this.glyph.setAttribute("d",M),this.uncertainGlyph.setAttribute("d",S)},G.prototype=new D,G.prototype.check=function(){return this.participants[0].expanded||this.participants[1].expanded?(this.hide(),!1):(this.show(),!0)},G.prototype.show=function(){this.line.setAttribute("stroke-width",1*this.app.z),this.highlightLine.setAttribute("stroke-width",10*this.app.z),this.setLinkCoordinates(this.participants[0]),this.setLinkCoordinates(this.participants[1]),this.app.highlights.appendChild(this.highlightLine),this.app.p_pLinks.appendChild(this.line)},G.prototype.setLinkCoordinates=function(){void 0===this.line&&this.initSVG();var t,n,e,r,i=this.participants[0].getPosition(),o=this.participants[1].getPosition();if("complex"===this.participants[0].type){t=[];var a,s=R(this.participants[0].naryLink.hull);try{for(s.s();!(a=s.n()).done;){var u=a.value;t.push(new E(u[0],u[1]))}}catch(t){s.e(t)}finally{s.f()}n=new E(i[0],i[1]),e=new E(o[0],o[1]),(r=A.intersectLinePolygon(n,e,t)).points[0]&&(i=[r.points[0].x,r.points[0].y])}if("complex"===this.participants[1].type){t=[];var c,l=R(this.participants[1].naryLink.hull);try{for(l.s();!(c=l.n()).done;){var h=c.value;t.push(new E(h[0],h[1]))}}catch(t){l.e(t)}finally{l.f()}n=new E(i[0],i[1]),e=new E(o[0],o[1]),(r=A.intersectLinePolygon(n,e,t)).points[0]&&(o=[r.points[0].x,r.points[0].y])}this.line.setAttribute("x1",i[0]),this.line.setAttribute("y1",i[1]),this.highlightLine.setAttribute("x1",i[0]),this.highlightLine.setAttribute("y1",i[1]),this.line.setAttribute("x2",o[0]),this.line.setAttribute("y2",o[1]),this.highlightLine.setAttribute("x2",o[0]),this.highlightLine.setAttribute("y2",o[1])},V.prototype=new D,V.prototype.initSelfLinkSVG=function(){var t=this.participants[0].getAggregateSelfLinkPath();this.line.setAttribute("d",t),this.highlightLine.setAttribute("d",t)},V.prototype.check=function(){return this.participants[0].expanded?(this.hide(),!1):(this.show(),!0)},V.prototype.show=function(){this.line.setAttribute("transform","translate("+this.participants[0].ix+" "+this.participants[0].iy+") scale("+this.app.z+")"),this.highlightLine.setAttribute("transform","translate("+this.participants[0].ix+" "+this.participants[0].iy+") scale("+this.app.z+")"),this.app.highlights.appendChild(this.highlightLine),this.app.p_pLinks.appendChild(this.line)},V.prototype.setLinkCoordinates=function(){var t=this.participants[0];this.line.setAttribute("transform","translate("+t.ix+" "+t.iy+") scale("+this.app.z+")"),this.highlightLine.setAttribute("transform","translate("+t.ix+" "+t.iy+") scale("+this.app.z+")")};var Y=o("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function K(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}(t,n)||$(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=$(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function $(t,n){if(t){if("string"==typeof t)return J(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?J(t,n):void 0}}function J(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Q(t,n){var e="https://www.ebi.ac.uk/proteins/api/proteins/"+t.json.identifier.id.trim();i.json(e,(function(e){var r=t.annotationSets.get("UniprotKB");void 0===r&&(r=[],t.annotationSets.set("UniprotKB",r));var i,o=W(e.features.filter((function(t){return"DOMAIN"===t.type})));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=new u(a.description,new d(null,a.begin+"-"+a.end));r.push(s)}}catch(t){o.e(t)}finally{o.f()}n()}))}function tt(t,n){var e="https://supfam.mrc-lmb.cam.ac.uk/SUPERFAMILY/cgi-bin/das/up/features?segment="+t.json.identifier.id.trim();i.xml(e,(function(e){var r=t.annotationSets.get("Superfamily");void 0===r&&(r=[],t.annotationSets.set("Superfamily",r));var i,o=W((new DOMParser).parseFromString((new XMLSerializer).serializeToString(e),"text/xml").getElementsByTagName("FEATURE"));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.getElementsByTagName("TYPE")[0];if("miscellaneous"===s.getAttribute("category")){var c=s.getAttribute("id"),l=a.getElementsByTagName("START")[0].textContent,h=a.getElementsByTagName("END")[0].textContent;r.push(new u(c,new d(null,l+"-"+h)))}}}catch(t){o.e(t)}finally{o.f()}n()}))}function nt(t){var n,e,r=new Set,o=W(t.participants.values());try{for(o.s();!(n=o.n()).done;){var a,s=W(n.value.annotationSets);try{for(s.s();!(a=s.n()).done;){var u=K(a.value,2),c=u[0],l=u[1];if(!0===t.annotationSetsShown.get(c)){var h,f=W(l.values());try{for(f.s();!(h=f.n()).done;){var p=h.value;r.add(p.description)}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){s.e(t)}finally{s.f()}}}catch(t){o.e(t)}finally{o.f()}e=r.size<11?i.scale.ordinal().range(Y):i.scale.category20();var y,d=W(t.participants.values());try{for(d.s();!(y=d.n()).done;){var g,v=W(y.value.annotationSets);try{for(v.s();!(g=v.n()).done;){var x=K(g.value,2),m=x[0],b=x[1];if(!0===t.annotationSetsShown.get(m)){var w,_=W(b);try{for(_.s();!(w=_.n()).done;){var M=w.value,S=void 0;S="No annotations"===M.description?"#eeeeee":e(M.description),t.createHatchedFill("checkers_"+M.description+"_"+S.toString(),S);var k="url('#checkers_"+M.description+"_"+S.toString()+"')";M.fuzzyStart&&(M.fuzzyStart.setAttribute("fill",k),M.fuzzyStart.setAttribute("stroke",S)),M.certain&&(M.certain.setAttribute("fill",S),M.certain.setAttribute("stroke",S)),M.fuzzyEnd&&(M.fuzzyEnd.setAttribute("fill",k),M.fuzzyEnd.setAttribute("stroke",S))}}catch(t){_.e(t)}finally{_.f()}}}}catch(t){v.e(t)}finally{v.f()}}}catch(t){d.e(t)}finally{d.f()}t.featureColors=e}var et={capture:function(t){return t.map((function(t){return et.makeSVGDoc(t)}))},getAllSVGElements:function(){var t=[].slice.apply(document.getElementsByTagName("iframe")),n=[document];t.forEach((function(t){try{n.push(t.contentDocument||t.contentWindow.document)}catch(n){console.log("Protected cross-domain IFrame",t)}}));var e=[];return n.forEach((function(t){var n=[].slice.apply(t.getElementsByTagName("svg"));e.push.apply(e,n)})),e},makeSVGDoc:function(t){var n=t.cloneNode(!0),e=n.ownerDocument||document;et.pruneInvisibleSubtrees(n,t);for(var r=et.usedStyles(t,!0,!0),i=et.parentChain(t,r),o=function(t,n,e,r){t.appendChild(n),Object.keys(r).forEach((function(i){var o=n.getAttribute(i)||n.style[i]||et.getComputedStyleCssText(e,i);if(null!=o){t.setAttribute(i,o);var a=r[i];a.replace?n.setAttribute(i,a.replace):a.delete&&n.removeAttribute(i)}}))},a={width:{replace:"100%"},height:{replace:"100%"},xmlns:{delete:!0}},s=!1,u=0;u<i.length;u++){var c=i[u],l=e.createElementNS("http://www.w3.org/2000/svg","svg"),h=!0;Object.keys(c).forEach((function(t){c[t]&&(l.setAttribute(t,c[t]),h=!1)})),h||(o(l,n,t,a),n=l,s=!0)}null==t.parentNode||s||(o(l=e.createElementNS("http://www.w3.org/2000/svg","svg"),n,t,a),n=l,s=!0);s&&n.setAttribute("style",et.getComputedStyleCssText(t)),n.setAttribute("version","1.1"),n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");var f=e.createElement("style");f.setAttribute("type","text/css");var p=e.createTextNode(r.join("\n"));return f.appendChild(p),n.insertBefore(f,n.firstChild),n},getComputedStyleCssText:function(t,n){var e=window.getComputedStyle(t);if(n)return e[n];if(""!=e.cssText)return e.cssText;for(var r="",i=0;i<e.length;i++){var o=e[i];r+=o+": "+e.getPropertyValue(o)+"; "}return r},doPruneInvisible:!0,pruneConditionSets:[{display:"none"},{visibility:"hidden"},{opacity:"0"},{"fill-opacity":"0","stroke-opacity":"0"},{"fill-opacity":"0",stroke:"none"},{fill:"none","stroke-opacity":"0"}],pruneInvisibleSubtrees:function(t,n){if(et.doPruneInvisible){var e=window.getComputedStyle(n),r=!1;if(et.pruneConditionSets.forEach((function(t){if(!r){var i=!0;Object.keys(t).forEach((function(r){var o=t[r],a=e[r],s=n.getAttribute(r);a===o||!a&&s===o||(i=!1)})),r=i}})),r&&t.parentNode)t.parentNode.removeChild(t);else{var i=t.children,o=n.children;if(i&&i.length)for(var a=i.length;--a>=0;)et.pruneInvisibleSubtrees(i[a],o[a])}}},parentChain:function(t,n){for(var e=t.ownerDocument||document,r=[];t.parentNode!==e&&null!==t.parentNode;)t=t.parentNode,r.push({id:t.id,class:t.getAttribute("class")||""});return r.forEach((function(t){var e={id:!1,class:!1},r=t.class.split(" ").filter((function(t){return t.length>0}));n.forEach((function(n){for(var i=0;i<r.length;i++)if(n.indexOf("."+r[i])>=0){e.class=!0;break}t.id&&n.indexOf("#"+t.id)>=0&&(e.id=!0)})),Object.keys(e).forEach((function(n){e[n]||(t[n]=void 0)}))})),r},usedStyles:function(t,n,e){for(var r,i=[],o=(t.ownerDocument||document).styleSheets,a=0;a<o.length;a++){try{if(null==o[a].cssRules)continue}catch(t){continue}for(var s=0;s<o[a].cssRules.length;s++){r=o[a].cssRules[s];var u=!1;try{n&&(u=t.querySelectorAll(r.selectorText).length>0),n&&!e||(u|=t.matches(r.selectorText))}catch(t){console.warn("CSS selector error: "+r.selectorText+". Often angular issue.",t)}u&&i.push(r.cssText)}}return i},makeXMLStr:function(t,n){var e=t.serializeToString(n);return e=e.split('xmlns="http://www.w3.org/1999/xhtml"').join("")}};function rt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}(t,n)||ot(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=ot(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function ot(t,n){if(t){if("string"==typeof t)return at(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?at(t,n):void 0}}function at(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function st(t,n){t.textContent="";var e=n.getComplexColors(),r=document.createElement("table");r.classList.add("color-key","complex-colors"),r.createTHead().textContent="Complexes";for(var i=e.domain(),o=e.range(),a=0;a<i.length;a++){var s=r.insertRow();s.insertCell().style.backgroundColor=o[a%6],s.insertCell().textContent=i[a]}t.appendChild(r);var u=n.getFeatureColors();if(u){var c,l=it(n.annotationSetsShown);try{for(l.s();!(c=l.n()).done;){var h=rt(c.value,2),f=h[0];if(h[1]){var p=document.createElement("table");p.classList.add("color-key","feature-colors"),p.createTHead().textContent=f;var y,d=new Set,g=it(n.participants.values());try{for(g.s();!(y=g.n()).done;){var v=y.value;if("protein"===v.type){var x=v.annotationSets.get(f);if(x){var m,b=it(x);try{for(b.s();!(m=b.n()).done;){var w=m.value.description;if(!d.has(w)){d.add(w);var _=p.insertRow();_.insertCell().style.backgroundColor=u(w),_.insertCell().textContent=w}}}catch(t){b.e(t)}finally{b.f()}}}}}catch(t){g.e(t)}finally{g.f()}t.appendChild(p)}}}catch(t){l.e(t)}finally{l.f()}}}function ut(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ct(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ct(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function ct(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function lt(t){this.el=t,this.STATES={},this.STATES.MOUSE_UP=0,this.STATES.PANNING=1,this.STATES.DRAGGING=2,this.STATES.ROTATING=3,this.STATES.SELECTING=4,this.el.textContent="",this.d3cola=s.d3adaptor();var n=i.select(this.el).append("div").classed("custom-menu-margin",!0).append("div").classed("custom-menu",!0).append("ul"),e=this,o=n.append("li").classed("collapse",!0);o.text("Collapse"),o[0][0].onclick=function(t){e.collapseProtein(t)};var a=n.append("li").text("Scale: ");this.barScales=[.01,.2,1,2,4,8];var u=a.selectAll("ul.custom-menu").data(this.barScales).enter().append("div").attr("class","bar-scale").append("label");u.append("span").text((function(t){return 8===t?"AA":t})),u.append("input").attr("class",(function(t){return"scaleButton scaleButton_"+100*t})).attr("name","scaleButtons").attr("type","radio").on("change",(function(t){e.preventDefaultsAndStopPropagation(t),e.contextMenuProt.setStickScale(t,e.contextMenuPoint)})),i.select(".custom-menu-margin").node().onmouseout=function(t){var n=t.relatedTarget;do{if(n===this)return;n=n.parentNode}while(n);e.contextMenuProt=null,i.select(this).style("display","none")},this.svgElement=document.createElementNS(c,"svg"),this.svgElement.classList.add("complexViewerSVG"),this.svgElement.onmousedown=function(t){e.mouseDown(t)},this.svgElement.onmousemove=function(t){e.mouseMove(t)},this.svgElement.onmouseup=function(t){e.mouseUp(t)},this.svgElement.onmouseout=function(t){e.hideTooltip(t)},this.lastMouseUp=(new Date).getTime(),this.svgElement.ontouchstart=function(t){e.touchStart(t)},this.svgElement.ontouchmove=function(t){e.touchMove(t)},this.svgElement.ontouchend=function(t){e.mouseUp(t)},this.el.oncontextmenu=function(t){return t.preventDefault&&t.preventDefault(),t.returnValue=!1,!1},this.colorSchemeKeyDivs=new Set,this.hoverListeners=new Set,this.el.appendChild(this.svgElement),this.container=document.createElementNS(c,"g"),this.container.setAttribute("id","container");var l=i.select(this.svgElement);this.defs=l.append("defs"),this.acknowledgement=document.createElementNS(c,"g");var h=document.createElementNS(c,"text");h.innerHTML="<a href='https://academic.oup.com/bioinformatics/article/33/22/3673/4061280' target='_blank'><tspan x='0' dy='1.2em' style='text-decoration: underline'>ComplexViewer "+r.a+"</tspan></a><tspan x='0' dy='1.2em'>by <a href='http://rappsilberlab.org/' target='_blank'>Rappsilber Laboratory</a></tspan>",this.acknowledgement.appendChild(h),h.setAttribute("font-size","8pt"),this.svgElement.appendChild(this.acknowledgement),this.naryLinks=document.createElementNS(c,"g"),this.naryLinks.setAttribute("id","naryLinks"),this.container.appendChild(this.naryLinks),this.p_pLinksWide=document.createElementNS(c,"g"),this.p_pLinksWide.setAttribute("id","p_pLinksWide"),this.container.appendChild(this.p_pLinksWide),this.highlights=document.createElementNS(c,"g"),this.highlights.setAttribute("class","highlights"),this.container.appendChild(this.highlights),this.res_resLinks=document.createElementNS(c,"g"),this.res_resLinks.setAttribute("id","res_resLinks"),this.container.appendChild(this.res_resLinks),this.p_pLinks=document.createElementNS(c,"g"),this.p_pLinks.setAttribute("id","p_pLinks"),this.container.appendChild(this.p_pLinks),this.proteinUpper=document.createElementNS(c,"g"),this.proteinUpper.setAttribute("id","proteinUpper"),this.container.appendChild(this.proteinUpper),this.selfRes_resLinks=document.createElementNS(c,"g"),this.selfRes_resLinks.setAttribute("id","res_resLinks"),this.container.appendChild(this.selfRes_resLinks),this.svgElement.appendChild(this.container),this.tooltip=document.createElementNS(c,"text"),this.tooltip.setAttribute("x","0"),this.tooltip.setAttribute("y","0");var f=document.createTextNode("tooltip");this.tooltip.classList.add("label","tooltip"),this.tooltip.appendChild(f),this.tooltip_bg=document.createElementNS(c,"rect"),this.tooltip_bg.classList.add("tooltip-background"),this.tooltip_subBg=document.createElementNS(c,"rect"),this.tooltip_subBg.classList.add("tooltip-sub-background"),this.svgElement.appendChild(this.tooltip_subBg),this.svgElement.appendChild(this.tooltip_bg),this.svgElement.appendChild(this.tooltip),this.annotationSetsShown=new Map,this.annotationSetsShown.set("Interactor",!1),this.annotationSetsShown.set("UniprotKB",!1),this.annotationSetsShown.set("Superfamily",!1),this.annotationSetsShown.set("MI Features",!0),this.clear()}lt.prototype.createHatchedFill=function(t,n){if(!this.checkedHatchNames.has(t)){var e=this.defs.append("pattern").attr("id",t).attr("patternUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",12).attr("height",12).attr("patternTransform","rotate(45)");e.append("rect").attr("x",0).attr("y",2).attr("width",12).attr("height",4).attr("fill",n),e.append("rect").attr("x",0).attr("y",8).attr("width",12).attr("height",4).attr("fill",n),this.checkedHatchNames.add(t)}},lt.prototype.clear=function(){this.d3cola.stop();var t,n=[],e=ut(a);try{for(e.s();!(t=e.n()).done;){var r=t.value,o=i.hsl(r);o.l=.9,n.push(o+"")}}catch(t){e.e(t)}finally{e.f()}O.naryColors=i.scale.ordinal().range(n),this.defs.textContent="",this.checkedHatchNames=new Set,this.naryLinks.textContent="",this.p_pLinksWide.textContent="",this.highlights.textContent="",this.p_pLinks.textContent="",this.res_resLinks.textContent="",this.proteinUpper.textContent="",this.selfRes_resLinks.textContent="",this.dragElement=null,this.dragStart={},this.participants=new Map,this.allNaryLinks=new Map,this.allBinaryLinks=new Map,this.allUnaryLinks=new Map,this.allSequenceLinks=new Map,this.complexes=[],this.proteinCount=0,this.z=1,this.hideTooltip(),this.state=this.STATES.MOUSE_UP},lt.prototype.collapseProtein=function(){i.select(".custom-menu-margin").style("display","none"),this.contextMenuProt.setForm(0,this.contextMenuPoint),this.contextMenuProt=null},lt.prototype.init=function(){this.d3cola.stop();var t,n=0,e=ut(this.participants.values());try{for(e.s();!(t=e.n()).done;){var r=t.value;r.size>n&&(n=r.size)}}catch(t){e.e(t)}finally{e.f()}var o,a,s,u=.8*this.svgElement.parentNode.clientWidth/n;this.defaultBarScale=(o=this.barScales,a=u,0===(s=(0,i.bisector((function(t){return t})).left)(o,a))||1===s?o[1]:s===o.length?o[o.length-1]:o[s-1]);var c,l=ut(this.participants.values());try{for(l.s();!(c=l.n()).done;){var h=c.value;"complex"!=h.type&&(h.setPosition(-500,-500),this.proteinUpper.appendChild(h.upperGroup))}}catch(t){l.e(t)}finally{l.f()}var f,p=ut(this.participants.values());try{for(p.s();!(f=p.n()).done;){var y=f.value;"protein"===y.type&&(y.stickZoom=this.defaultBarScale,this.participants.size<4&&y.toStickNoTransition())}}catch(t){p.e(t)}finally{p.f()}this.updateAnnotations();var d=this;!function(t,n){var e,r=Array.from(t.participants.values()).filter((function(t){return"protein"===t.type})),i=0,o=r.length,a=W(r);try{for(a.s();!(e=a.n()).done;){var s=e.value,u=new RegExp("[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}![-]","i").exec(s.json.identifier.id);u&&u[0]==s.json.identifier.id.trim()&&(tt(s,(function(){++i===o&&n()})),Q(s,(function(){++i===o&&n()})))}}catch(t){a.e(t)}finally{a.f()}}(this,(function(){d.updateAnnotations()})),this.checkLinks(),this.autoLayout()},lt.prototype.zoomToExtent=function(){var t=this.svgElement.parentNode.clientWidth,n=this.svgElement.parentNode.clientHeight,e=this.container.getBBox(),r=(t/e.width).toFixed(4)-0,i=(n/e.height).toFixed(4)-0;if((i<r?i:r)<1){var o;r=(t-40)/e.width,(o=(i=(n-40)/e.height)<r?i:r)>this.z&&(o=this.z);var a=-e.x+20/o,s=-e.y+20/o;this.container.setAttribute("transform","scale("+o+") translate("+a+" "+s+") "),this.z=this.container.getCTM().inverse().a}else{var u=t-e.width,c=n-e.height,l=u/2-e.x,h=c/2-e.y;this.container.setAttribute("transform","scale(1) translate("+l+" "+h+")"),this.z=1}this.acknowledgement.setAttribute("transform","translate("+(t-150)+", "+(n-30)+")")},lt.prototype.mouseDown=function(t){return t.preventDefault(),this.d3cola.stop(),this.dragStart=t,!1},lt.prototype.touchStart=function(t){return t.preventDefault(),this.d3cola.stop(),this.dragStart=t,!1},lt.prototype.mouseMove=function(t){this.move(t)},lt.prototype.touchMove=function(t){this.move(t)},lt.prototype.move=function(t){var n=this.getEventPoint(t),e=this.mouseToSVG(n.x,n.y);if(null!=this.dragElement){this.hideTooltip();var r=this.getEventPoint(this.dragStart),i=this.mouseToSVG(r.x,r.y),o=i.x-e.x,a=i.y-e.y;if(this.state===this.STATES.DRAGGING){var s,u;if(this.dragElement.ix)s=this.dragElement.ix-o,u=this.dragElement.iy-a,this.dragElement.setPosition(s,u),this.dragElement.setAllLinkCoordinates();else{var c,l=ut(this.dragElement.participants);try{for(l.s();!(c=l.n()).done;){c.value.changePosition(o,a)}}catch(t){l.e(t)}finally{l.f()}this.setAllLinkCoordinates()}this.dragStart=t}else Math.sqrt(o*o+a*a)>5*this.z&&(this.state=this.STATES.DRAGGING)}else this.showTooltip(n);return!1},lt.prototype.mouseUp=function(t){var n=(new Date).getTime();this.preventDefaultsAndStopPropagation(t);var e=this.getEventPoint(t);isNaN(e.x)&&(e=this.getEventPoint(this.dragStart));var r=this.mouseToSVG(e.x,e.y);if(this.dragElement&&"protein"===this.dragElement.type&&this.state!==this.STATES.DRAGGING&&this.state!==this.STATES.ROTATING)if(this.dragElement.expanded){this.contextMenuProt=this.dragElement,this.contextMenuPoint=r;var o,a,s=i.select(".custom-menu-margin");t.pageX?(o=t.pageX,a=t.pageY):(o=this.dragStart.touches[0].pageX,a=this.dragStart.touches[0].pageY),s.style("top",a-20+"px").style("left",o-20+"px").style("display","block"),i.select(".scaleButton_"+100*this.dragElement.stickZoom).property("checked",!0)}else this.dragElement.setForm(1);return this.dragElement=null,this.dragStart={},this.state=this.STATES.MOUSE_UP,this.lastMouseUp=n,!1},lt.prototype.getEventPoint=function(t){var n,e,r=this.svgElement.createSVGPoint(),i=this.svgElement.parentNode,o=0,a=0;do{o+=i.offsetTop||0,a+=i.offsetLeft||0,i=i.offsetParent}while(i);return t.touches&&t.touches.length>0?(n=t.touches[0].pageX,e=t.touches[0].pageY):t.pageX&&(n=t.pageX,e=t.pageY),r.x=n-a,r.y=e-o,r},lt.prototype.preventDefaultsAndStopPropagation=function(t){t.stopPropagation&&t.stopPropagation(),null!=t.cancelBubble&&(t.cancelBubble=!0),t.preventDefault&&t.preventDefault()},lt.prototype.autoLayout=function(){this.d3cola.stop();var t,n=this,e=ut(n.participants.values());try{for(e.s();!(t=e.n()).done;){var r=t.value;delete r.x,delete r.y,delete r.px,delete r.py,delete r.bounds,r.fixed=0}}catch(t){e.e(t)}finally{e.f()}var o,a=[],s=ut(n.participants.values());try{for(s.s();!(o=s.n()).done;){var u=o.value;u.binaryLinks.size>2&&"complex"!==u.type&&a.push(u)}}catch(t){s.e(t)}finally{s.f()}var c=Array.from(n.participants.values()).filter((function(t){return"complex"!==t.type}));function l(t,e){var r={};r.nodes=t,r.links=[];var o,a={},s=0,u=ut(t);try{for(u.s();!(o=u.n()).done;){a[o.value.id]=s,s++}}catch(t){u.e(t)}finally{u.f()}var h,f=ut(n.allBinaryLinks.values());try{for(f.s();!(h=f.n()).done;){var p=h.value,y=p.participants[0],d=p.participants[1],g=y,v=d;if(g!==v&&-1!==t.indexOf(g)&&-1!==t.indexOf(v)){var x={};x.source=a[y.id],x.target=a[d.id],x.id=p.id,r.links.push(x)}}}catch(t){f.e(t)}finally{f.f()}var m=[];if(!e&&n.complexes){var b,w=ut(n.complexes);try{for(w.s();!(b=w.n()).done;){var _=b.value;_.leaves=[],_.groups=[];var M,S=ut(_.naryLink.participants);try{for(S.s();!(M=S.n()).done;){var k=M.value;"complex"!==k.type&&_.leaves.push(r.nodes.indexOf(k))}}catch(t){S.e(t)}finally{S.f()}m.push(_)}}catch(t){w.e(t)}finally{w.f()}var E,A=ut(n.complexes);try{for(A.s();!(E=A.n()).done;){var L,N=E.value,C=ut(N.naryLink.participants);try{for(C.s();!(L=C.n()).done;){var P=L.value;"complex"===P.type&&N.groups.push(m.indexOf(P))}}catch(t){C.e(t)}finally{C.f()}}}catch(t){A.e(t)}finally{A.f()}}delete n.d3cola._lastStress,delete n.d3cola._alpha,delete n.d3cola._descent,delete n.d3cola._rootGroup;var T,I,z=t.length<30?30:20,D=n.svgElement.parentNode.clientWidth,O=n.svgElement.parentNode.clientHeight;n.d3cola.size([O-40,D-40]).nodes(r.nodes).groups(m).links(r.links).avoidOverlaps(!0),n.debug&&((T=i.select(n.container).selectAll(".group").data(m)).enter().append("rect").classed("group",!0).attr({rx:5,ry:5}).style("stroke","blue").style("fill","none"),(I=i.select(n.container).selectAll(".node").data(r.nodes)).enter().append("rect").classed("node",!0).attr({rx:5,ry:5}).style("stroke","red").style("fill","none"),T.exit().remove(),I.exit().remove());var q=Date.now();n.d3cola.symmetricDiffLinkLengths(z).on("tick",(function(){if(Date.now()-q>750){
//!preRun) {
var t,e=ut(n.d3cola.nodes());try{for(e.s();!(t=e.n()).done;){var r=t.value;r.setPosition(r.x,r.y)}}catch(t){e.e(t)}finally{e.f()}n.setAllLinkCoordinates(),n.zoomToExtent(),n.debug&&(T.attr({x:function(t){return t.bounds.x},y:function(t){return t.bounds.y},width:function(t){return t.bounds.width()},height:function(t){return t.bounds.height()}}),I.attr({x:function(t){return t.bounds.x},y:function(t){return t.bounds.y},width:function(t){return t.bounds.width()},height:function(t){return t.bounds.height()}}))}})).on("end",(function(){if(e)l(c,!1);else{var r,i=ut(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.setPosition(o.x,o.y)}}catch(t){i.e(t)}finally{i.f()}n.setAllLinkCoordinates(),n.zoomToExtent()}})),e?n.d3cola.start(23,23,0,0,!0):n.d3cola.start(0,23,23,0,!0)}a.length<c.length&&a.length>3&&n.participants.size<9?l(a,!0):l(c,n.complexes.length>0)},lt.prototype.getSVG=function(){var t=[i.select(this.el).selectAll("svg").node()],n=et.capture(t);return et.makeXMLStr(new XMLSerializer,n[0])},lt.prototype.mouseToSVG=function(t,n){var e=this.svgElement.createSVGPoint();return e.x=t,e.y=n,e.matrixTransform(this.container.getCTM().inverse())},lt.prototype.readMIJSON=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Z(t,this,n),this.init()},lt.prototype.checkLinks=function(){var t,n=ut(this.allNaryLinks.values());try{for(n.s();!(t=n.n()).done;){t.value.check()}}catch(t){n.e(t)}finally{n.f()}var e,r=ut(this.allBinaryLinks.values());try{for(r.s();!(e=r.n()).done;){e.value.check()}}catch(t){r.e(t)}finally{r.f()}var i,o=ut(this.allUnaryLinks.values());try{for(o.s();!(i=o.n()).done;){i.value.check()}}catch(t){o.e(t)}finally{o.f()}var a,s=ut(this.allSequenceLinks.values());try{for(s.s();!(a=s.n()).done;){a.value.check()}}catch(t){s.e(t)}finally{s.f()}},lt.prototype.setAllLinkCoordinates=function(){var t,n=ut(this.allNaryLinks.values());try{for(n.s();!(t=n.n()).done;){t.value.setLinkCoordinates()}}catch(t){n.e(t)}finally{n.f()}var e,r=ut(this.allBinaryLinks.values());try{for(r.s();!(e=r.n()).done;){e.value.setLinkCoordinates()}}catch(t){r.e(t)}finally{r.f()}var i,o=ut(this.allUnaryLinks.values());try{for(o.s();!(i=o.n()).done;){i.value.setLinkCoordinates()}}catch(t){o.e(t)}finally{o.f()}var a,s=ut(this.allSequenceLinks.values());try{for(s.s();!(a=s.n()).done;){a.value.setLinkCoordinates()}}catch(t){s.e(t)}finally{s.f()}},lt.prototype.showTooltip=function(t){var n,e,r=this.tooltip.getComputedTextLength()+16,i=this.svgElement.parentNode.clientWidth,o=this.svgElement.parentNode.clientHeight;n=t.x+20+r<i?t.x:i-r-20,e=t.y+60<o?t.y:o-60,this.tooltip.setAttribute("x",n+22),this.tooltip.setAttribute("y",e+47),this.tooltip_bg.setAttribute("x",n+16),this.tooltip_bg.setAttribute("y",e+28),this.tooltip_subBg.setAttribute("x",n+16),this.tooltip_subBg.setAttribute("y",e+28)},lt.prototype.setTooltip=function(t,n){if(t){this.tooltip.firstChild.data=t.toString().replace(/&(quot);/g,'"'),this.tooltip.setAttribute("display","block");var e=this.tooltip.getComputedTextLength();this.tooltip_bg.setAttribute("width",e+16),this.tooltip_subBg.setAttribute("width",e+16),void 0!==n&&null!=n?(this.tooltip_bg.setAttribute("fill",n),this.tooltip_bg.setAttribute("stroke",n),this.tooltip_bg.setAttribute("fill-opacity","0.0")):(this.tooltip_bg.setAttribute("fill","white"),this.tooltip_bg.setAttribute("stroke","grey")),this.tooltip_bg.setAttribute("height","28"),this.tooltip_subBg.setAttribute("height","28"),this.tooltip_bg.setAttribute("display","block"),this.tooltip_subBg.setAttribute("display","block")}else this.hideTooltip()},lt.prototype.hideTooltip=function(){this.tooltip.setAttribute("display","none"),this.tooltip_bg.setAttribute("display","none"),this.tooltip_subBg.setAttribute("display","none")},lt.prototype.addColorSchemeKey=function(t){this.colorSchemeKeyDivs.add(t),st(t,this)},lt.prototype.removeColorSchemeKey=function(t){this.colorSchemeKeyDivs.remove(t),t.textContent=""},lt.prototype.setAnnotations=function(t){t=t.toUpperCase();var n,e=ut(this.annotationSetsShown.keys());try{for(e.s();!(n=e.n()).done;){var r=n.value;this.showAnnotations(r,t===r)}}catch(t){e.e(t)}finally{e.f()}},lt.prototype.showAnnotations=function(t,n){this.annotationSetsShown.set(t,n),this.updateAnnotations()},lt.prototype.updateAnnotations=function(){var t,n=ut(this.participants.values());try{for(n.s();!(t=n.n()).done;){var e=t.value;"protein"===e.type&&e.clearPositionalFeatures()}}catch(t){n.e(t)}finally{n.f()}nt(this),this.colorSchemeChanged();var r,i=ut(this.participants.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;"protein"===o.type&&o.updatePositionalFeatures()}}catch(t){i.e(t)}finally{i.f()}nt(this),this.colorSchemeChanged()},lt.prototype.colorSchemeChanged=function(){var t,n=ut(this.colorSchemeKeyDivs);try{for(n.s();!(t=n.n()).done;){st(t.value,this)}}catch(t){n.e(t)}finally{n.f()}},lt.prototype.getComplexColors=function(){return O.naryColors},lt.prototype.getFeatureColors=function(){return this.featureColors},lt.prototype.collapseAll=function(){var t,n=ut(this.participants.values());try{for(n.s();!(t=n.n()).done;){var e=t.value;e.expanded&&e.setForm(0)}}catch(t){n.e(t)}finally{n.f()}},lt.prototype.expandAll=function(){var t,n=ut(this.participants.values());try{for(n.s();!(t=n.n()).done;){var e=t.value;"protein"!==e.type||e.expanded||e.setForm(1)}}catch(t){n.e(t)}finally{n.f()}},lt.prototype.expandAndCollapseSelection=function(t){var n,e=ut(this.participants.values());try{for(e.s();!(n=e.n()).done;){var r=n.value,i=r.json.identifier.id;t.includes(i)?r.expanded||r.setForm(1):r.expanded&&r.setForm(0)}}catch(t){e.e(t)}finally{e.f()}},lt.prototype.addHoverListener=function(t){this.hoverListeners.add(t)},lt.prototype.removeHoverListener=function(t){this.hoverListeners.remove(t)},lt.prototype.notifyHoverListeners=function(t){var n,e=ut(this.hoverListeners);try{for(e.s();!(n=e.n()).done;){(0,n.value)(t)}}catch(t){e.e(t)}finally{e.f()}}}])}));